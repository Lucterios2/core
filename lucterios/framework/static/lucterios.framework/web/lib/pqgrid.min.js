/**
 * ParamQuery Pro v2.3.0
 * 
 * Copyright (c) 2012-2017 Paramvir Dhindsa (http://paramquery.com)
 * Released under GPL v3 license
 * http://paramquery.com/license
 * 
 */     	
(function(g){var c=g.paramquery=g.paramquery||{};g.paramquery.pqgrid=g.paramquery.pqgrid||{};c.xmlToArray=function(c,h){var k=h.itemParent,e=h.itemNames,f=[];g(c).find(k).each(function(c,h){var k=g(h),a=[];g(e).each(function(b,d){a.push(k.find(d).text().replace(/\r|\n|\t/g,""))});f.push(a)});return f};c.xmlToJson=function(c,h){var k=h.itemParent,e=h.itemNames,f=[];g(c).find(k).each(function(c,h){for(var k=g(h),a={},b=0,d=e.length;b<d;b++){var l=e[b];a[l]=k.find(l).text().replace(/\r|\n|\t/g,"")}f.push(a)});
return f};c.tableToArray=function(c){var h=[],k=[];c=g(c).children("tbody").children("tr");var e=c.length?g(c[0]):g(),f=1<c.length?g(c[1]):g();e.children("th,td").each(function(e,c){var k=g(c),a=k.html(),k=k.width(),b="left";if(f.length)var d=f.find("td:eq("+e+")").attr("align"),b=d?d:b;h.push({title:a,width:k,dataType:"string",align:b,dataIndx:e})});c.each(function(e,f){if(0!=e){var c=[];g(f).children("td").each(function(a,b){c.push(g.trim(g(b).html()))});k.push(c)}});return{data:k,colModel:h}};
c.formatCurrency=function(c){if(isNaN(c))return c;c=Math.round(10*c)/10;c+="";-1==c.indexOf(".")&&(c+=".0");var h=c.length,g=c.substring(0,h-2);c=c.substring(h-2,h);for(var g=g.match(/\d/g).reverse(),h=[],e=0;e<g.length;e++)0<e&&0==e%3&&h.push(","),h.push(g[e]);h=h.reverse();g=h.join("");return g+c};c.validation={is:function(c,h){if("string"==c||!c)return!0;c=c.substring(0,1).toUpperCase()+c.substring(1,c.length);return this["is"+c](h)},isFloat:function(c){var h=parseFloat(c);return isNaN(h)||h!=
c?!1:!0},isInteger:function(c){var h=parseInt(c);return isNaN(h)||h!=c?!1:!0},isDate:function(c){c=Date.parse(c);return isNaN(c)?!1:!0}}})(jQuery);
(function(g){var c={options:{curPage:0,totalPages:0,totalRecords:0,msg:"",rPPOptions:[10,20,30,40,50,100],rPP:20},_regional:{strDisplay:"Displaying {0} to {1} of {2} items.",strFirstPage:"First Page",strLastPage:"Last Page",strNextPage:"Next Page",strPage:"Page {0} of {1}",strPrevPage:"Previous Page",strRefresh:"Refresh",strRpp:"Records per page:{0}"}};g.extend(c.options,c._regional);c._create=function(){var c=this,h=this.options;this.element.addClass("pq-pager");this.first=g("<button type='button' title='"+
h.strFirstPage+"'></button>",{}).appendTo(this.element).button({icons:{primary:"ui-icon-seek-first"},text:!1}).bind("click.paramquery",function(h){1<c.options.curPage&&c._onChange(h,1)});this.prev=g("<button type='button' title='"+h.strPrevPage+"'></button>").appendTo(this.element).button({icons:{primary:"ui-icon-seek-prev"},text:!1}).bind("click",function(h){1<c.options.curPage&&c._onChange(h,c.options.curPage-1)});g("<span class='pq-separator'></span>").appendTo(this.element);this.pageHolder=g("<span class='pq-page-placeholder'></span>").appendTo(this.element);
g("<span class='pq-separator'></span>").appendTo(this.element);this.next=g("<button type='button' title='"+this.options.strNextPage+"'></button>").appendTo(this.element).button({icons:{primary:"ui-icon-seek-next"},text:!1}).bind("click",function(h){c._onChange(h,c.options.curPage+1)});this.last=g("<button type='button' title='"+this.options.strLastPage+"'></button>").appendTo(this.element).button({icons:{primary:"ui-icon-seek-end"},text:!1}).bind("click",function(h){c._onChange(h,c.options.totalPages)});
g("<span class='pq-separator'></span>").appendTo(this.element);this.rPPHolder=g("<span class='pq-page-placeholder'></span>").appendTo(this.element);this.$refresh=g("<button type='button' title='"+this.options.strRefresh+"'></button>").appendTo(this.element).button({icons:{primary:"ui-icon-refresh"},text:!1}).bind("click",function(h){if(!1===c._trigger("beforeRefresh",h))return!1;c._trigger("refresh",h)});g("<span class='pq-separator'></span>").appendTo(this.element);this.$msg=g("<span class='pq-pager-msg'></span>").appendTo(this.element);
this._refresh()};c._refreshPage=function(){var c=this;this.pageHolder.empty();for(var h=this.options,k=h.strPage.split(" "),e=[],f=0,p=k.length;f<p;f++){var m=k[f];"{0}"==m?e.push("<input type='text' tabindex='0' class='ui-corner-all' />"):"{1}"==m?e.push("<span class='total'></span>"):e.push("<span>",m,"</span>")}k=e.join("");k=g(k).appendTo(this.pageHolder);this.page=k.filter("input").bind("change",function(e){var a=g(this),b=a.val();if(isNaN(b)||1>b)return a.val(h.curPage),!1;b=parseInt(b);if(b>
h.totalPages||!1===c._onChange(e,b))return a.val(h.curPage),!1});this.$total=k.filter("span.total")};c._onChange=function(c,h){if(!1===this._trigger("beforeChange",c,{curPage:h})||!1===this._trigger("change",c,{curPage:h}))return!1;this.option({curPage:h})};c._refresh=function(){this._refreshPage();var c=this,h=this.options;this.first.attr("title",h.strFirstPage);this.prev.attr("title",h.strPrevPage);this.next.attr("title",h.strNextPage);this.last.attr("title",h.strLastPage);this.$refresh.attr("title",
h.strRefresh);this.rPPHolder.empty();if(h.strRpp){var k=h.rPPOptions,e=h.strRpp;if(-1!=e.indexOf("{0}")){for(var f=["<select class='ui-corner-all'>"],p=0,m=k.length;p<m;p++){var q=k[p];f.push('<option value="',q,'">',q,"</option>")}f.push("</select>");k=f.join("");e=e.replace("{0}","</span>"+k);e="<span>"+e+"<span class='pq-separator'></span>"}else e="<span>"+e+"</span><span class='pq-separator'></span>";this.$rPP=g(e).appendTo(this.rPPHolder).filter("select").val(h.rPP).change(function(a){var b=
g(this),d=b.val();if(!1===c._trigger("beforeChange",a,{rPP:d}))return b.val(c.options.rPP),!1;!1!==c._trigger("change",a,{rPP:d})&&(c.options.rPP=d)})}h.curPage>=h.totalPages?(this.next.button({disabled:!0}),this.last.button({disabled:!0})):(this.next.button({disabled:!1}),this.last.button({disabled:!1}));1>=h.curPage?(this.first.button({disabled:!0}),this.prev.button({disabled:!0})):(this.first.button({disabled:!1}),this.prev.button({disabled:!1}));this.page.val(h.curPage);this.$total.text(h.totalPages);
0<this.options.totalRecords?(e=h.rPP,k=h.curPage,f=h.totalRecords,p=k*e,p>f&&(p=f),h=h.strDisplay,h=h.replace("{0}",(k-1)*e+1),h=h.replace("{1}",p),h=h.replace("{2}",f),this.$msg.html(h)):this.$msg.html("")};c._destroy=function(){this.element.empty().removeClass("pq-pager").enableSelection()};c._setOption=function(c,h){if("curPage"==c||"totalPages"==c)h=parseInt(h);this._super.call(this,c,h)};c._setOptions=function(){this._super.apply(this,arguments);this._refresh()};g.widget("paramquery.pqPager",
c);g.paramquery.pqPager.regional={};g.paramquery.pqPager.regional.en=c._regional})(jQuery);
(function(g){g.widget("paramquery.pqScrollBar",{options:{length:200,num_eles:3,cur_pos:0,ratio:0,timeout:350,pace:"optimum",direction:"vertical",theme:!1},_destroy:function(){this.element.removeClass("pq-sb-vert pq-sb-vert-t pq-sb-vert-wt").enableSelection().removeClass("pq-sb-horiz pq-sb-horiz-t pq-sb-horiz-wt").unbind("click.pq-scrollbar").empty();this.element.removeData()},_create:function(){this._createLayout()},_createLayout:function(){var c=this,n=this.options,h=n.direction,k=n.theme,e=this.element.empty();
"vertical"==h?(e.removeClass("pq-sb-vert-t pq-sb-vert-wt").addClass("pq-sb-vert"),k?(e.addClass("pq-sb-vert-t"),e.html("<div class='top-btn pq-sb-btn ui-state-default ui-corner-top'><div class='ui-icon ui-icon-triangle-1-n'></div></div><div class='pq-sb-slider ui-corner-all ui-state-default'></div><div class='bottom-btn pq-sb-btn ui-state-default ui-corner-bottom'><div class='ui-icon ui-icon-triangle-1-s'></div></div>")):(e.addClass("pq-sb-vert-wt"),e.html("<div class='top-btn pq-sb-btn'></div><div class='pq-sb-slider'><div class='vert-slider-top'></div><div class='vert-slider-bg'></div><div class='vert-slider-center'></div><div class='vert-slider-bg'></div><div class='vert-slider-bottom'></div></div><div class='bottom-btn pq-sb-btn'></div>"))):
(e.removeClass("pq-sb-horiz-t pq-sb-horiz-wt").addClass("pq-sb-horiz"),k?(e.addClass("pq-sb-horiz-t"),e.html("<div class='left-btn pq-sb-btn ui-state-default ui-corner-left'><div class='ui-icon ui-icon-triangle-1-w'></div></div><div class='pq-sb-slider pq-sb-slider-h ui-state-default ui-corner-all'></div><div class='right-btn pq-sb-btn ui-state-default ui-corner-right'><div class='ui-icon ui-icon-triangle-1-e'></div></div>")):(e.addClass("pq-sb-horiz-wt"),e.width(this.width),e.html("<div class='left-btn pq-sb-btn'></div><div class='pq-sb-slider pq-sb-slider-h'><span class='horiz-slider-left'></span><span class='horiz-slider-bg'></span><span class='horiz-slider-center'></span><span class='horiz-slider-bg'></span><span class='horiz-slider-right'></span></div><div class='right-btn pq-sb-btn'></div>")));
e.disableSelection().unbind(".pq-scrollbar").on("mouseup.pq-scrollbar",function(e){c._mouseup(e)}).on("mousedown.pq-scrollbar",function(e){if(!n.disabled&&!c.$slider.is(":hidden"))if("vertical"==h){var g=e.pageY,m=c.element.offset().top,k=m+n.length,a=c.$slider,b=a.offset().top,d=a.height(),l=b+d;g<b&&g>m+17?c.mousedownInterval=window.setInterval(function(){g>=a.offset().top?(window.clearInterval(c.mousedownInterval),c.mousedownInterval=null):c._pageUp(e)},0):g>l&&g<k-17&&(c.mousedownInterval=window.setInterval(function(){g<=
a.offset().top+d?(window.clearInterval(c.mousedownInterval),c.mousedownInterval=null):c._pageDown(e)},0))}else{var s=e.pageX,m=c.element.offset().left,k=m+n.length,b=c.$slider.offset().left,l=b+c.$slider.width();s<b&&s>m+17?(c.$slider.css("left",s-c.element.offset().left),c._updateCurPosAndTrigger(e)):s>l&&s<k-17&&(c.$slider.css("left",s-c.element.offset().left-c.$slider.width()),c._updateCurPosAndTrigger(e))}});e=this.$slider=g("div.pq-sb-slider",this.element);k&&e.attr("tabindex","0");this._bindSliderEvents(e);
this.$top_btn=g("div.top-btn,div.left-btn",this.element).click(function(e){if(!c.options.disabled)return c.decr_cur_pos(e),e.preventDefault(),!1}).mousedown(function(e){c.options.disabled||(c.mousedownTimeout=window.setTimeout(function(){c.mousedownInterval=window.setInterval(function(){c.decr_cur_pos(e)},0)},c.options.timeout))}).bind("mouseup mouseout",function(e){c._mouseup(e)});this.$bottom_btn=g("div.bottom-btn,div.right-btn",this.element).click(function(e){if(!c.options.disabled)return c.incr_cur_pos(e),
e.preventDefault(),!1}).mousedown(function(e){c.options.disabled||(c.mousedownTimeout=window.setTimeout(function(){c.mousedownInterval=window.setInterval(function(){c.incr_cur_pos(e)},0)},c.options.timeout))}).bind("mouseup mouseout",function(e){c._mouseup(e)});this._refresh()},_bindSliderEvents:function(c){var n=this,h="x";"vertical"==this.options.direction&&(h="y");c.draggable({axis:h,helper:function(c,e){n._setDragLimits();return this},start:function(c){n.topWhileDrag=null},drag:function(c){n.dragging=
!0;var e=n.options.pace;"optimum"==e?n._setNormalPace(c):"fast"==e&&n._updateCurPosAndTrigger(c)},stop:function(c){n._updateCurPosAndTrigger(c);n.dragging=!1}}).on("keydown.pq-scrollbar",function(c){var e=c.keyCode,f=n.options,h=f.cur_pos,m=f.ratio,q=f.num_eles,a=g.ui.keyCode;null==n.keydownTimeout&&(n.keydownTimeout=window.setTimeout(function(){e==a.DOWN||e==a.RIGHT?n.incr_cur_pos(c):e==a.UP||e==a.LEFT?n.decr_cur_pos(c):e==a.HOME?f.steps?0<h&&(f.cur_pos=0,n.updateSliderPos(),n.scroll(c)):0<m&&(f.ratio=
0,n.updateSliderPos(),n.drag(c)):e==a.END?f.steps?h<q&&(f.cur_pos=q,n.updateSliderPos(),n.scroll(c)):1>m&&(f.ratio=1,n.updateSliderPos(),n.drag(c)):"vertical"==f.direction&&(e==a.PAGE_DOWN?n._pageDown(c):e==a.PAGE_UP&&n._pageUp(c));n.keydownTimeout=null},0));if(e==a.DOWN||e==a.RIGHT||e==a.UP||e==a.LEFT||e==a.PAGE_DOWN||e==a.PAGE_UP||e==a.HOME||e==a.END)return c.preventDefault(),!1})},decr_cur_pos:function(c){var g=this.options;if(g.steps)0<g.cur_pos&&(g.cur_pos--,this.updateSliderPos(),this.scroll(c));
else if(0<g.ratio){var h=g.ratio-1/(g.num_eles-1);0>h&&(h=0);g.ratio=h;this.updateSliderPos();this.drag(c)}},incr_cur_pos:function(c){var g=this.options;if(g.steps)g.cur_pos<g.num_eles-1&&g.cur_pos++,this.updateSliderPos(),this.scroll(c);else{if(1>g.ratio){var h=g.ratio+1/(g.num_eles-1);1<h&&(h=1);g.ratio=h}this.updateSliderPos();this.drag(c)}},_mouseup:function(c){this.options.disabled||(window.clearTimeout(this.mousedownTimeout),this.mousedownTimeout=null,window.clearInterval(this.mousedownInterval),
this.mousedownInterval=null)},_setDragLimits:function(){var c=this.options;if("vertical"==c.direction){var g=this.element.offset().top+17,c=g+c.length-34-this.slider_length;this.$slider.draggable("option","containment",[0,g,0,c])}else g=this.element.offset().left+17,c=g+c.length-34-this.slider_length,this.$slider.draggable("option","containment",[g,0,c,0])},_refresh:function(){var c=this.options;1>=c.num_eles?this.element.css("display","none"):this.element.css("display","");this._validateCurPos();
this.$slider.css("display","");"vertical"==c.direction?this.element.height(c.length):this.element.width(c.length);this._setSliderBgLength();this.scroll_space=c.length-34-this.slider_length;(4>this.scroll_space||1>=c.num_eles)&&this.$slider.css("display","none");this.updateSliderPos(c.cur_pos)},_setSliderBgLength:function(){var c=this.options,n=c.theme,h=c.length,h=Math.round(((h-34)*h/(40*c.num_eles+h)-14)/2);1>h&&(h=1);this.slider_length=14+2*h;"vertical"==c.direction?n?this.$slider.height(this.slider_length-
2):(g("div.vert-slider-bg",this.element).height(h),this.$slider.height(this.slider_length)):n?this.$slider.width(this.slider_length-2):(g(".horiz-slider-bg",this.element).width(h),this.$slider.width(this.slider_length))},_updateCurPosAndTrigger:function(c,g){var h=this.options,k=h.direction,e=this.$slider;null==g&&(g="vertical"==k?parseInt(e[0].style.top,10):parseInt(e[0].style.left,10));k=(g-17)/(h.length-34-this.slider_length);if(h.steps){if(k*=h.num_eles-1,k=Math.round(k),h.cur_pos!=k){if(this.dragging){if(null!=
this.topWhileDrag&&(this.topWhileDrag<g&&h.cur_pos>k||this.topWhileDrag>g&&h.cur_pos<k))return;this.topWhileDrag=g}this.options.cur_pos=k;this.scroll(c)}}else h.ratio=k,this.drag(c)},_setNormalPace:function(c){this.timer&&(window.clearInterval(this.timer),this.timer=null);var g=this,h=this.options.direction;g.timer=window.setInterval(function(){var k=g.$slider,k="vertical"==h?parseInt(k[0].style.top,10):parseInt(k[0].style.left,10);g.prev_top==k&&(g._updateCurPosAndTrigger(c,k),window.clearInterval(g.timer),
g.timer=null);g.prev_top=k},20)},setNumEles:function(c){this.options.num_eles=c;this.updateSliderPos()},_validateCurPos:function(){var c=this.options;c.cur_pos>=c.num_eles&&(c.cur_pos=c.num_eles-1);0>c.cur_pos&&(c.cur_pos=0)},_updateSliderPosRatio:function(){var c=this.options,g=c.direction,h=c.ratio,k=this.$slider,c=c.length-34-this.slider_length;if(null==h)throw"ration N/A";h=h*c+17;"vertical"==g?k.css("top",h):k.css("left",h)},_updateSliderPosCurPos:function(){var c=this.options,g=this.scroll_space*
c.cur_pos/(c.num_eles-1);"vertical"==c.direction?this.$slider.css("top",17+g):this.$slider.css("left",17+g)},updateSliderPos:function(){var c=this.options;if(void 0===c.steps)throw"assert failed. steps N/A";c.steps?this._updateSliderPosCurPos():this._updateSliderPosRatio()},scroll:function(c){var g=this.options;this._trigger("scroll",c,{cur_pos:g.cur_pos,num_eles:g.num_eles})},drag:function(c){this._trigger("drag",c,{ratio:this.options.ratio})},_pageDown:function(c){this._trigger("pageDown",c,null)},
_pageUp:function(c){this._trigger("pageUp",c,null)},_setOption:function(c,g){"disabled"==c?(this._super.call(this,c,g),!0==g?this.$slider.draggable("disable"):this.$slider.draggable("enable")):"theme"==c?(this._super.call(this,c,g),this._createLayout()):"ratio"==c?0<=g&&1>=g&&this._super.call(this,c,g):this._super.call(this,c,g)},_setOptions:function(){this._super.apply(this,arguments);this._refresh()}})})(jQuery);
(function(g){var c=function(){};c.prototype.belongs=function(a){if(a.target==this.that.element[0])return!0};g.paramquery.cClass=c;var n=function(a){this.that=a;this.hidearrHS1=[];this.options=a.options;this.offset=null};g.paramquery.cGenerateView=n;c=n.prototype;c.generateView=function(a){var b=this.that,d=b.options,l=d.freezeCols,s=b.colModel,r,v,e=b.initH,c=b.finalH,f=d.groupModel,h=b.pqpanes;if(a){var f=this._generateTables(null,null,a),k=a.$cont;k.empty();h.v?k.append(["<div class='pq-cont-inner'>",
f,"</div><div class='pq-cont-inner'>",f,"</div>"].join("")):k.append("<div class='pq-cont-inner'>"+f+"</div>");var p=k.children("div"),f=p.children("table"),q=f[0].scrollHeight-1;k.height(q);if(h.v){var h=g(p[0]),k=f[0].scrollWidth,p=g(p[1]),n=g(f[1]),y=m.call(b,-1,l),l=m.call(b,l,e);h.css({width:y,zIndex:1});p.css({left:y-1,width:k,position:"absolute",height:q});n.css({left:-1*(l+y)})}b.tables||(b.tables=[]);l=-1;for(q=0;q<b.tables.length;q++)b.tables[q].cont==a.$cont[0]&&(l=q);-1==l?b.tables.push({$tbl:f,
cont:a.$cont[0]}):b.tables[l].$tbl=f}else{b._bufferObj_calcInitFinal();r=b.initV;v=b.finalV;var z=f?b.dataGM:b.pdata,k=b.$cont;null!=d.editModel.indices&&b.blurEditor({force:!0});f=this._generateTables(r,v,a);k.empty();0===b.totalVisibleRows?k.append("<div class='pq-cont-inner pq-grid-norows' >"+d.strNoRows+"</div>"):h.h&&h.v?k.append(["<div class='pq-cont-inner'>",f,"</div><div class='pq-cont-inner'>",f,"</div><div class='pq-cont-inner'>",f,"</div><div class='pq-cont-inner'>",f,"</div>"].join("")):
h.h||h.v?k.append(["<div class='pq-cont-inner'>",f,"</div><div class='pq-cont-inner'>",f,"</div>"].join("")):k.append("<div class='pq-cont-inner'>"+f+"</div>");b.$tbl=k.children("div").children("table");b._fixTableViewPort();b._trigger("afterTable",null,{dataModel:d.dataModel,colModel:s,pageData:z,initV:r,finalV:v,initH:e,finalH:c})}b._saveDims();this.scrollView();a||b._trigger("refresh",null,{dataModel:d.dataModel,colModel:s,pageData:z,initV:r,finalV:v,initH:e,finalH:c});b._saveDims();this.scrollView()};
c.scrollView=function(){var a=this.that,b=this.options,d=b.virtualY;b.virtualX||a.$hscroll.pqScrollBar("drag");d||a.$vscroll.pqScrollBar("drag")};c.setPanes=function(){var a=this.that,b=a.pqpanes,d=a.$cont.children("div"),l=a.$tbl,s=parseInt(a.options.freezeCols),r=a.initH;if(l&&l.length){var v=l[0].scrollWidth;if(b.h&&b.v){var r=g(d[0]),b=g(d[1]),e=g(l[1]),c=g(d[2]),f=g(l[2]),d=g(d[3]),h=g(l[3]),l=m.call(a,-1,s),a=a.calcHeightFrozenRows();r.css({width:l,height:a,zIndex:2});b.css({left:l,width:v,
height:a,position:"absolute"});e.css({left:-1*l});c.css({width:l,zIndex:1,top:a,position:"absolute"});f.css({top:-a});d.css({left:l,width:v,zIndex:1,top:a,position:"absolute"});h.css({top:-a,left:-1*l})}else b.v?(b=g(d[0]),d=g(d[1]),e=g(l[1]),l=m.call(a,-1,s),a=m.call(a,s,r),b.css({width:l,zIndex:1}),d.css({left:l,width:v,position:"absolute"}),e.css({left:-1*(a+l)})):b.h&&(s=g(d[0]),d=g(d[1]),l=g(l[1]),a=a.calcHeightFrozenRows(),s.css({height:a,zIndex:1}),d.css({width:v,top:a,position:"absolute"}),
l.css({top:-1*a}))}};c._generateTables=function(a,b,d){var l=this.that,s=l.colModel,r=l.options,v=r.virtualX,e=l.initH,c=l.finalH,f=r.numberCell,h=r.columnBorders,g=r.rowBorders,m=r.wrap,k=r.groupModel,p=r.freezeCols,r=parseInt(r.freezeRows),q=!1,n=0,x=d?d.data.length-1:b,A=k?!0:!1,B=d&&d.data?d.data:A?l.dataGM:l.pdata,C=l.rowIndxOffset;if(d||null!=a&&null!=x){d||l._trigger("beforeTableView",null,{pageData:B,initV:a,finalV:b,initH:e,finalH:c,colModel:s});q="pq-grid-table ";h&&(q+="pq-td-border-right ");
g&&(q+="pq-td-border-bottom ");h=["<table class='"+(m?q+"pq-wrap ":q+"pq-no-wrap ")+"' cellpadding=0 cellspacing=0 >"];this.hidearrHS1=[];h.push("<tr class='pq-row-hidden'>");f.show&&(n=f.width+1,h.push("<td style='width:"+n+"px;' ></td>"));for(q=0;q<=c;q++){if(q<e&&q>=p&&(v||d)&&(q=e,q>c))throw"initH>finalH";n=s[q];n.hidden||(n=n.outerWidth,h.push("<td style='width:",n,"px;' pq-col-indx='",q,"'></td>"))}h.push("</tr>");this.offsetRow=null;for(n=0;n<=x;n++)n<a&&n>=r&&(n=a),v=B[n],e=A?v.rowIndx-C:
n,v&&v.pq_hidden||(q=l.lastFrozenRow===e,k&&v.groupTitle?this._generateTitleRow(k,v,h,q):k&&v.groupSummary?this._generateSummaryRow(v.data,s,h,q):(c=v.pq_detail&&v.pq_detail.show,this._generateRow(v,e,s,h,d,q,c),c&&this._generateDetailRow(v,e,s,h,d,q)));l.scrollMode=!1;h.push("</table>");return h.join("")}};c._renderCell=function(a,b){var d=this.options,l=a.rowData,s=a.column,r=s.type,s=s.dataIndx,e=l[s];if(l){void 0!=b?r=b:"checkBoxSelection"==r?r="<input type='checkbox' "+(e?"checked='checked'":
"")+" />":"detail"==r?(r=d.detailModel,r="<div class='ui-icon "+(e&&e.show?r.expandIcon:r.collapseIcon)+"'></div>"):r=e;if(""===r||void 0==r)r="&nbsp;";var e="",c;a.tree&&(c=d.treeModel)&&c.labelIndx==s?(d=!l.pq_collapse,s=(l.pq_level+1)*c.indent,e="",e=l.pq_leaf?c.leafIcon:d?c.expandIcon+" pq-tree-expand-icon":c.collapseIcon+" pq-tree-expand-icon",l=["<div class='pq-tree-icon-container' style='width:",s,"px;'><div class='ui-icon ",e," pq-tree-icon' ></div></div>"].join(""),e="<div class='"+cls+"'>"+
l+r+"</div>"):e=r;return e}};c.renderCell=function(a){var b=this.that,d=this.options,l=a.rowData,s=a.rowIndx,r=a.rowIndxPage,e=a.column,c=a.colIndx,f=e.dataIndx,h=d.freezeCols,g=d.columnBorders,k="pq-col-indx='"+c+"'",m=!1,p="pq-grid-cell ";"right"==e.align?p+=" pq-align-right":"center"==e.align&&(p+=" pq-align-center");c==h-1&&g&&(p+=" pq-last-freeze-col");(h=e.cls)&&(p=p+" "+h);(h=l.pq_cellselect)&&(m=h[f]);m&&(p+=" pq-cell-select ui-state-highlight");var q;e.render&&(q=e.render.call(b.element[0],
{data:b.pdata,dataModel:d.dataModel,rowData:l,cellData:l[f],rowIndxPage:r,rowIndx:s,colIndx:c,column:e,dataIndx:f}));(b=l.pq_cellcls)&&(b=b[f])&&(p+=" "+b);if(l=l.pq_cellattr)if(f=l[f])for(var n in f)l=f[n],"title"==n&&(l=l.replace(/\"/g,"&quot;")),k+=" "+n+'="'+l+'"';return["<td class='",p,"' ",k," >",this._renderCell(a,q),"</td>"].join("")};c.refreshRow=function(a,b,d){var l=this.that,s=l.pdata[a];this._generateRow(s,a,b,d,null,l.lastFrozenRow===a,s.pq_detail&&s.pq_detail.show)};c._generateRow=
function(a,b,d,l,s,r,e){var c="pq-grid-row";r&&(c+=" pq-last-freeze-row");e&&(c+=" pq-detail-master");var f=this.that,h=this.options;r=h.freezeCols;var g=h.numberCell;e=h.treeModel.labelIndx?!0:!1;var k=h.virtualX,m=f.initH,f=f.finalH,p=this.offset;h.stripeRows&&b/2==parseInt(b/2)&&(c+=" pq-grid-oddRow");a.pq_rowselect&&(c+=" pq-row-select ui-state-highlight");h=a.pq_rowcls;null!=h&&(c+=" "+h);var h=a.pq_rowattr,q="";if(h)for(var n in h)var z=h[n],z=z.replace('"',"&quot;"),q=q+(n+'="'+z+'"');l.push("<tr pq-row-indx='",
b,"' class='",c,"' ",q," >");g.show&&l.push(["<td class='pq-grid-number-cell ui-state-default'>",s?"&nbsp;":b+1,"</td>"].join(""));a={rowIndx:b+p,rowIndxPage:b,rowData:a};for(b=0;b<=f;b++){if(b<m&&b>=r&&(k||s)&&(b=m,b>f))throw"initH>finalH";c=d[b];c.hidden||(a.column=c,a.colIndx=b,a.tree=e,l.push(this.renderCell(a)))}l.push("</tr>");return l};c={widgetEventPrefix:"pqgrid"};c.options={cancel:"input,textarea,button,select,option,.ui-resizable-handle,div[contenteditable],.pq-draggable",distance:3,collapsible:{on:!0,
toggle:!0,collapsed:!1,_collapsed:!1,refreshAfterExpand:!0,css:{zIndex:1E3}},colModel:null,columnBorders:!0,dataModel:{cache:!1,dataType:"JSON",location:"local",sorting:"local",sortDir:"up",method:"GET"},direction:"",draggable:!1,editable:!0,editModel:{cellBorderWidth:0,pressToEdit:!0,clicksToEdit:1,filterKeys:!0,keyUpDown:!0,reInt:/^([\-]?[1-9][0-9]*|[\-]?[0-9]?)$/,reFloat:/^[\-]?[0-9]*\.?[0-9]*$/,onBlur:"validate",saveKey:g.ui.keyCode.ENTER,onSave:"next",allowInvalid:!1,invalidClass:"pq-cell-red-tr pq-has-tooltip",
warnClass:"pq-cell-blue-tr pq-has-tooltip",validate:!0},editor:{select:!1,type:"textbox"},validation:{icon:"ui-icon-alert",cls:"ui-state-error",style:"padding:3px 10px;"},warning:{icon:"ui-icon-info",cls:"",style:"padding:3px 10px;"},freezeCols:0,freezeRows:0,calcDataIndxFromColIndx:!0,height:400,hoverMode:"null",_maxColWidth:"100%",_minColWidth:50,minWidth:100,numberCell:{width:30,title:"",resizable:!0,minWidth:30,maxWidth:100,show:!0},pageModel:{curPage:1,totalPages:0,rPP:10,rPPOptions:[10,20,50,
100]},resizable:!1,roundCorners:!0,rowBorders:!0,scrollModel:{pace:"fast",horizontal:!0,autoFit:!1,theme:!1},selectionModel:{fireSelectChange:!0,type:"cell",mode:"block"},swipeModel:{on:!0,speed:50,ratio:.15,repeat:20},showBottom:!0,showHeader:!0,showTitle:!0,showToolbar:!0,showTop:!0,sortable:!0,sql:!1,stripeRows:!0,title:"&nbsp;",treeModel:null,virtualX:!1,virtualY:!1,width:"auto",wrap:!0,hwrap:!0};c._regional={strAdd:"Add",strDelete:"Delete",strEdit:"Edit",strLoading:"Loading",strNextResult:"Next Result",
strNoRows:"No rows to display.",strNothingFound:"Nothing found",strPrevResult:"Previous Result",strSearch:"Search",strSelectedmatches:"Selected {0} of {1} match(es)"};g.extend(c.options,c._regional);c._destroyResizable=function(){this.element.data("resizable")&&this.element.resizable("destroy")};c._disable=function(){null==this.$disable&&(this.$disable=g("<div class='pq-grid-disable'></div>").css("opacity",.2).appendTo(this.element))};c._enable=function(){this.$disable&&(this.element[0].removeChild(this.$disable[0]),
this.$disable=null)};c._destroy=function(){this._destroyResizable();this._destroyDraggable();this._mouseDestroy();this.element.off(this.eventNamespace);g(window).unbind(this.eventNamespace);g(document).unbind(this.eventNamespace);this.element.empty().css("height","").css("width","").removeClass("pq-grid ui-widget ui-widget-content ui-corner-all").removeData()};c.destroy=function(){this._super();window.clearInterval(this._refreshEditorPosTimer);this.autoResizeTimeout&&clearTimeout(this.autoResizeTimeout);
for(var a in this)delete this[a];g.fragments={}};c.decidePanes=function(){var a=this.pqpanes={v:!1,h:!1,vH:!1},b=this.options,d=b.virtualX,l=b.virtualXHeader,s=b.virtualY,r="flex"==b.height,e="flex"==b.width,c=b.numberCell,f=b.freezeRows,b=b.freezeCols;!f||r||!b&&!c.show||e?f&&!r?s||(a.h=!0):!b&&!c.show||e||(d||(a.v=!0,a.vH=!0),!1===l&&(a.vH=!0)):(s||(a.h=!0),d||(a.v=!0,a.vH=!0),!1===l&&(a.vH=!0))};c.collapse=function(a){var b=this,d=this.element,l=this.options.collapsible,s=l.$collapse.children("span"),
r=function(){s.addClass("ui-icon-circle-triangle-s").removeClass("ui-icon-circle-triangle-n");d.hasClass("ui-resizable")&&d.resizable("destroy");b.$toolbar.pqToolbar("disable");l.collapsed=!0;l._collapsed=!0;l.animating=!1;b._trigger("collapse")};a=a?a:{};if(l._collapsed)return!1;l.htCapture=d.height();!1===a.animate?(d.height(23),r()):(l.animating=!0,d.animate({height:"23px"},function(){r()}))};c.expand=function(a){var b=this,d=this.element,l=this.options.collapsible,s=l.htCapture,r=l.$collapse.children("span"),
e=function(){l._collapsed=!1;l.collapsed=!1;b._refreshResizable();l.refreshAfterExpand&&b.refresh();r.addClass("ui-icon-circle-triangle-n").removeClass("ui-icon-circle-triangle-s");b.$toolbar.pqToolbar("enable");l.animating=!1;b._trigger("expand")};a=a?a:{};if(!1===l._collapsed)return!1;!1===a.animate?(d.height(s),e()):(l.animating=!0,d.animate({height:s},function(){e()}))};c._createCollapse=function(){var a=this,b=this.$top,d=this.options.collapsible;d.$stripe||(b=g("<div class='pq-slider-icon' style='z-index:5;' ></div>").appendTo(b),
d.$stripe=b);d.on?d.$collapse||(d.$collapse=g("<div style='float:left;' class='pq-collapse'><span class='ui-icon ui-icon-circle-triangle-n' style='float:left;'></span></div>").appendTo(d.$stripe).mouseover(function(a){g(this).addClass("ui-state-hover")}).mouseout(function(a){g(this).removeClass("ui-state-hover")}).click(function(b){d.collapsed?a.expand():a.collapse()})):d.$collapse&&(d.$collapse.remove(),delete d.$collapse);d.collapsed&&!d._collapsed?a.collapse({animate:!1}):!d.collapsed&&d._collapsed&&
a.expand({animate:!1});d.toggle?d.$toggle||(d.$toggle=g("<div style='float:left;' class='pq-max'><span class='ui-icon ui-icon-arrow-4-diag' style='float:left;'></span></div>").prependTo(d.$stripe).mouseover(function(a){g(this).addClass("ui-state-hover")}).mouseout(function(a){g(this).removeClass("ui-state-hover")}).click(function(b){a.toggle()})):d.$toggle&&(d.$toggle.remove(),delete d.$toggle)};c._create=function(){var a=this;this.decidePanes();this.setEditorPosTimer();this.iGenerateView=new n(this);
this.iKeyNav=new p(this);this.iRefreshColumn=new q(this);this.iIsValid=new e(this);this.rowHeight=22;this.hidearr=[];this.hidearrHS=[];this.tables=[];var a=this,b=this.options;this.$tbl=null;this._refreshGridWidthAndHeight();this._calcThisColModel();this.iSort=new g.paramquery.cSort(this);this.iSort._refreshSorters();this._initTypeColumns();var d=this.element;d.empty().addClass("pq-grid ui-widget ui-widget-content"+(b.roundCorners?" ui-corner-all":"")).append(["<div class='pq-grid-top ui-widget-header",
b.roundCorners?" ui-corner-top":"","'><div class='pq-grid-title",b.roundCorners?" ui-corner-top":"","'>&nbsp;</div></div><div class='pq-grid-inner' ><div class='pq-header-outer ui-widget-header'></div><div class='pq-cont-right' ><div class='pq-cont' tabindex='0'></div></div></div><div class='pq-grid-bottom ui-widget-header",b.roundCorners?" ui-corner-bottom":"","'><div class='pq-grid-footer'>&nbsp;</div></div>"].join(""));this._trigger("render",null,{dataModel:this.options.dataModel,colModel:this.colModel});
this.$top=g("div.pq-grid-top",d);this.$title=g("div.pq-grid-title",d);b.showTitle||this.$title.css("display","none");b.collapsible||(b.collapsible={on:!1,collapsed:!1});b.flexHeight&&(b.height="flex");b.flexWidth&&(b.width="flex");this.$toolbar=g("div.pq-grid-toolbar",d);this.$grid_inner=g("div.pq-grid-inner",d);this.$header_o=g("div.pq-header-outer",this.$grid_inner);b.showTop||this.$top.css("display","none");this.$bottom=g("div.pq-grid-bottom",d);b.showBottom||this.$bottom.css("display","none");
this.$footer=g("div.pq-grid-footer",d);this.$cont_o=g("div.pq-cont-right",this.$grid_inner);this.$cont_fixed=g("div.pq-cont-fixed",this.$grid_inner);var l=this.$cont=g("div.pq-cont",this.$grid_inner);g(window).bind("resize"+a.eventNamespace+" orientationchange"+a.eventNamespace,function(b,d){a._onWindowResize(b,d)});l.on("click","td.pq-grid-cell",function(b){if(!0!==g.data(b.target,a.widgetName+".preventClickEvent")&&g(b.target).closest(".pq-grid")[0]==a.element[0])return a._onClickCell(b)});l.on("click",
"tr.pq-grid-row",function(b){if(!0!==g.data(b.target,a.widgetName+".preventClickEvent")&&g(b.target).closest(".pq-grid")[0]==a.element[0])return a._onClickRow(b)});l.on("contextmenu","td.pq-grid-cell",function(b){if(g(b.target).closest(".pq-grid")[0]==a.element[0])return a._onRightClickCell(b)});l.on("contextmenu","tr.pq-grid-row",function(b){if(g(b.target).closest(".pq-grid")[0]==a.element[0])return a._onRightClickRow(b)});l.on("dblclick","td.pq-grid-cell",function(b){if(g(b.target).closest(".pq-grid")[0]==
a.element[0])return a._onDblClickCell(b)});l.on("dblclick","tr.pq-grid-row",function(b){if(g(b.target).closest(".pq-grid")[0]==a.element[0])return a._onDblClickRow(b)});l.on("mousedown","td.pq-grid-cell",function(b){if(g(b.target).closest(".pq-grid")[0]==a.element[0])return a._onCellMouseDown(b)});l.on("mousedown","tr.pq-grid-row",function(b){if(g(b.target).closest(".pq-grid")[0]==a.element[0])return a._onRowMouseDown(b)});l.on("mousedown",function(b){if(g(b.target).closest(".pq-grid")[0]==a.element[0])return a._onContMouseDown(b)});
l.on("mouseenter","td.pq-grid-cell",function(b){if(g(b.target).closest(".pq-grid")[0]==a.element[0])return a._onCellMouseEnter(b,g(this))});l.on("mouseenter","tr.pq-grid-row",function(b){if(g(b.target).closest(".pq-grid")[0]==a.element[0])return a._onRowMouseEnter(b,g(this))});l.on("mouseleave","td.pq-grid-cell",function(b){if(g(b.target).closest(".pq-grid")[0]==a.element[0])return a._onCellMouseLeave(b,g(this))});l.on("mouseleave","tr.pq-grid-row",function(b){if(g(b.target).closest(".pq-grid")[0]==
a.element[0])return a._onRowMouseLeave(b,g(this))});l.bind("mousewheel DOMMouseScroll",function(b){return a._onMouseWheel(b)});this.$hvscroll=g("<div class='pq-hvscroll-square ui-widget-content'></div>").appendTo(this.$grid_inner);this.$vscroll=g("<div class='pq-vscroll'></div>").appendTo(this.$grid_inner);this.prevVScroll=0;l=b.scrollModel;void 0===l.lastColumn&&b.virtualX&&(l.lastColumn="auto");this.$vscroll.pqScrollBar({pace:l.pace,theme:l.theme,steps:b.virtualY,direction:"vertical",cur_pos:0,
pageDown:function(b,d){a.iKeyNav.pageDown()},pageUp:function(b,d){a.iKeyNav.pageUp()},drag:function(d,l){b.virtualY||a._syncViewWithScrollBarVert(l.ratio)},scroll:function(d,l){b.virtualY&&(a.scrollMode=!0,a.setFlexWHCallback(function(){a.iGenerateView.generateView()}),1>=(d.originalEvent&&"drag"==d.originalEvent.type?a._setScrollVNumEles():a._setScrollVNumEles(!0))&&(a._setScrollHLength(),a._setScrollHVLength()))}});this.$hscroll=g("<div class='pq-hscroll'></div>").appendTo(this.$grid_inner);this.$hscroll.pqScrollBar({direction:"horizontal",
pace:l.pace,theme:l.theme,steps:b.virtualX,cur_pos:0,drag:function(d,l){b.virtualX||a._syncViewWithScrollBarHor(l.ratio)},scroll:function(d,l){var e=b.virtualXHeader;b.virtualX&&a.refresh({header:!1===e?!1:!0});!1===e&&a._syncViewWithScrollBarHorHeader(l.cur_pos)}});d.height("");this.disableSelection();window.opera?this.$grid_inner.bind("keypress.pq-grid",{that:this},function(b){g(b.target).closest(".pq-grid")[0]==a.element[0]&&a._onKeyPressDown(b)}):this.$grid_inner.bind("keydown.pq-grid",{that:this},
function(b){g(b.target).closest(".pq-grid")[0]==a.element[0]&&a._onKeyPressDown(b)});this._refreshOptions();this._refreshTitle();this.iRows=new g.paramquery.cRows(this);this.iCells=new g.paramquery.cCells(this);this.generateLoading();this._initPager();this._refreshResizable();this._refreshDraggable();this._mouseInit()};c.toggle=function(){var a=this.options,b=a.collapsible,d=this.element,l=g(document.body);if("fixed"==d.css("position")){var s=this.maxim.eleObj,b=this.maxim.docObj;a.height=s.height;
a.width=s.width;d.css({position:s.position,left:s.left,top:s.top,margin:s.margin,zIndex:s.zIndex});l.css({height:b.height,width:b.width,overflow:b.overflow});g("html").css({overflow:"visible"});window.scrollTo(b.scrollLeft,b.scrollTop);a="min"}else s={height:a.height,width:a.width,position:d.css("position"),left:d.css("left"),top:d.css("top"),margin:d.css("margin"),zIndex:d.css("zIndex")},a.height="100%-2",a.width="100%-2",d.css(g.extend({position:"fixed",left:0,top:0,margin:0},b.css)),b={height:l.height(),
width:l.width(),overflow:l.css("overflow"),scrollLeft:g(window).scrollLeft(),scrollTop:g(window).scrollTop()},g(document.body).css({height:0,width:0,overflow:"hidden"}),g("html").css({overflow:"hidden"}),window.scrollTo(0,0),this.maxim={eleObj:s,docObj:b},a="max";this._trigger("toggle",null,{state:a});this._refreshResizable();this.refresh();g(window).trigger("resize",{$grid:d,state:a})};c._mouseCapture=function(a){var b=this.options;if(b.virtualX&&b.virtualY||!a.target)return!1;if(g(a.target).closest(".pq-grid")[0]==
this.element[0]){if("flex"==b.height&&"flex"==b.width)return!1;a=b.swipeModel;return!1==a.on||"touch"==a.on&&!g.support.touch?!1:!0}return!1};c._saveDims=function(){var a=this.$cont;a.data("offsetWidth",a[0].offsetWidth);a.data("offsetHeight",a[0].offsetHeight);var b=this.$tbl;if(b)for(a=0;a<b.length;a++){var d=b[a],l=g(d);l.data("offsetHeight",d.offsetHeight);l.data("scrollWidth",d.scrollWidth)}if(b=this.$tbl_header)for(a=0;a<b.length;a++)d=b[a],l=g(d).parent(),l.data("offsetHeight",d.offsetHeight),
l.data("scrollWidth",d.scrollWidth)};c._mousePQUp=function(a){g(document).unbind("mouseup."+this.eventNamespace,this._mousePQUpDelegate);this._trigger("mousePQUp",a,null)};c._mouseDown=function(a){var b=this;if(g(a.target).closest(".pq-editor-focus").length)this._blurEditMode=!0,window.setTimeout(function(){b._blurEditMode=!1},0);else return this._saveDims(),this._mousePQUpDelegate=function(a){return b._mousePQUp(a)},g(document).bind("mouseup."+this.eventNamespace,this._mousePQUpDelegate),this._super.call(this,
a)};c._mouseStart=function(a){this.blurEditor({force:!0});return!0};c._mouseDrag=function(a){return!1==this._trigger("mouseDrag",a,null)?!1:!0};c._mouseStop=function(a){return!1==this._trigger("mouseStop",a,null)?!1:!0};c._refreshGridWidthAndHeight=function(){var a=this.options,b,d,l=-1<(a.width+"").indexOf("%")?!0:!1,s=-1<(a.height+"").indexOf("%")?!0:!1,r=this.element;if(l||s){var e=r.parent();if(!e.length)return;var c,f;e[0]==document.body||"fixed"==r.css("position")?(c=g(window).width(),f=window.innerHeight?
window.innerHeight:g(window).height()):(c=e.width(),f=e.height());var h=null,k=function(a){return(a=/(-|\+)([0-9]+)/.exec(a))&&3==a.length?parseInt(a[1]+a[2]):0},m=l?k(a.width):0,k=s?k(a.height):0;if(0==c){for(;"BODY"!=e[0].tagName.toUpperCase();){var p=e.parent();if(null==p[0]){h=e;break}else e=p}if(h){var p=h.css("position"),q=h.css("left"),n=h.css("top");h.css({position:"absolute",left:"-2000",top:"-2000"}).appendTo(g(document.body));e=r.parent();l&&(c=e.width());s&&(f=e.height());h.css({position:p,
left:q,top:n})}}l&&(b=parseInt(a.width)*c/100+m);s&&(d=parseInt(a.height)*f/100+k)}l||(b=a.width);s||(d=a.height);"auto"!=b&&b<a.minWidth&&(b=a.minWidth);d<a.minHeight&&(d=a.minHeight);r.width(b);r.height(d)};var h,k;c._onWindowResize=function(a,b){var d=this.options,l=this.element,s=l.parent();if(b){var r=b.$grid;if(r&&(r==l||0==l.closest(r).length))return}if(s.length&&(s[0]==document.body||"fixed"==l.css("position")?(l=window.innerHeight?window.innerHeight:g(window).height(),s=g(window).width()):
(l=s.height(),s=s.width()),null==h||l!=h||s!=k)&&(h=l,k=s,!(g.support.touch&&d.editModel.indices&&g(document.activeElement).is(".pq-editor-focus")))){var e=this,d=d.autoSizeInterval,d=void 0===d?0:d;this.autoResizeTimeout&&(clearTimeout(this.autoResizeTimeout),delete this.autoResizeTimeout);this.autoResizeTimeout=window.setTimeout(function(){e._refreshAfterResize();delete e.autoResizeTimeout},d)}};c._onMouseWheel=function(a){this._saveDims();var b=this.options,d=0,l=!1;a=a.originalEvent;var s=a.wheelDeltaX,
r=a.wheelDeltaY,e=a.wheelDelta;if(s&&Math.abs(s)>Math.abs(r)){if("flex"==b.width)return!0;l=!0;d=s/120}else if(e){if("flex"==b.height)return!0;d=e/120}else a.detail&&(d=-1*a.detail/3);a=l?this.$hscroll:this.$vscroll;s=a.pqScrollBar("option");r=parseInt(s.cur_pos);e=parseInt(s.num_eles);l&&b.virtualX||!l&&b.virtualY?(d=0<d?Math[1>d?"ceil":"floor"](d):Math[-1>d?"ceil":"floor"](d),0<=r-d&&(a.pqScrollBar("option","cur_pos",r-d),a.pqScrollBar("scroll"))):(b=s.ratio-d/(e-1),1<b?b=1:0>b&&(b=0),a.pqScrollBar("option",
"ratio",b),a.pqScrollBar("drag"));return!1};c._onDblClickCell=function(a){var b=g(a.currentTarget),d=this.getCellIndices({$td:b}),l=d.rowIndxPage,s=l+this.rowIndxOffset,d=d.colIndx;if(null!=d){if(!1==this._trigger("cellDblClick",a,{$td:b,rowIndxPage:l,rowIndx:s,colIndx:d,column:this.colModel[d],rowData:this.pdata[l]}))return!1;1<this.options.editModel.clicksToEdit&&this.isEditableRow({rowIndx:s})&&this.isEditableCell({colIndx:d,rowIndx:s})&&this.editCell({rowIndxPage:l,colIndx:d})}};c._onClickCont=
function(a){};c._onClickRow=function(a){var b=g(a.currentTarget),d=parseInt(b.attr("pq-row-indx")),l=d+this.rowIndxOffset;if(!isNaN(d)&&!1==this._trigger("rowClick",a,{$tr:b,rowIndxPage:d,rowIndx:l,rowData:this.pdata[d]}))return!1};c._onRightClickRow=function(a){var b=g(a.currentTarget),d=parseInt(b.attr("pq-row-indx")),l=d+this.rowIndxOffset;if(!isNaN(d)&&!1==this._trigger("rowRightClick",a,{$tr:b,rowIndxPage:d,rowIndx:l,rowData:this.pdata[d]}))return!1};c._onDblClickRow=function(a){var b=g(a.currentTarget),
d=parseInt(b.attr("pq-row-indx")),l=this.getRowIndxOffset();if(!1==this._trigger("rowDblClick",a,{$tr:b,rowIndxPage:d,rowIndx:d+l,rowData:this.pdata[d]}))return!1};g.paramquery.getValueFromDataType=function(a,b,d){if("date"==b)return b=Date.parse(a),isNaN(b)?"":d?b:a;if("integer"==b)b=parseInt(a);else if("float"==b)b=parseFloat(a);else return"bool"==b?(b=g.trim(a).toLowerCase(),0==b.length?null:"true"==b||"yes"==b||"1"==b?!0:"false"==b||"no"==b||"0"==b?!1:Boolean(b)):g.trim(a);return isNaN(b)||null==
b?null==a?a:null:b};var e=function(a){this.that=a},f=e.prototype;f._isValidCell=function(a){var b=this.that,d=a.column,l=d.validations;if(!l||!l.length)return{valid:!0};var s=a.value,r=d.dataType,e=function(a){return g.paramquery.getValueFromDataType(a,r,!0)};a=a.rowData;if(!a)throw"rowData required.";for(var c=0;c<l.length;c++){var f=l[c],h=f.type,k=!1,p=f.msg,m=f.value;if(!1!==f.on&&(null==s&&"function"!=typeof h?k=!1:"minLen"==h?(s=e(s),m=e(m),s.length>=m&&(k=!0)):"nonEmpty"==h?null!=s&&""!==s&&
(k=!0):"maxLen"==h?(s=e(s),m=e(m),s.length<=m&&(k=!0)):"gt"==h?(s=e(s),m=e(m),s>m&&(k=!0)):"gte"==h?(s=e(s),m=e(m),s>=m&&(k=!0)):"lt"==h?(s=e(s),m=e(m),s<m&&(k=!0)):"lte"==h?(s=e(s),m=e(m),s<=m&&(k=!0)):"regexp"==h?(new RegExp(m)).test(s)&&(k=!0):"function"==typeof h?(m={column:d,value:s,rowData:a,msg:p},!1==h.call(b.element[0],m)?(k=!1,m.msg!=p&&(p=m.msg)):k=!0):k=!0,!k))return{valid:!1,msg:p,column:d,warn:f.warn,dataIndx:d.dataIndx,validation:f}}return{valid:!0}};f.isValidCell=function(a){var b=
this.that,d=a.rowData,l=a.rowIndx,s=a.value,r=a.valueDef,e=a.column,c=b.options,h=a.allowInvalid,f=e.dataIndx,m=c.validation,k=c.warning,p=c.editModel,q=p.invalidClass,p=p.warnClass,n=document.activeElement;if(a.checkEditable&&!1==b.isEditableCell({rowData:d,rowIndx:l,dataIndx:f}))return{valid:!0};a=this._isValidCell({column:e,value:s,rowData:d});var s=a.valid,e=a.warn,y=a.msg;if(s)b.data({rowData:d,dataIndx:f,data:"pq_valid"})&&(b.removeClass({rowData:d,rowIndx:l,dataIndx:f,cls:p+" "+q}),b.removeData({rowData:d,
dataIndx:f,data:"pq_valid"}));else var m=g.extend({},e?k:m,a.validation),z=m.css,x=m.cls,A=m.icon,B=m.style;if(h||e){if(s)return{valid:!0};b.addClass({rowData:d,rowIndx:l,dataIndx:f,cls:e?p:q});b.data({rowData:d,dataIndx:f,data:{pq_valid:{css:z,icon:A,style:B,msg:y,cls:x}}});return a}if(!s){l=null==l?b.getRowIndx({rowData:d}).rowIndx:l;if(null==l)return a;if(!r)b.goToPage({rowIndx:l}),b.editCell({rowIndx:l,dataIndx:f});else if(g(n).hasClass("pq-editor-focus")&&(r=c.editModel.indices)){d=r.rowIndx;
r=r.dataIndx;if(null!=l&&l!=d)throw"incorrect usage of isValid rowIndx: "+l;if(f!=r)throw"incorrect usage of isValid dataIndx: "+f;b.editCell({rowIndx:d,dataIndx:f})}if((b=b.getEditCell())&&b.$cell){var C=b.$cell;C.attr("title",y);try{C.tooltip("destroy")}catch(F){}C.tooltip({position:{my:"left center+5",at:"right center"},content:function(){return(""==A?"":"<span class='ui-icon "+A+" pq-tooltip-icon'></span>")+y},open:function(a,b){x&&b.tooltip.addClass(x);if(B){var d=b.tooltip.attr("style");b.tooltip.attr("style",
d+";"+B).css("zIndex",C.zIndex()+5)}z&&b.tooltip.css(z)}}).tooltip("open")}return a}if(r&&(b=b.getEditCell())&&b.$cell){C=b.$cell;C.removeAttr("title");try{C.tooltip("destroy")}catch(E){}}return{valid:!0}};c.isValid=function(a){return this.iIsValid.isValid(a)};f.isValid=function(a){var b=this.that;a=a||{};var d=a.allowInvalid,l=a.checkEditable,d=null==d?!1:d,s=a.dataIndx;if(null!=s){var r=b.columns[s],e=a.rowData||b.getRowData(a),c=a.hasOwnProperty("value"),b=c?a.value:e[s],b=this.isValidCell({rowData:e,
checkEditable:l,rowIndx:a.rowIndx,value:b,valueDef:c,column:r,allowInvalid:d});return b.valid||b.warn?{valid:!0}:b}if(null!=a.rowIndx||null!=a.rowIndxPage||null!=a.rowData)for(var e=a.rowData||b.getRowData(a),f=b.colModel,c=[],h=0,g=f.length;h<g;h++){if(r=f[h],!r.hidden&&(s=r.dataIndx,b=e[s],b=this.isValidCell({rowData:e,value:b,column:r,rowIndx:a.rowIndx,checkEditable:l,allowInvalid:d}),!b.valid&&!b.warn))if(d)c.push({rowData:e,dataIndx:s,column:r});else return b}else{a=a.data?a.data:b.options.dataModel.data;
c=[];if(!a)return null;h=0;for(g=a.length;h<g;h++){e=a[h];if(l&&(r=this.getRowIndx({rowData:e}).rowIndx,!1==b.isEditableRow({rowData:e,rowIndx:r})))continue;e=this.isValid({rowData:e,rowIndx:r,checkEditable:l,allowInvalid:d});if(!1===d){if(!e.valid)return e}else c=c.concat(e.cells)}}return d&&c.length?{cells:c,valid:!1}:{valid:!0}};c.isEditableRow=function(a){var b=this.options.editable;if(null!=b){if("function"==typeof b){var d=a.rowIndx;a=a.rowData||this.getRowData({rowIndx:d});return b.call(this.element[0],
{rowData:a,rowIndx:d})}return b}return!0};c.isEditableCell=function(a){var b=a.colIndx,d=a.dataIndx,b=null==b?this.getColIndx({dataIndx:d}):b,b=this.colModel[b],d=null==d?b.dataIndx:d,l=b.editable;if(a.checkVisible&&b.hidden)return!1;if(null!=l){if("function"==typeof l){var s=a.rowIndx;a=a.rowData||this.getRowData(a);return l.call(this.element[0],{rowIndx:s,rowData:a,column:b,dataIndx:d})}return l}return!0};c._getRowPQData=function(a,b,d){return(d=null==d?this.pdata[a]:d)?d[b]:null};c._setRowPQData=
function(a,b,d){if(d=null==d?this.pdata[a]:d)for(var l in b)d[l]=b[l]};c._onContMouseDown=function(a){this.blurEditor({blurIfFocus:!0});if(!1===this._trigger("contMouseDown",a,{dataModel:this.options.dataModel}))return!1;var b=g(a.target);a=b.closest(".pq-grid-cell");b=b.closest(".pq-grid-row");a.length||b.length||this.$cont.attr("tabindex",0).focus();return!0};c._onCellMouseDown=function(a){var b=g(a.currentTarget),d=this.getCellIndices({$td:b});d.$td=b;d.dataModel=this.options.dataModel;return!1==
this._trigger("cellMouseDown",a,d)?!1:!0};c._onRowMouseDown=function(a){var b=g(a.currentTarget),d=this.getRowIndx({$tr:b});d.$tr=b;d.dataModel=this.options.dataModel;return!1==this._trigger("rowMouseDown",a,d)?!1:!0};c._onCellMouseEnter=function(a,b){var d=this.options,l=this.getCellIndices({$td:b});if(null!=l.rowIndx&&null!=l.colIndx){if(!1===this._trigger("cellMouseEnter",a,l))return!1;"cell"==d.hoverMode&&this.highlightCell(b);return!0}};c._onRowMouseEnter=function(a,b){var d=this.options,l=this.getRowIndx({$tr:b}),
s=l.rowIndxPage;if(!1===this._trigger("rowMouseEnter",a,l))return!1;"row"==d.hoverMode&&this.highlightRow(s);return!0};c._onCellMouseLeave=function(a,b){"cell"==this.options.hoverMode&&this.unHighlightCell(b);return!0};c._onRowMouseLeave=function(a,b){var d=this.getRowIndx({$tr:b}).rowIndxPage;"row"==this.options.hoverMode&&this.unHighlightRow(d);return!0};c._onCellMouseUp=function(a){var b=g(a.currentTarget),d=this.getCellIndices({$td:b});d.$td=b;d.dataModel=this.options.dataModel;return!1==this._trigger("cellMouseUp",
a,d)?!1:!0};c._onRowMouseUp=function(a){var b=g(a.currentTarget),b=this.getRowIndx({$tr:b});return!1==this._trigger("rowMouseUp",a,b)?!1:!0};c._onClickCell=function(a){var b=this.colModel,d=this.options.editModel,l=g(a.currentTarget),s=this.getCellIndices({$td:l}),r=s.rowIndxPage,e=r+this.rowIndxOffset,c=s.colIndx;s.rowIndx=e;if(null!=c){var b=b[c],f=b.dataIndx;s.dataIndx=f;s.evt=a;if(!1==this._trigger("cellClick",a,{$td:l,rowIndxPage:r,rowIndx:e,colIndx:c,dataIndx:f,column:b,rowData:this.pdata[r]}))return!1;
1==d.clicksToEdit&&this.isEditableRow({rowIndx:e})&&this.isEditableCell({colIndx:c,rowIndx:e})&&this.editCell(s)}};c._onRightClickCell=function(a){var b=g(a.currentTarget),d=this.getCellIndices({$td:b}),l=d.rowIndxPage,s=l+this.rowIndxOffset,d=d.colIndx,r=this.colModel;if(null!=d&&(r=r[d],!1==this._trigger("cellRightClick",a,{$td:b,rowIndxPage:l,rowIndx:s,colIndx:d,dataIndx:r.dataIndx,column:r,rowData:this.pdata[l]})))return!1};c.highlightCell=function(a){a.addClass("pq-grid-cell-hover ui-state-hover")};
c.unHighlightCell=function(a){a.removeClass("pq-grid-cell-hover ui-state-hover")};c.highlightRow=function(a){isNaN(a)||(a=this.getRow({rowIndxPage:a}))&&a.addClass("pq-grid-row-hover ui-state-hover")};c.unHighlightRow=function(a){isNaN(a)||(a=this.getRow({rowIndxPage:a}))&&a.removeClass("pq-grid-row-hover ui-state-hover")};c._getCreateEventData=function(){return{dataModel:this.options.dataModel,data:this.pdata,colModel:this.options.colModel}};c._refreshOptions=function(){this._refreshDataOptions()};
c._refreshDataOptions=function(){};c.enableSelection=function(){this.$cont.enableSelection()};c.disableSelection=function(){this.$cont.disableSelection();this.$header_o.find("tr.pq-grid-title-row").disableSelection()};c._findCellFromEvt=function(a){a=g(a.target).closest(".pq-grid-cell");if(null==a||0==a.length)return{rowIndxPage:null,colIndx:null,$td:null};var b=this.getCellIndices({$td:a});b.$td=a;return b};c._initPager=function(){var a=this,b={change:function(b,l){a.blurEditor({force:!0});var s=
a.options.pageModel;void 0!=l.curPage&&(s.prevPage=s.curPage,s.curPage=l.curPage);void 0!=l.rPP&&(s.rPP=l.rPP);"remote"==s.type?a.remoteRequest({callback:function(){a._onDataAvailable({apply:!0})}}):a.refreshView()},refresh:function(b){a.refreshDataAndView()}};this.options.pageModel.type&&this.$footer.pqPager(b)};c._refreshHideArrHS=function(){for(var a=this.colModel,b=this.hidearrHS,d=this.initH,l=this.finalH,s=parseInt(this.options.freezeCols),r=0;r<s;r++)b[r]=!1;for(r=s;r<d;r++)b[r]=!0;for(r=d;r<=
l;r++)b[r]=!1;r=l+1;for(a=a.length;r<a;r++)b[r]=!0};c.generateLoading=function(){this.$loading&&this.$loading.remove();this.$loading=g("<div class='pq-loading'></div>").appendTo(this.element);g(["<div class='pq-loading-bg'></div><div class='pq-loading-mask ui-state-highlight'><div>",this.options.strLoading,"...</div></div>"].join("")).appendTo(this.$loading);this.$loading.find("div.pq-loading-bg").css("opacity",.2)};c._refreshLoadingString=function(){this.$loading.find("div.pq-loading-mask").children("div").html(this.options.strLoading)};
c.showLoading=function(){null==this.showLoadingCounter&&(this.showLoadingCounter=0);this.showLoadingCounter++;this.$loading.show()};c.hideLoading=function(){0<this.showLoadingCounter&&this.showLoadingCounter--;this.showLoadingCounter||this.$loading.hide()};c.refreshDataFromDataModel=function(){this._trigger("beforeRefreshData",null,{});var a=this.options,b=a.pageModel,d=a.dataModel.data,l=b.type;this.rowIndxOffset=0;if(null==d||0==d.length)l&&(b.curPage=0,b.totalPages=0,b.totalRecords=0),this.pdata=
d;else{if(l&&"local"==l){b.totalRecords=d.length;b.totalPages=Math.ceil(d.length/b.rPP);b.curPage>b.totalPages&&(b.curPage=b.totalPages);1>b.curPage&&0<b.totalPages&&(b.curPage=1);var a=(b.curPage-1)*b.rPP,s=b.curPage*b.rPP;s>d.length&&(s=d.length);this.pdata=d.slice(a,s)}else"remote"==l?(a=Math.ceil(b.totalRecords/b.rPP),(b.totalPages=a)&&!b.curPage&&(b.curPage=1),s=b.rPP,s>d.length&&(s=d.length),this.pdata=d.slice(0,s)):this.pdata=a.backwardCompat?d.slice(0):d;if("local"==l||"remote"==l)this.rowIndxOffset=
b.rPP*(b.curPage-1)}};g.paramquery.filter=function(){var a={begin:{text:"Begins With",TR:!0,string:!0},between:{text:"Between",TR:!0,string:!0,date:!0,number:!0},notbegin:{text:"Does not begin with",TR:!0,string:!0},contain:{text:"Contains",TR:!0,string:!0},notcontain:{text:"Does not contain",TR:!0,string:!0},equal:{text:"Equal To",TR:!0,string:!0,bool:!0},notequal:{text:"Not Equal To",TR:!0,string:!0},empty:{text:"Empty",TR:!1,string:!0,bool:!0},notempty:{text:"Not Empty",TR:!1,string:!0,bool:!0},
end:{text:"Ends With",TR:!0,string:!0},notend:{text:"Does not end with",TR:!0,string:!0},less:{text:"Less Than",TR:!0,number:!0,date:!0},lte:{text:"Less than or equal",TR:!0,number:!0,date:!0},range:{TR:!0,string:!0,number:!0,date:!0},regexp:{TR:!0,string:!0,number:!0,date:!0},great:{text:"Great Than",TR:!0,number:!0,date:!0},gte:{text:"Greater than or equal",TR:!0,number:!0,date:!0}};return{conditions:a,getAllConditions:function(){var b=[],d;for(d in a)b.push(d);return b}(),getConditions:function(b){var d=
[],l;for(l in a)a[l][b]&&d.push(l);return d},getTRConditions:function(){var b=[],d;for(d in a)a[d].TR&&b.push(d);return b}(),getWTRConditions:function(){var b=[],d;for(d in a)a[d].TR||b.push(d);return b}()}}();g.paramquery.filter.rules={};g.paramquery.filter.rules.en={begin:"Begins With",between:"Between",notbegin:"Does not begin with",contain:"Contains",notcontain:"Does not contain",equal:"Equal To",notequal:"Not Equal To",empty:"Empty",notempty:"Not Empty",end:"Ends With",notend:"Does not end with",
less:"Less Than",lte:"Less than or equal",great:"Great Than",gte:"Greater than or equal"};c.getQueryStringSort=function(){var a=this.iSort.sorters,b="",d=this.options,l=d.stringify;if(d.sql){for(d=0;d<a.length;d++)l=a[d],b+=(0<d?", ":"")+l.dataIndx+" "+("up"==l.dir?"asc":"desc");return b}return a.length?!1===l?a:JSON.stringify(a):""};c.getQueryStringCRUD=function(){return""};c.getQueryStringFilter=function(){var a=this.options,b=a.sql,d=a.stringify,l=a.filterModel,a=l.mode,s=this.getFilterData({CM:this.colModel,
location:"remote"}),r="";if(l&&l.on&&s)if(b){r=[];for(d=0;d<s.length;d++){var e=s[d],b=e.condition,l=e.dataIndx,e=g.trim(e.value);"contain"===b?r.push(l+" like '%"+e+"%'"):"notcontain"===b?r.push(l+" not like '%"+e+"%'"):"begin"===b?r.push(l+" like '"+e+"%'"):"end"===b?r.push(l+" like '%"+e+"'"):"equal"===b?r.push(l+"='"+e+"'"):"notequal"===b?r.push(l+"!='"+e+"'"):"empty"===b?r.push("isnull("+l+",'')=''"):"notempty"===b?r.push("isnull("+l+",'')!=''"):"less"===b?r.push(l+"<'"+e+"'"):"great"===b&&r.push(l+
">'"+e+"'")}r=r.join(" "+a+" ")}else s.length?(a={mode:a,data:s},r=!1===d?a:JSON.stringify(a)):r="";return r};c.remoteRequest=function(a){this.loading&&this.xhr.abort();var b=this,d="",l="",s=this.options,r=!1,e=this.colModel,c=s.dataModel,f=s.filterModel,h=s.pageModel;if("function"==typeof c.getUrl)(s=c.getUrl.call(this.element[0],{colModel:e,dataModel:c,groupModel:s.groupModel,pageModel:h,filterModel:f}))&&s.url&&(d=s.url),s&&s.data&&(l=s.data);else if("string"==typeof c.url){var d=c.url,l={},s=
{},m={};if("remote"==c.sorting){var k=this.getQueryStringSort();k&&(l={pq_sort:k})}"remote"==h.type&&(m={pq_curpage:h.curPage,pq_rpp:h.rPP});"local"!=f.type&&(k=this.getQueryStringFilter())&&(r=!0,s={pq_filter:k});var k=c.postData,p=c.postDataOnce;k&&"function"==typeof k&&(k=k.call(this.element[0],{colModel:e,dataModel:c}));l=g.extend({pq_datatype:c.dataType},s,m,l,k,p)}d&&(this.loading=!0,this.showLoading(),this.xhr=g.ajax({url:d,dataType:c.dataType,async:null==c.async?!0:c.async,cache:c.cache,contentType:c.contentType,
type:c.method,data:l,beforeSend:function(a,d){if("function"==typeof c.beforeSend)return c.beforeSend.call(b.element[0],a,d)},success:function(d,l,s){"function"==typeof c.getData&&(d=c.getData.call(b.element[0],d,l,s));c.data=d.data;h.type&&"remote"==h.type&&(d.curPage&&(h.curPage=d.curPage),d.totalRecords&&(h.totalRecords=d.totalRecords));b.hideLoading();b.loading=!1;a&&a.callback&&a.callback();b._trigger("load",null,{dataModel:c,colModel:e});r&&b._trigger("filter",null,{type:"remote",dataModel:c,
colModel:e,filterModel:f})},error:function(a,d,l){b.hideLoading();b.loading=!1;if("function"==typeof c.error)c.error.call(b.element[0],a,d,l);else if("abort"!=l)throw"Error : "+l;}}))};c.setFlexWHCallback=function(a){a.call(this);a=this.options;"flex"==a.height&&this._setGridHeightFromTable();"flex"==a.width&&this._setGridWidthFromTable()};c._refreshTitle=function(){this.$title.html(this.options.title)};c._destroyDraggable=function(){var a=this.element,b=a.parent(".pq-wrapper");b.length&&b.data("draggable")&&
(b.draggable("destroy"),this.$title.removeClass("pq-draggable"),a.unwrap(".pq-wrapper"))};c._refreshDraggable=function(){var a=this.element,b=this.$title;this.options.draggable?(b.addClass("pq-draggable"),a.parent(".pq-wrapper").length||a.wrap("<div class='pq-wrapper' />"),a.parent(".pq-wrapper").draggable({handle:b})):this._destroyDraggable()};c._refreshResizable=function(){var a=this,b=this.element,d=this.options,l=-1<(d.width+"").indexOf("%"),s=-1<(d.height+"").indexOf("%"),r="auto"==d.width,e=
"flex"==d.width,c="flex"==d.height;if(!d.resizable||(c||s)&&(e||l||r))this._destroyResizable();else{var f="e,s,se";if(c||s)f="e";else if(e||l||r)f="s";l=!0;b.hasClass("ui-resizable")&&(s=b.resizable("option","handles"),f==s?l=!1:this._destroyResizable());l&&b.resizable({helper:"ui-state-default",handles:f,minWidth:d.minWidth,minHeight:d.minHeight?d.minHeight:100,delay:0,start:function(a,b){g(b.helper).css({opacity:.5,background:"#ccc",border:"1px solid steelblue"})},resize:function(a,b){},stop:function(b,
l){var s=a.element,r=d.width,e=d.height,c=-1<(r+"").indexOf("%"),f=-1<(e+"").indexOf("%"),h="auto"==r,r="flex"==r,v=!1;f||"flex"==e||(v=!0,d.height=s.height());c||h||r||(v=!0,d.width=s.width());a.refresh();s.css("position","relative");v&&g(window).trigger("resize")}})}};c._refreshAfterResize=function(){var a=this.options,b=a.width,d=a.height,a=-1!=(b+"").indexOf("%")?!0:!1,b="auto"===b,d=-1!=(d+"").indexOf("%")?!0:!1;(a||b||d)&&this.refresh()};c.refresh=function(a){this._refresh(a)};c._refreshDataIndices=
function(){for(var a="JSON"==this.getDataType()?!0:!1,b={},d={},l={},s=this.colModel,r=s.length,e=0;e<r;e++){var c=s[e],f=c.dataIndx;null==f&&(f=a?"dataIndx_"+e:e,c.dataIndx=f);b[f]=c;d[f]=e;c.validations&&(l[f]=l)}this.columns=b;this.colIndxs=d;this.validations=l};c.refreshView=function(a){null!=this.options.editModel.indices&&this.blurEditor({force:!0});this.refreshDataFromDataModel();this.refresh(a)};c._refresh=function(a){a=a||{};var b=a.header,d=a.table;a=this.element;if(a[0].offsetWidth){this.$grid_inner[0].scrollTop=
0;var l=this.options;this.decidePanes();l.collapsible._collapsed=!1;var s=this;this._refreshGridWidthAndHeight();this.iRefreshColumn.refreshColumnWidths();this._setScrollHNumEles();this._bufferObj_calcInitFinalH();this._refreshHideArrHS();!1!==b?this._createHeader():this._refreshHeader();this._refreshHeaderSortIcons();this._refreshPager();this._setInnerGridHeight();this._setRightGridHeight();a.height("");this.setFlexWHCallback(function(){!1!==d?s.iGenerateView.generateView():(s._saveDims(),s.iGenerateView.scrollView())});
this._refreshScrollbars();this._refreshFreezeLine();this._createCollapse();l.dataModel.postDataOnce=void 0}};c._refreshScrollbars=function(a){this._setScrollHLength();this._setScrollVLength();this._setScrollVNumEles(!0);this._setScrollHLength();this._setScrollHVLength()};c._setScrollHVLength=function(){var a=this.options;(this.$hscroll.is(":hidden")||"flex"==a.height||"flex"==a.width)&&this.$hvscroll.css("visibility","hidden")};c._refreshPager=function(){var a=this.options,b=a.pageModel,d=this.$footer,
l=b.rPP,s=b.totalRecords;b.type?(a=a.pageModel,!1==d.hasClass("pq-pager")&&this._initPager(),d.pqPager("option",a),s>l&&this.$bottom.css("display","")):(d.hasClass("pq-pager")&&d.pqPager("destroy"),a.showBottom?this.$bottom.css("display",""):this.$bottom.css("display","none"))};c.getInstance=function(){return{grid:this}};c._addRowsData=function(a){var b=a.data,d=this.options.dataModel.data;a=a.rowIndx;null==d&&(d=[]);if(null==a)for(var l=0,s=b.length;l<s;l++){var e=b[l];d.push(e)}else if(a<d.length)for(l=
0,s=b.length;l<s;l++)e=b[l],d.splice(a,0,e),a++;else return!1;return!0};c.addRows=function(a){return this._addRowsData(a)?(this.refreshDataFromDataModel(),this.refresh(),!0):!1};c.refreshDataAndView=function(a){var b=this.options.dataModel;this.iSort._refreshSorters();if("remote"==b.location){var d=this;this.remoteRequest({callback:function(){d._onDataAvailable(a)}})}else this._onDataAvailable(a)};c.getColIndx=function(a){a=a.dataIndx;if(void 0===a)throw"dataIndx NA";for(var b=this.colModel,d=0,l=
b.length;d<l;d++)if(b[d].dataIndx==a)return d};c.getColumn=function(a){if(null==a.dataIndx)throw"dataIndx N/A";return this.columns[a.dataIndx]};c._onDataAvailable=function(){};c._setOption=function(a,b){var d=this.options;if("height"===a&&"flex"==b){this._super.call(this,a,b);var l=this.$vscroll;b&&l&&l.hasClass("pq-sb-vert")&&(d.virtualY?l.pqScrollBar("option","cur_pos",0):l.pqScrollBar("option","ratio",0))}else"width"===a&&"flex"==b?(this._super.call(this,a,b),l=this.$hscroll,b&&l&&l.hasClass("pq-sb-horiz")&&
(d.virtualX?l.pqScrollBar("option","cur_pos",0):l.pqScrollBar("option","ratio",0))):"title"==a?(this._super.call(this,a,b),this._refreshTitle()):"roundCorners"==a?(this._super.call(this,a,b),b?(this.element.addClass("ui-corner-all"),this.$top.addClass("ui-corner-top"),this.$bottom.addClass("ui-corner-bottom")):(this.element.removeClass("ui-corner-all"),this.$top.removeClass("ui-corner-top"),this.$bottom.removeClass("ui-corner-bottom"))):"freezeCols"==a?(b=parseInt(b),!isNaN(b)&&0<=b&&b<=this.colModel.length-
2&&this._super.call(this,a,b)):"freezeRows"==a?(b=parseInt(b),!isNaN(b)&&0<=b&&this._super.call(this,a,b)):"resizable"==a?(this._super.call(this,a,b),this._refreshResizable()):"draggable"==a?(this._super.call(this,a,b),this._refreshDraggable()):"scrollModel"==a?this._super.call(this,a,b):"dataModel"==a?this._super.call(this,a,b):"pageModel"==a?this._super.call(this,a,b):"selectionModel"===a?this._super.call(this,a,b):"colModel"===a||"columnTemplate"==a?(this._super.call(this,a,b),this._calcThisColModel()):
"disabled"===a?(this._super.call(this,a,b),!0===b?this._disable():this._enable()):"numberCell"===a?(this._super.call(this,a,b),this.decidePanes()):"strLoading"===a?(this._super.call(this,a,b),this._refreshLoadingString()):"showTop"===a?(this._super.call(this,a,b),!0===b?this.$top.css("display",""):this.$top.css("display","none")):"showTitle"===a?(this._super.call(this,a,b),!0===b?this.$title.css("display",""):this.$title.css("display","none")):"showToolbar"===a?(this._super.call(this,a,b),!0===b?
this.$toolbar.css("display",""):this.$toolbar.css("display","none")):"toolbar"==a?(this._super.call(this,a,b),this.$toolbar.remove(),this._super.call(this,a,b),this._createToolbar()):"collapsible"===a?(this._super.call(this,a,b),this._createCollapse()):"showBottom"===a?(this._super.call(this,a,b),!0===b?this.$bottom.css("display",""):this.$bottom.css("display","none")):this._super.call(this,a,b)};c._setOptions=function(){this._super.apply(this,arguments)};c._generateCellRowOutline=function(){var a=
this.options,b=a.editModel;if(this.$div_focus){if(a.debug)throw"this.$div_focus already present assert failed";}else a=this.element,b.inline&&(a=this.getCell(b.indices),a.css("padding",0).empty()),this.$div_focus=g("<div class='pq-editor-outer'><div class='pq-editor-inner'></div></div>").appendTo(a),this.$div_focus.css("zIndex",a.zIndex()+5),b=g.extend({all:!0},b.indices),b=this.getCell(b),b.css("height",b.height()),b.empty(),this.refreshEditorPos()};c._removeCellRowOutline=function(a){if(this.$div_focus){a=
this.$div_focus.find(".pq-editor-focus");a.hasClass("hasDatepicker")&&a.datepicker("hide").datepicker("destroy");if(a[0]==document.activeElement){var b=this._blurEditMode;this._blurEditMode=!0;a.blur();this._blurEditMode=b}this.$div_focus.remove();delete this.$div_focus;a=this.options.editModel;b=g.extend({},a.indices);a.indices=null;this.refreshCell(b)}};c.refreshEditorPos=function(){var a=this.options.editModel,b=a.cellBorderWidth,d=this.$div_focus,l=this.getCell(a.indices);if(!l)return!1;var a=
l[0].offsetWidth-(b?2*b:1),s=l[0].offsetHeight-(b?2*b:1),e=this.element.offset(),l=l.offset();d.css({height:s,width:a,borderWidth:b,left:l.left-e.left-1,top:l.top-e.top-1})};c.setEditorPosTimer=function(){var a=this,b=this.options;this._refreshEditorPosTimer&&(window.clearInterval(this._refreshEditorPosTimer),this._refreshEditorPosTimer=null);this._refreshEditorPosTimer=window.setInterval(function(){b.editModel.indices&&a.refreshEditorPos()},200)};c._onHeaderCellClick=function(a,b){var d=this.colModel[a],
l=this.options,s=d.dataIndx;!1!==this._trigger("headerCellClick",b,{column:d,colIndx:a,dataIndx:s})&&l.sortable&&!1!=d.sortable&&this.sort({colIndx:a,column:d,dataIndx:s})};c._selectRow=function(a,b){this.selectRow(a,b)};c._findfirstUnhiddenColIndx=function(){for(var a=0;a<this.colModel.length;a++)if(!this.colModel[a].hidden)return a};c.selectRow=function(a){var b=a.evt;if(b&&("keydown"==b.type||"keypress"==b.type)){if(!1==this.iRows.replace(a))return!1}else if(!1==this.iRows.add(a))return!1;return!0};
c.get$Tbl=function(a,b){var d=this.$tbl,l=[];if(d&&d.length){var s=this.pqpanes,e=this.options,c=e.freezeRows,e=e.freezeCols;s.h&&s.v?null==b?a>=c?l.push(d[2],d[3]):l.push(d[0],d[1]):l=b>=e&&a>=c?d[3]:b<e&&a>=c?d[2]:b>=e&&a<c?d[1]:d[0]:l=s.v?null==b?d:b>=e?d[1]:d[0]:s.h?a>=c?d[1]:d[0]:d[0];if(l)return g(l)}};c.scrollCell=function(a){this.scrollRow(a);this.scrollColumn(a)};c.scrollY=function(a){this.$vscroll.pqScrollBar("option","cur_pos",a).pqScrollBar("scroll")};c.scrollRow=function(a){if(!this.pdata||
a.rowIndxPage>=this.pdata.length)return!1;this.options.virtualY?this._scrollRowVirtualY(a):this._scrollRowNonVirtualY(a)};c._scrollRowNonVirtualY=function(a){var b=this.options,d=a.rowIndxPage,l=this.iHierarchy?!0:!1,s=a.rowIndx;a=this.$cont.data("offsetHeight")-this._getScollBarHorizontalHeight();d=null==d?s-this.rowIndxOffset:d;b=parseInt(b.freezeRows);if(!(d<b)){var b=this.get$Tbl(d),e=this.getRow({rowIndxPage:d});if(d=e[0]){var s=d.offsetTop+parseInt(b.css("marginTop")),c=d.offsetHeight;l&&(l=
e.next("tr.pq-detail-child"))&&l.length&&(c+=l[0].offsetHeight);d.offsetTop<-1*b[0].offsetTop?(l=-1*d.offsetTop-parseInt(b.css("top")),b.css("marginTop",l),this._syncScrollBarVert()):s+c>=a&&(l=a-c-d.offsetTop,b.css("marginTop",l),this._syncScrollBarVert())}}};c._scrollRowVirtualY=function(a){var b=this.options,d=a.rowIndxPage,l=this.iHierarchy?!0:!1,s=a.rowIndx;a=this.scrollCurPos;d=null==d?s-this.rowIndxOffset:d;s=parseInt(b.freezeRows);if(!(d<s)&&(b=this._calcCurPosFromRowIndxPage(d),null!=b)){b<
a&&this.$vscroll.pqScrollBar("option","cur_pos",b).pqScrollBar("scroll");var e=this.get$Tbl(d);if(!e||!e.length)return null;var c=e.children("tbody").children("tr[pq-row-indx="+d+"]"),f=d=c.last();1<c.length&&(f=c.first());var h=d[0],c=parseInt(e.css("marginTop"));if(void 0==h)this.$vscroll.pqScrollBar("option","cur_pos",b).pqScrollBar("scroll");else{var h=h.offsetTop+h.offsetHeight,g=this.$cont[0].offsetHeight,m=this._getScollBarHorizontalHeight(),f=f.prev("tr");if(!f.hasClass("pq-row-hidden")&&
!f.hasClass("pq-last-freeze-row")&&h>g-m-c){f=h-(g-m-c);c=e.children().children("tr");h=e=0;s?(s=c.filter("tr.pq-last-freeze-row").last().next(),0==s.length&&(s=c.filter("tr.pq-row-hidden").next())):s=c.filter("tr.pq-row-hidden").next();do{e+=s[0].offsetHeight;if(s[0]==d[0])break;else if(l&&!1!=s.hasClass("pq-detail-child")||h++,e>=f)break;s=s.next()}while(1);l=a+h;l>b&&(l=b);a=this.$vscroll.pqScrollBar("option","num_eles");a<l+1&&(a=l+1);this.$vscroll.pqScrollBar("option",{num_eles:a,cur_pos:l}).pqScrollBar("scroll")}}}};
c.getTableForVertScroll=function(){var a=this.pqpanes,b=this.$tbl;if(b&&b.length)return a.h&&a.v?b=g([b[2],b[3]]):a.v?b=g([b[0],b[1]]):a.h&&(b=g(b[1])),b};c.getTableForHorScroll=function(){var a=this.pqpanes,b=[],d=this.$tbl;if(d&&d.length)return a.h&&a.v?b.push(d[1],d[3]):a.v?b.push(d[1]):a.h?b.push(d[0],d[1]):b.push(d[0]),this.tables.length&&(d=this.tables[0].$tbl,a.v?b.push(d[1]):b.push(d[0])),g(b)};c.getTableHeaderForHorScroll=function(){var a=this.pqpanes,b=this.$tbl_header;if(b&&b.length)return b=
a.vH?g(b[1]):g(b[0]),b.parent()};c.blurEditor=function(a){if(this.$div_focus){var b=this.$div_focus.find(".pq-editor-focus");if(a&&a.blurIfFocus)document.activeElement==b[0]&&b.blur();else return b.triggerHandler("blur",a)}};c._syncViewWithScrollBarVert=function(a){if(null!=a){var b=this.getTableForVertScroll();if(b&&b.length){var d=this.options;d.editModel.indices&&this.blurEditor({force:!0});var l=b.data("offsetHeight"),s=this.$cont.data("offsetHeight")-this._getScollBarHorizontalHeight();a=-1*
(l-s)*a-1;if((!l||!s)&&d.debug)throw"_syncViewWithScrollBarVert !tblHt || !contHt";-1<a&&(a=-1);b.css({marginTop:a})}}};c._syncViewWithScrollBarHor=function(a){if(null!=a){var b=this.getTableForHorScroll(),d=this.getTableHeaderForHorScroll();if(b||d){this.options.editModel.indices&&this.blurEditor({force:!0});var l=(b?b:d).data("scrollWidth"),s=this.$cont.data("offsetWidth")-this._getSBWidth();a*=-1*(l-s);l&&s&&(0<a&&(a=0),b&&b.css("marginLeft",a),d&&d.css("marginLeft",a))}}};c._syncViewWithScrollBarHorHeader=
function(a){if(null!=a){var b=this.getTableHeaderForHorScroll();if(b){var d=this.options,l=d.freezeCols;d.editModel.indices&&this.blurEditor({force:!0});var d=b.data("scrollWidth"),s=this.$cont.data("offsetWidth")-this._getSBWidth();a=m.call(this,l,a+l);a*=-1;d&&s&&(0<a&&(a=0),b.css("marginLeft",a))}}};c._syncScrollBarVert=function(){var a=this.getTableForVertScroll();if(a&&a.length){var b=a.data("offsetHeight"),d=this.$cont.data("offsetHeight")-this._getScollBarHorizontalHeight(),b=b-d,a=(-1*parseInt(a.css("marginTop"))-
1)/(b-1);0<=a&&1>=a&&this.$vscroll.hasClass("pq-sb-vert")&&this.$vscroll.pqScrollBar("option","ratio",a)}};c._syncScrollBarHor=function(){var a=this.getTableForHorScroll(),b=this.getTableHeaderForHorScroll();if(a||b){var a=a?a:b,b=a.data("scrollWidth"),d=this.$cont.data("offsetWidth")-this._getSBWidth(),b=b-d,a=-1*parseInt(a.css("marginLeft"))/b;0<=a&&1>=a&&this.$hscroll.hasClass("pq-sb-horiz")&&this.$hscroll.pqScrollBar("option","ratio",a)}};c._scrollColumnNonVirtual=function(a){var b=a.colIndx,
b=null==b?this.getColIndx({dataIndx:a.dataIndx}):b,d=this.options.freezeCols;if(!(b<d)){a=this._calcRightEdgeCol(b).width;var b=this._calcRightEdgeCol(b-1).width,d=this._calcRightEdgeCol(d-1).width,l=this._getSBWidth(),s=this.getTableForHorScroll(),e=this.getTableHeaderForHorScroll(),l=this.$cont[0].offsetWidth-l,c,f;if(s)c=parseInt(s.css("marginLeft")),f=s[0].offsetLeft;else if(e)c=parseInt(e.css("marginLeft")),f=e[0].offsetLeft-d;else return;a+c>l?(c=l-a,s&&s.css("marginLeft",c),e&&e.css("marginLeft",
c),this._syncScrollBarHor()):b<-1*f&&(c=-1*b+d,s&&s.css("marginLeft",c),e&&e.css("marginLeft",c),this._syncScrollBarHor())}};c._scrollColumnVirtual=function(a){var b=a.colIndx,b=null==b?this.getColIndx({dataIndx:a.dataIndx}):b;a=this.options.freezeCols;var d=this._calcRightEdgeCol(b).width,l=this._getSBWidth(),l=this.$cont[0].offsetWidth-l;if(d>l){for(var d=m.call(this,-1,b+1)-l,l=this.colModel,e=l.length,r=0,c=0,f=a;f<e;f++){var h=l[f];h.hidden||(r+=h.outerWidth);if(f==b){c=f-a-this._calcNumHiddenUnFrozens(f);
break}else if(r>=d){c=f-a-this._calcNumHiddenUnFrozens(f)+1;break}}this.$hscroll.pqScrollBar("option","cur_pos",c).pqScrollBar("scroll");return!0}return this.hidearrHS[b]?(this.hidearrHS[b]=!1,b=b-a-this._calcNumHiddenUnFrozens(b),this.$hscroll.pqScrollBar("option","cur_pos",b).pqScrollBar("scroll"),!0):!1};c.scrollColumn=function(a){return this.options.virtualX?this._scrollColumnVirtual(a):this._scrollColumnNonVirtual(a)};c.selection=function(a){var b=a.method,d=a.type;if("row"==d)return this.iRows[b](a);
if("cell"==d)return this.iCells[b](a)};c._bringPageIntoView=function(a){a=a.rowIndx;var b=this.options.pageModel;if("local"==b.type&&0<=a){var d=b.curPage,l=b.rPP;a>=(d-1)*l&&a<d*l||(b.curPage=Math.ceil((a+1)/l),this.refreshDataFromDataModel(),this.refresh())}};c.goToPage=function(a){var b=this.options.pageModel;if("local"==b.type||"remote"==b.type){var d=a.rowIndx,l=b.rPP;a=null==a.page?Math.ceil((d+1)/l):a.page;a!=b.curPage&&(b.curPage=a,"local"==b.type?(this.refreshDataFromDataModel(),this.refresh()):
this.refreshDataAndView())}};c.setSelection=function(a){if(null==a)return this.iRows.removeAll({raiseEvent:!0}),this.iCells.removeAll({raiseEvent:!0}),!1;var b=this.pdata,d,l;if(a.rowData)d=this.getRowIndx(a).rowIndx;else{var e=this.rowIndxOffset;d=a.rowIndx;l=a.rowIndxPage;d=null==d?l+e:d}e=null==a.colIndx&&void 0!==a.dataIndx?this.getColIndx({dataIndx:a.dataIndx}):a.colIndx;if(0>d||0>e||e>=this.colModel.length||null==b||0==b.length)return!1;a.rowIndx=d;a.colIndx=e;this._bringPageIntoView(a);l=d-
this.rowIndxOffset;a.rowIndxPage=l;this.scrollRow({rowIndxPage:l});if(null==e)return this._selectRow(a);this.scrollColumn({colIndx:e});return this.selectCell(a)};c.getColModel=function(){return this.colModel};c.saveEditCell=function(a){var b=this.options,d=b.editModel;if(!d.indices)return null;var l=g.extend({},d.indices),d=a?a.evt:null,e=l.rowIndxPage,r=e+this.rowIndxOffset,c=this.colModel[l.colIndx],l=c.dataIndx,f=this.pdata[e],h=b.dataModel,m;if(null==f)return null;m=f[l];if(null!=e){var k=this.getEditCellData();
"<br>"==k&&(k="");null==m&&""===k&&(k=null);c={rowIndx:r,rowIndxPage:e,dataIndx:l,column:c,newVal:k,value:k,oldVal:m,rowData:f,dataModel:h};if(!1===this._trigger("cellBeforeSave",d,c))return!1;f={};f[l]=k;if(!1===this.updateRow({row:f,rowIndx:r,refresh:!1,silent:!0,source:"edit",checkEditable:!1}))return!1;this._trigger("cellSave",d,c);"flex"==b.height?(this._setGridHeightFromTable(),this._fixIEFooterIssue()):a&&this.scrollRow({rowIndxPage:e});return!0}};c._addInvalid=function(a){};c._digestData=
function(a){if(!1===this._trigger("beforeValidate",null,a))return!1;var b=this.options,d=b.editModel,l=b.dataModel,e=l.data,r=b.colModel,c=b.pageModel,f=b.historyModel,h=a.validate,h=null==h?d.validate:h,m=c.type,k=a.allowInvalid,k=null==k?d.allowInvalid:k,p=b.trackModel,d=a.track,d=null==d?null==b.track?p.on:b.track:d,q=a.history,q=null==q?f.on:q,n=a.checkEditable,n=null==n?!0:n,w=a.checkEditableAdd,w=null==w?n:w,y=this.columns,z=this.colIndxs,x=a.source,f=this.rowIndxOffset,A=g.paramquery.getValueFromDataType,
p=a.rowList,B=p.length;e||(e=b.dataModel.data=[]);for(var C=[],F=0;F<B;F++){var E=p[F],G=E.newRow,I=E.rowData,K=E.type,O=E.checkEditable,P=E.rowIndx,S=E.oldRow;null==O&&("update"==K?O=n:"add"==K&&(O=w));if("update"==K){if(!S||!I)throw"assert failed: oldRow and rowData required while update";if(O&&!0!==b.editable&&!1===this.isEditableRow({rowIndx:P,rowData:I}))continue}else if("delete"==K){C.push(E);continue}if("add"==K)for(var Q=0,T=r.length;Q<T;Q++){var R=r[Q],N=R.dataIndx;G[N]=G[N]}for(N in G){R=
y[N];Q=z[N];if(R){if(O&&null!=R.editable&&!1===this.isEditableCell({rowIndx:P,colIndx:Q,dataIndx:N})){delete G[N];continue}var T=R.dataType,Q=A(G[N],T),U=I?I[N]:void 0,U=void 0!==U?A(U,T):void 0;G[N]=Q;if(h&&R.validations)if("edit"==x&&!1===k){if(R=this.isValid({dataIndx:N,rowIndx:P,value:Q}),!1==R.valid&&!R.warn)return!1}else R=this.iIsValid.isValidCell({column:R,rowData:"add"==K?G:I,allowInvalid:k,value:Q}),!1===R.valid&&(!1!==k||R.warn||delete G[N]);if("update"==K&&Q===U){if("edit"==x)return null;
delete G[N];continue}}"update"==K&&(S[N]=U)}if(G)if("update"==K)for(N in G){C.push(E);break}else C.push(E)}p=a.rowList=C;B=p.length;if(!B)return!1;q&&(this.iHistory.increment(),this.iHistory.push({rowList:p}));for(F=0;F<B;F++)if(E=p[F],K=E.type,G=E.newRow,P=E.rowIndx,b=E.rowIndxPage,I=E.rowData,"update"==K)for(N in d&&this.iUCData.update({rowData:I,row:G,refresh:!1}),G)Q=G[N],I[N]=Q;else if("add"==K)d&&this.iUCData.add({rowData:G}),null==P&&null==b?e.push(G):(b=P-f,b="remote"==m?b:P,e.splice(b,0,
G)),"remote"==m&&c.totalRecords++;else if("delete"==K){b=this.getRowIndx({rowData:I});r=b.uf;P=b.rowIndx;if(d)this.iUCData["delete"]({rowIndx:P,rowData:I});b=P-f;b="remote"==m?b:P;r?l.dataUF.splice(b,1):(b=e.splice(b,1))&&b.length&&"remote"==m&&c.totalRecords--}this._trigger("change",null,a);return!0};c._fixTableViewPort=function(){var a=this.element[0];a.scrollTop=0;a.scrollLeft=0;a=this.$header_o[0];a.scrollLeft=0;a.scrollTop=0;this.iGenerateView.setPanes()};c._fixIEFooterIssue=function(){g(".pq-grid-footer").css({position:"absolute"});
g(".pq-grid-footer").css({position:"relative"})};c.refreshColumn=function(a){var b=this.colModel,d=a.colIndx,l=a.dataIndx,d=null==d?this.getColIndx({dataIndx:l}):d,l=null==l?b[d]:l,e=this.rowIndxOffset;a.colIndx=d;for(var r=this.initV,c=this.finalV,f=r;f<=c;f++){var h=f;a.rowIndx=h+e;a.rowIndxPage=h;a.colIndx=d;a.column=b[d];a.skip=!0;this.refreshCell(a)}this._fixTableViewPort();this._refreshScrollbars();this._trigger("refreshColumn",null,{dataModel:this.options.dataModel,colModel:b,initV:r,finalV:c,
colIndx:d,dataIndx:l})};c.refreshCell=function(a){if(this.pdata){var b=this.rowIndxOffset,d=a.skip,l=a.rowIndx,e=a.rowIndxPage,l=a.rowIndx=null==l?e+b:l,e=a.rowIndxPage=null==e?l-b:e,b=a.dataIndx,r=a.colIndx,r=a.colIndx=null==r?this.getColIndx({dataIndx:b}):r,c=this.getCell({all:!0,rowIndxPage:e,colIndx:r}),f=a.column,h=this.colModel;a.column=f?f:h[r];var g=this.options.treeModel;if(f=this.pdata[e])a.tree=g.labelIndx?!0:!1,a.rowData=f,c&&0<c.length&&(a=this.iGenerateView.renderCell(a),c.replaceWith(a),
d||(this._fixTableViewPort(),this._refreshScrollbars(),this._trigger("refreshCell",null,{dataModel:this.options.dataModel,colModel:h,rowData:f,rowIndx:l,rowIndxPage:e,colIndx:r,dataIndx:b})))}};c.refreshRow=function(a){if(this.pdata){var b=this.rowIndxOffset,d=a.rowIndx;a=a.rowIndxPage;d=null==d?a+b:d;a=null==a?d-b:a;var b=this.getRow({all:!0,rowIndxPage:a}),l=this.colModel,e=this.pdata[a],r=!1,c=document.activeElement;g(c);if(c==b[0]||1<b.length&&c==b[1])r=!0;if(!e||!b||!b.length)return null;c=[];
this.iGenerateView.refreshRow(a,l,c);l=c.join("");b.replaceWith(l);this._fixTableViewPort();this._refreshScrollbars();r&&this.getRow({all:!0,rowIndxPage:a}).attr("tabindex",0).focus();this._trigger("refreshRow",null,{rowData:e,rowIndx:d,rowIndxPage:a});return!0}};c.quitEditMode=function(a){if(!this._quitEditMode){var b=!1,d=!1,l=!1,e=this.options.editModel,r=e.indices,c=void 0;this._quitEditMode=!0;a&&(b=a.old,d=a.silent,l=a.fireOnly,c=a.evt);r&&(d||b||this._trigger("editorEnd",c,r),l||(this._removeCellRowOutline(a),
e.indices=null));this._quitEditMode=null}};c._fixIE=function(){var a=this.$cont[0];a.scrollLeft=0;a.scrollTop=0};c.getData=function(){return this.pdata};c.getViewPortRowsIndx=function(){return{beginIndx:this.initV,endIndx:this.finalV}};c.getViewPortIndx=function(){return{initV:this.initV,finalV:this.finalV,initH:this.initH,finalH:this.finalH}};c.getRowIndxOffset=function(){return this.rowIndxOffset};c.selectCell=function(a){var b=a.evt;if(b&&("keydown"==b.type||"keypress"==b.type)){if(!1==this.iCells.replace(a))return!1}else if(!1===
this.iCells.add(a))return!1;return!0};c.getEditCell=function(){var a=this.options.editModel;if(a.indices){var a=this.getCell(a.indices),b=this.$div_focus.children(".pq-editor-inner"),d=b.find(".pq-editor-focus");return{$td:a,$cell:b,$editor:d}}return null};c.editCell=function(a){this.scrollRow(a);this.scrollColumn(a);var b=this.getCell(a);if(b&&b.length)return this._editCell(a)};c.getFirstEditableColIndx=function(a){if(null==a.rowIndx)throw"rowIndx NA";if(!this.isEditableRow(a))return-1;for(var b=
this.colModel,d=0;d<b.length;d++)if(a.colIndx=d,this.isEditableCell(a)&&!b[d].hidden)return d;return-1};c.editFirstCellInRow=function(a){var b=this.rowIndxOffset,d=a.rowIndx;a=a.rowIndxPage;d=null==d?a+b:d;a=null==a?d-b:a;b=this.getFirstEditableColIndx({rowIndx:d});-1!=b&&this.editCell({rowIndxPage:a,colIndx:b})};c._editCell=function(a){var b=this,d=a.evt,l=this.rowIndxOffset,e=a.rowIndxPage,r=a.rowIndx,r=null==r?e+l:r,e=null==e?r-l:e,l=a.colIndx,c=a.dataIndx,l=null==l?this.getColIndx({dataIndx:c}):
l,f=this.colModel[l],c=f.dataIndx,h=f.editor,k=this.options,m=k.editModel,k=k.editor,p=h?g.extend({},k,h):k,h=b.pdata[e],k=!1;if(!this.pdata||e>=this.pdata.length)return!1;if(m.indices){var q=m.indices;if(q.rowIndxPage==e&&q.colIndx==l){this.refreshEditorPos();var n=this.$div_focus.find(".pq-editor-focus");window.setTimeout(function(){n.focus()},0);return!1}if(!1===this.blurEditor({evt:d}))return!1;this.quitEditMode({evt:d})}m.indices={rowIndxPage:e,rowIndx:r,colIndx:l,column:f,dataIndx:c};this._generateCellRowOutline();
q=this.$div_focus.children(".pq-editor-inner");"right"==f.align?q.addClass("pq-align-right"):"center"==f.align?q.addClass("pq-align-center"):q.addClass("pq-align-left");var w=h[c],y=p.type;a=null==a.select?p.select:a.select;var z=p.init,x="pq-editor-focus "+(p.cls?p.cls:""),A=x+" pq-cell-editor ",B=p.attr?p.attr:"",C=p.style,F=(C=C?C:"")?"style='"+C+"'":"",E=q.width()-8,G="style='width:"+E+"px;"+C+"'",I=C?"style='"+C+"'":"",C={rowIndx:r,rowIndxPage:e,$cell:q,cellData:w,rowData:h,cls:x,dataIndx:c,
column:f};"function"==typeof y?p=y.call(b.element[0],C):"checkbox"==y?(p=p.subtype,q.html("<input "+(w?"checked='checked'":"")+" class='"+A+"' "+B+" "+I+" type=checkbox name='"+c+"' />"),E=q.children("input"),"triple"==p&&(E.pqval({val:w}),q.click(function(a){g(this).children("input").pqval({incr:!0})}))):"textarea"==y||"select"==y||"textbox"==y?("textarea"==y?p="<textarea class='"+A+"' "+B+" "+G+" name='"+c+"' ></textarea>":"select"==y?(y=(y=p.options)?y:[],"function"===typeof y&&(y=y.call(b.element[0],
{column:f,rowData:h})),A=[B," class='",A,"' ",G," name='",c,"'"].join(""),p=g.paramquery.select({options:y,attr:A,prepend:p.prepend,labelIndx:p.labelIndx,valueIndx:p.valueIndx,groupIndx:p.groupIndx})):p="<input class='"+A+"' "+B+" "+G+" type=text name='"+c+"' />",g(p).appendTo(q).width(E).val(w)):(q.html("<div contenteditable='true' tabindx='0' "+F+" "+B+" class='pq-editor-default "+x+"'></div>"),q.children().html(w),k=!0);"function"==typeof z&&z.call(b.element[0],C);var b=this,n=q.children(".pq-editor-focus"),
K=m.filterKeys;(w=f.editModel)&&void 0!==w.filterKeys&&(K=w.filterKeys);var O={$cell:q,$editor:n,dataIndx:c,column:f,colIndx:l,rowIndx:r,rowIndxPage:e,rowData:h};m.indices=O;n.data({FK:K}).on("click",function(a){g(this).focus()}).on("keydown",function(a){b.iKeyNav._keyDownInEdit(a)}).on("keypress",function(a){return b.iKeyNav._keyPressInEdit(a,{FK:K})}).on("keyup",function(a){return b.iKeyNav._keyUpInEdit(a,{FK:K})}).on("blur",function(a,d){var l=b.options.editModel,e=l.onBlur,s="save"==e,c="validate"==
e,r=l.cancelBlurCls,f=d?d.force:!1;if(!b._quitEditMode&&!b._blurEditMode&&l.indices){l=g(a.target);if(!f){if(!1===b._trigger("editorBlur",a,O)||!e||r&&l.hasClass(r))return;if(l.hasClass("hasDatepicker")){if(l.datepicker("widget").is(":visible"))return!1}else if(l.hasClass("ui-autocomplete-input")){if(l.autocomplete("widget").is(":visible"))return}else if(l.hasClass("ui-multiselect")){if(g(".ui-multiselect-menu").is(":visible")||g(document.activeElement).closest(".ui-multiselect-menu").length)return}else if(l.hasClass("pq-select-button")&&
(g(".pq-select-menu").is(":visible")||g(document.activeElement).closest(".pq-select-menu").length))return}b._blurEditMode=!0;if(!b.saveEditCell({evt:a,silent:f||s||!c})&&!f&&c)return b._deleteBlurEditMode(),!1;b.quitEditMode({evt:a});b._deleteBlurEditMode()}}).on("focus",function(a){b._trigger("editorFocus",a,O)});b._trigger("editorBegin",d,O);n.focus();window.setTimeout(function(){!1===g(document.activeElement).hasClass("pq-editor-focus")&&b.element.find(".pq-editor-focus").focus()},0);b.element[0].scrollLeft=
0;b.element[0].scrollTop=0;if(a)if(k)try{var P=n[0],S=document.createRange();S.selectNodeContents(P);var Q=window.getSelection();Q.removeAllRanges();Q.addRange(S)}catch(T){}else n.select()};c._deleteBlurEditMode=function(a){var b=this;a=a?a:{};b._blurEditMode&&(a.timer?window.setTimeout(function(){delete b._blurEditMode},0):delete b._blurEditMode)};c.getRow=function(a){var b=a.rowIndxPage,d=a.rowIndx,l=this.rowIndxOffset,b=null==b?d-l:b;a=a.all?this.$tbl:this.get$Tbl(b);var e;a&&a.length&&(d=a.children("tbody"),
null!=b&&(e=d.children("tr[pq-row-indx="+b+"]"),e.length>a.length&&(e=e.filter(".pq-detail-master"))));return e};c.getCell=function(a){var b=a.rowIndxPage,d=a.rowIndx,b=null==b?d-this.rowIndxOffset:b,d=a.colIndx,l=a.dataIndx,d=null==d?this.getColIndx({dataIndx:l}):d;a=a.all?this.$tbl:this.get$Tbl(b,d);var e;return void 0!=a&&(e=a.children().children("tr[pq-row-indx="+b+"]").children("td[pq-col-indx="+d+"]"),0==e.length)?null:e};c.getCellHeader=function(a){var b=a.colIndx;a=a.dataIndx;b=null==b?this.getColIndx({dataIndx:a}):
b;a=this.$tbl_header;var d,l=this.options.freezeCols;void 0!=a&&(1<a.length&&(a=b>=l?g(a[1]):g(a[0])),d=a.children().children("tr.pq-grid-title-row:last").children("td[pq-col-indx="+b+"]"));return 0==d.length||"hidden"==d[0].style.visibility?null:d};c.getEditorIndices=function(){var a=this.options.editModel.indices;return a?g.extend({},a):null};c.getEditCellData=function(){var a=this.options,b=a.editModel.indices;if(!b)return null;var d=b.rowIndxPage,l=b.rowIndx,b=this.colModel[b.colIndx],e=b.editor,
a=a.editor,a=e?g.extend({},a,e):a,c=b.dataIndx,e=this.$div_focus.children(".pq-editor-inner"),f;"function"==typeof a.getData?f=a.getData.call(this.element[0],{$cell:e,dataIndx:c,rowIndx:l,rowIndxPage:d,column:b}):(d=a.type,"checkbox"==d?(f=e.children(),f="triple"==a.subtype?f.pqval():f.is(":checked")?!0:!1):"contenteditable"==d?f=e.children().html():(d=e.find('*[name="'+c+'"]'))&&d.length?f=d.val():(d=e.find(".pq-editor-focus"))&&d.length&&(f=d.val()));return f};c.getCellIndices=function(a){var b=
a.$td;if(null==b||0==b.length||b.closest(".pq-grid")[0]!=this.element[0])return{rowIndxPage:null,colIndx:null};a=b.parent("tr").attr("pq-row-indx");var d;null!=a&&(a=parseInt(a),d=a+this.rowIndxOffset);var b=b.attr("pq-col-indx"),l;null!=b&&(b=parseInt(b),l=this.colModel[b].dataIndx);return{rowIndxPage:a,rowIndx:d,colIndx:b,dataIndx:l}};c.getRowsByClass=function(a){var b=this.options,d="remote"==b.pageModel.type?!0:!1,l=this.rowIndxOffset,b=b.dataModel.data,e=[];if(null==b)return e;for(var c=0,f=
b.length;c<f;c++){var h=b[c];a.rowData=h;this.hasClass(a)&&(h={rowData:h},h.rowIndx=d?c+l:c,e.push(h))}return e};c.getCellsByClass=function(a){var b=this.options,d="remote"==b.pageModel.type?!0:!1,l=this.rowIndxOffset,b=b.dataModel.data,e=this.colModel,c=e.length,f=[],h=function(a){for(var b=0;b<c;b++){var h=e[b].dataIndx;a.dataIndx=h;this.hasClass(a)&&(h={rowData:m,dataIndx:h,colIndx:b},h.rowIndx=d?g+l:g,f.push(h))}};if(null==b)return f;if(null!=a.rowIndx||null!=a.rowIndxPage||null!=a.rowData)a.rowData=
a.rowData||this.getRowData(a),h(a);else for(var g=0,k=b.length;g<k;g++){var m=b[g];a.rowData=m;h(a)}return f};c.data=function(a){var b=a.dataIndx,d=a.data,l=null==d||"string"==typeof d?!0:!1;a=a.rowData||this.getRowData(a);if(!a)return null;if(null==b){b=a.pq_rowdata;if(l){var e;null!=b&&(e=null==d?b:b[d]);return{data:e}}d=g.extend(!0,a.pq_rowdata,d);a.pq_rowdata=d}else{var c=a.pq_celldata;if(l)return null!=c&&(b=c[b],e=null==d||null==b?b:b[d]),{data:e};c||(a.pq_celldata={});d=g.extend(!0,a.pq_celldata[b],
d);a.pq_celldata[b]=d}};c.attr=function(a){var b=a.rowIndx,d=a.dataIndx,l=a.attr,e=null==l||"string"==typeof l?!0:!1,c=this.rowIndxOffset,f=a.refresh;a=a.rowData||this.getRowData(a);if(!a)return null;e||!1===f||null!=b||(b=this.getRowIndx({rowData:a}).rowIndx);if(null==d){d=a.pq_rowattr;if(e){var h;null!=d&&(h=null==l?d:d[l]);return{attr:h}}l=g.extend(a.pq_rowattr,l);a.pq_rowattr=l;!1!==f&&null!=b&&(b=this.getRow({rowIndxPage:b-c}))&&b.attr(l)}else{var k=a.pq_cellattr;if(e)return null!=k&&(b=k[d],
h=null==l||null==b?b:b[l]),{attr:h};k||(a.pq_cellattr={});l=g.extend(a.pq_cellattr[d],l);a.pq_cellattr[d]=l;!1!==f&&null!=b&&(b=this.getCell({rowIndxPage:b-c,dataIndx:d}))&&b.attr(l)}};c.removeData=function(a){var b=a.dataIndx,d=a.data,d=null==d?[]:d,d="string"==typeof d?d.split(" "):d,l=d.length,e=a.rowData||this.getRowData(a);if(e)if(null==b){if(b=e.pq_rowdata){if(l)for(a=0;a<l;a++){var c=d[a];delete b[c]}l&&!g.isEmptyObject(b)||delete e.pq_rowdata}}else if((e=e.pq_celldata)&&e[b]){var f=e[b];if(l)for(a=
0;a<l;a++)c=d[a],delete f[c];l&&!g.isEmptyObject(f)||delete e[b]}};c.removeAttr=function(a){var b=a.rowIndx,d=a.dataIndx,l=a.attr,l=null==l?[]:l,l="string"==typeof l?l.split(" "):l,e=l.length,c=b-this.rowIndxOffset,f=a.refresh,h=a.rowData||this.getRowData(a);if(h)if(!1!==f&&null==b&&(b=this.getRowIndx({rowData:h}).rowIndx),null==d){if(d=h.pq_rowattr){if(e)for(a=0;a<e;a++){var k=l[a];delete d[k]}else for(k in d)l.push(k);e&&!g.isEmptyObject(d)||delete h.pq_rowattr}!1!==f&&null!=b&&l.length&&(l=l.join(" "),
(b=this.getRow({rowIndxPage:c}))&&b.removeAttr(l))}else{if((h=h.pq_cellattr)&&h[d]){var m=h[d];if(e)for(a=0;a<e;a++)k=l[a],delete m[k];else for(k in m)l.push(k);e&&!g.isEmptyObject(m)||delete h[d]}!1!==f&&null!=b&&l.length&&(l=l.join(" "),(b=this.getCell({rowIndxPage:c,dataIndx:d}))&&b.removeAttr(l))}};g.paramquery.uniqueArray=function(a){for(var b=[],d=g.inArray,l=0,e=a.length;l<e;l++){var c=a[l];-1==d(c,b)&&b.push(c)}return b};c.addClass=function(a){var b=a.rowIndx,d=a.dataIndx,l=g.paramquery.uniqueArray,
e=a.cls,c=this.rowIndxOffset,f=a.refresh,h=a.rowData||this.getRowData(a);if(h)if(!1!==f&&null==b&&(b=this.getRowIndx({rowData:h}).rowIndx),null==d){var d=h.pq_rowcls,k;k=l((d?d+" "+e:e).split(/\s+/)).join(" ");h.pq_rowcls=k;!1!==f&&null!=b&&(b=this.getRow({rowIndxPage:b-c}))&&b.addClass(e)}else{a=[];"function"!=typeof d.push?a.push(d):a=d;var m=h.pq_cellcls;m||(m=h.pq_cellcls={});for(var h=0,p=a.length;h<p;h++)d=a[h],k=(k=m[d])?k+" "+e:e,k=l(k.split(/\s+/)).join(" "),m[d]=k,!1!==f&&null!=b&&(d=this.getCell({rowIndxPage:b-
c,dataIndx:d}))&&d.addClass(e)}};c.removeClass=function(a){var b=a.rowIndx,d=this.getRowData(a),l=a.dataIndx,e=a.cls;a=a.refresh;if(d){var c=d.pq_cellcls,f=d.pq_rowcls;!1!==a&&null==b&&(b=this.getRowIndx({rowData:d}).rowIndx);if(null==l)f&&(d.pq_rowcls=this._removeClass(f,e),null!=b&&!1!==a&&(b=this.getRow({rowIndx:b}))&&b.removeClass(e));else if(c){f=[];"function"!=typeof l.push?f.push(l):f=l;for(var h=0,g=f.length;h<g;h++){var l=f[h],k=c[l];k&&(d.pq_cellcls[l]=this._removeClass(k,e),null!=b&&!1!==
a&&(l=this.getCell({rowIndx:b,dataIndx:l}))&&l.removeClass(e))}}}};c.hasClass=function(a){var b=a.dataIndx,d=a.cls;a=this.getRowData(a);d=new RegExp("\\b"+d+"\\b");return a?null==b?(b=a.pq_rowcls)&&d.test(b)?!0:!1:(a=a.pq_cellcls)&&a[b]&&d.test(a[b])?!0:!1:null};c._removeClass=function(a,b){if(a&&b){for(var d=a.split(/\s+/),l=b.split(/\s+/),e=[],c=0,f=d.length;c<f;c++){for(var h=d[c],g=!1,k=0,m=l.length;k<m;k++)if(h===l[k]){g=!0;break}g||e.push(h)}return 1<e.length?e.join(" "):1===e.length?e[0]:null}};
c.getRowIndx=function(a){var b=a.$tr;if(a=a.rowData){var b=this.options,d=b.dataModel,b="remote"==b.pageModel.type?!0:!1,l=d.data,e=!1,d=d.dataUF,c=!1;if(l)for(var f=0,h=l.length;f<h;f++)if(l[f]==a){c=!0;break}if(!c&&d)for(e=!0,f=0,h=d.length;f<h;f++)if(d[f]==a){c=!0;break}return c?(a=this.rowIndxOffset,{rowIndxPage:e?void 0:b?f:f-a,uf:e,rowIndx:b?f+a:f}):{}}if(null==b||0==b.length)return{rowIndxPage:null};f=b.attr("pq-row-indx");if(null==f)return{rowIndxPage:null};f=parseInt(f);return{rowIndxPage:f,
rowIndx:f+this.rowIndxOffset}};var p=function(a){this.options=a.options;this.that=a;var b=this,d=a.widgetEventPrefix.toLowerCase();a.element.on(d+"celleditkeyup"+a.eventNamespace,function(a,d){return b.filterKeys(a,d)})},f=p.prototype;f._incrRowIndx=function(a,b){var d=this.that,l=a;b=null==b?1:b;for(var d=d.pdata,e=0,c=a+1,f=d.length;c<f&&(d[c].pq_hidden||(e++,l=c,e!=b));c++);return l};f._decrRowIndx=function(a,b){var d=a,l=this.that.pdata;b=null==b?1:b;for(var e=0,c=a-1;0<=c&&(l[c].pq_hidden||(e++,
d=c,e!=b));c--);return d};c.addColumn=function(a,b){var d=this.options,l=d.dataModel.data;d.colModel.push(a);this._calcThisColModel();for(d=0;d<l.length;d++)l[d].push("")};c.rowNextSelect=function(){var a=this.selection({type:"row",method:"getSelection"}),b,d=this.rowIndxOffset;a&&a[0]&&(a=a[0].rowIndx,b=this.iKeyNav._incrRowIndx(a-d));null!=b&&(this.setSelection(null),this._setSelection({rowIndxPage:b}));return b};c.rowPrevSelect=function(){var a=this.selection({type:"row",method:"getSelection"}),
b,d=this.rowIndxOffset;a&&a[0]&&(a=a[0].rowIndx,b=this.iKeyNav._decrRowIndx(a-d));null!=b&&(this.setSelection(null),this.setSelection({rowIndxPage:b}));return b};f._incrIndx=function(a,b){var d=this.that,l=d._getLastVisibleRowIndxPage(d.pdata),d=d.colModel,e=d.length;if(null==b){if(a==l)return null;a=this._incrRowIndx(a);return{rowIndxPage:a}}var c;do{b++;if(b>=e){if(a==l)return null;a=this._incrRowIndx(a);b=0}c=d[b]}while(c&&c.hidden);return{rowIndxPage:a,colIndx:b}};f._decrIndx=function(a,b){var d=
this.that,l=d.colModel,e=l.length,d=d._getFirstVisibleRowIndxPage(d.pdata);if(null==b){if(a==d)return null;a=this._decrRowIndx(a);return{rowIndxPage:a}}var c;do{b--;if(0>b){if(a==d)return null;a=this._decrRowIndx(a);b=e-1}c=l[b]}while(c&&c.hidden);return{rowIndxPage:a,colIndx:b}};f._incrEditIndx=function(a,b){var d=this.that,l=d.colModel,e=l.length,c,f=d.rowIndxOffset,h=d._getLastVisibleRowIndxPage(d.pdata);do{b++;if(b>=e){if(a==h)return null;do{a=this._incrRowIndx(a);var g=a+f;c=d.isEditableRow({rowIndx:g});
if(a==h&&!1==c)return null}while(!1==c);b=0}c=l[b];g=a+f;g=d.isEditableCell({rowIndx:g,colIndx:b,checkVisible:!0})}while(c&&(c.hidden||!1==g));return{rowIndxPage:a,colIndx:b}};f._decrEditIndx=function(a,b){var d=this.that,l=d.colModel,e=l.length,c,f=d.rowIndxOffset,h=d._getFirstVisibleRowIndxPage(d.pdata);do{b--;if(0>b){if(a==h)return null;do{a=this._decrRowIndx(a);var g=a+f;c=d.isEditableRow({rowIndx:g});if(a==h&&!1==c)return null}while(!1==c);b=e-1}c=l[b];g=a+f;g=d.isEditableCell({rowIndx:g,colIndx:b,
checkVisible:!0})}while(c&&(c.hidden||!1==g));return{rowIndxPage:a,colIndx:b}};f._incrEditRowIndx=function(a,b){var d=this.that,l=d.rowIndxOffset,e=d._getLastVisibleRowIndxPage(d.pdata);if(a==e)return null;do{a=this._incrRowIndx(a);var c=a+l,f=d.isEditableRow({rowIndx:c}),c=d.isEditableCell({rowIndx:c,colIndx:b}),f=f&&c;if(a==e&&!f)return null}while(!f);return{rowIndxPage:a,colIndx:b}};f._decrEditRowIndx=function(a,b){var d=this.that,l=d.rowIndxOffset,e=d._getFirstVisibleRowIndxPage(d.pdata);if(a==
e)return null;do{a=this._decrRowIndx(a);var c=a+l,f=d.isEditableRow({rowIndx:c}),c=d.isEditableCell({rowIndx:c,colIndx:b}),f=f&&c;if(a==e&&!f)return null}while(!f);return{rowIndxPage:a,colIndx:b}};c._onKeyPressDown=function(a){if(0<g(a.target).closest(".pq-grid-header").length)return!1==this._trigger("headerKeyDown",a,{dataModel:this.options.dataModel})?!1:!0;if(!1===this.iKeyNav._bodyKeyPressDown(a)||!1==this._trigger("keyDown",a,{dataModel:this.options.dataModel}))return!1};f._saveAndMove=function(a,
b){if(null==a)return b.preventDefault(),!1;var d=this.that,l=this.options.selectionModel,e=a.rowIndxPage,c=a.colIndx;d._blurEditMode=!0;if(!1===d.saveEditCell({evt:b})||!d.pdata)return d.pdata||d.quitEditMode(b),d._deleteBlurEditMode({timer:!0,msg:"_saveAndMove saveEditCell"}),b.preventDefault(),!1;d.quitEditMode(b);if(a.incr)var f,e=(f=b.shiftKey?this._decrEditIndx(e,c):this._incrEditIndx(e,c))?f.rowIndxPage:e,c=f?f.colIndx:c;"row"==l.type?(d.setSelection(null),d.setSelection({rowIndxPage:e}),d.scrollColumn({colIndx:c})):
"cell"==l.type?(d.setSelection(null),d.setSelection({rowIndxPage:e,colIndx:c})):(d.scrollRow({rowIndxPage:e}),d.scrollColumn({colIndx:c}));!1!==a.edit&&d._editCell({rowIndxPage:e,colIndx:c});d._deleteBlurEditMode({timer:!0,msg:"_saveAndMove"});b.preventDefault();return!1};f._keyPressInEdit=function(a,b){var d=this.that,l=d.options.editModel.indices;b=b?b:{};var e=b.FK,c="Backspace Left Right Up Down Del Home End".split(" "),f=l.column.dataType;return a.key&&-1!==g.inArray(a.key,c)?!0:!1===d._trigger("editorKeyPress",
a,g.extend({},l))||e&&("float"==f||"integer"==f)&&(d="float"==f?"0123456789.-":"0123456789-",l=(l=a.charCode)?l:a.keyCode,(l=String.fromCharCode(l))&&-1==d.indexOf(l))?!1:!0};f.getValText=function(a){a=a[0].nodeName.toLowerCase();var b="text";-1!=g.inArray(a,["input","textarea","select"])&&(b="val");return b};f._keyUpInEdit=function(a,b){var d=this.that,l=d.options;b=b?b:{};var e=b.FK,l=l.editModel,c=l.indices;d._trigger("editorKeyUp",a,g.extend({},c));d=c.column.dataType;if(e&&("float"==d||"integer"==
d)){var e=g(a.target),c="integer"==d?l.reInt:l.reFloat,l=this.getValText(e),f=e.data("oldVal"),h=e[l]();if(!1==c.test(h))if(c.test(f))e[l](f);else if(d="float"==d?parseFloat(f):parseInt(f),isNaN(d))e[l](0);else e[l](d)}};f._keyDownInEdit=function(a){var b=this.that,d=b.options,l=d.editModel.indices;if(l){var e=g(a.target),c=g.ui.keyCode,f=d.selectionModel,h=d.editModel,l=g.extend({},l),d=l.rowIndxPage,k=l.colIndx,m=l.column.editModel,h=m?g.extend({},h,m):h,m=this.getValText(e);e.data("oldVal",e[m]());
if(!1==b._trigger("cellEditKeyDown",a,l)||!1==b._trigger("editorKeyDown",a,l))return!1;if(a.keyCode==c.TAB)return l={rowIndxPage:d,colIndx:k,incr:!0},this._saveAndMove(l,a);if(a.keyCode==h.saveKey)return l="next"==h.onSave?{rowIndxPage:d,colIndx:k,incr:!0}:{rowIndxPage:d,colIndx:k,edit:!1},this._saveAndMove(l,a);if(a.keyCode==c.ESCAPE)return b.quitEditMode({evt:a}),"cell"==f.type?b.getCell({rowIndxPage:d,colIndx:k}).attr("tabindex",0).focus():"row"==f.type&&(b=b.getRow({rowIndxPage:d}),g(b[0]).attr("tabindex",
0).focus()),a.preventDefault(),!1;if(a.keyCode==c.PAGE_UP||a.keyCode==c.PAGE_DOWN)return a.preventDefault(),!1;if(h.keyUpDown){if(a.keyCode==c.DOWN)return l=this._incrEditRowIndx(d,k),this._saveAndMove(l,a);if(a.keyCode==c.UP)return l=this._decrEditRowIndx(d,k),this._saveAndMove(l,a)}}};f.select=function(a){var b=this.that,d=a.rowIndx,l=a.colIndx,e=b.options.selectionModel;a=a.evt;a.shiftKey&&"single"!=e.mode?"row"==e.type?(b.scrollRow({rowIndx:d}),b.iRows.extendSelection({rowIndx:d,evt:a})):"cell"==
e.type&&(b.scrollCell({rowIndx:d,colIndx:l}),b.iCells.extendSelection({rowIndx:d,colIndx:l,evt:a})):b.setSelection({rowIndx:d,colIndx:l,evt:a,setFirst:!0})};f._bodyKeyPressDown=function(a){var b=this.that,d,l,e=b.rowIndxOffset,c=this.options,f=b.colModel,h=c.selectionModel,k=c.editModel,m=a.ctrlKey||a.metaKey,p,q,n=g.ui.keyCode,t=a.keyCode;if(k.indices)b.$div_focus.find(".pq-cell-focus").focus();else{if("row"==h.type){l=m?b.iRows.getFocusSelection({old:!0}):b.iRows.getFocusSelection({old:!1});if(null==
l)return;p=l.rowIndx;c=p-e;if(null==p)return;if(!1==b._trigger("rowKeyDown",a,{rowData:b.pdata[c],rowIndx:p,rowIndxPage:c}))return!1}else if("cell"==h.type){d=m?b.iCells.getFocusSelection({old:!0}):b.iCells.getFocusSelection({old:!1});if(null==d)return;q=d;p=q.rowIndx;var c=p-e,w=q.dataIndx;q=b.getColIndx({dataIndx:w});if(null==p||null==q)return;if(!1==b._trigger("cellKeyDown",a,{rowData:b.pdata[c],rowIndx:p,rowIndxPage:c,colIndx:q,dataIndx:w,column:f[q]}))return!1;if(a.cancelBubble)return}else return;
if(t==n.LEFT){if(q=this._decrIndx(c,q))p=q.rowIndxPage+e,this.select({rowIndx:p,colIndx:q.colIndx,evt:a});a.preventDefault()}else if(t==n.RIGHT){if(q=this._incrIndx(c,q))p=q.rowIndxPage+e,this.select({rowIndx:p,colIndx:q.colIndx,evt:a});a.preventDefault()}else if(t==n.UP)c=this._decrRowIndx(c),null!=c&&this.select({rowIndx:c+e,colIndx:q,evt:a}),a.preventDefault();else if(t==n.DOWN)c=this._incrRowIndx(c),null!=c&&this.select({rowIndx:c+e,colIndx:q,evt:a}),a.preventDefault();else if(t==n.PAGE_DOWN||
t==n.SPACE){if(b=this.pageDown(c))c=b.rowIndxPage,null!=c&&this.select({rowIndx:c+e,colIndx:q,evt:a});a.preventDefault()}else if(t==n.PAGE_UP){if(b=this.pageUp(c))c=b.rowIndxPage,null!=c&&this.select({rowIndx:c+e,colIndx:q,evt:a});a.preventDefault()}else t==n.HOME?("row"==h.type||m?(p=b._getFirstVisibleRowIndxPage(b.pdata)+e,this.select({rowIndx:p,colIndx:q,evt:a})):"cell"==h.type&&(q=b._getFirstVisibleColIndx(),this.select({rowIndx:p,colIndx:q,evt:a})),a.preventDefault()):t==n.END?("row"==h.type||
m?(p=b._getLastVisibleRowIndxPage(b.pdata)+e,this.select({rowIndx:p,colIndx:q,evt:a})):"cell"==h.type&&(q=b._getLastVisibleColIndx(),this.select({rowIndx:p,colIndx:q,evt:a})),a.preventDefault()):t==n.ENTER?("row"==h.type?null!=l&&b.editFirstCellInRow({rowIndx:c+e}):null!=d&&(d=b.getCell({rowIndxPage:c,colIndx:q}))&&0<d.length&&(p=c+e,e=b.isEditableRow({rowIndx:p}),d=b.isEditableCell({rowIndx:p,colIndx:q}),e&&d&&b.editCell({rowIndxPage:c,colIndx:q})),a.preventDefault()):m&&"65"==t?("row"==h.type&&
"single"!=h.mode?b.iRows.selectAll({all:h.all}):"cell"==h.type&&"single"!=h.mode&&b.iCells.selectAll({all:h.all}),a.preventDefault()):k.pressToEdit&&32<=t&&127>=t&&!m&&null!=d&&(d=b.getCell({rowIndxPage:c,colIndx:q}))&&0<d.length&&(p=c+e,e=b.isEditableRow({rowIndx:p}),d=b.isEditableCell({rowIndx:p,colIndx:q}),e&&d&&b.editCell({rowIndxPage:c,colIndx:q,select:!0}))}};f.incrPageSize=function(){for(var a=this.that,b=a.$tbl,d=b.children("tbody").children("tr.pq-grid-row").not(".pq-group-row,.pq-summary-row"),
l=a.$cont[0].offsetHeight,b=parseInt(b.css("marginTop")),e=a._getScollBarHorizontalHeight(),l=l-e-b,b=d.length-1;0<=b;b--){var c=d[b];if(c.offsetTop<l)break}return{rowIndxPage:a.getRowIndx({$tr:g(c)}).rowIndxPage}};f.pageNonVirtual=function(a,b){var d=this.that,l=d.$cont[0].offsetHeight-d._getScollBarHorizontalHeight(),e=d.getRow({rowIndxPage:a}),c=0,f=0,h=g(e[0])[b]("tr.pq-grid-row"),k=h.length;if(0<k){do{e=h[f];c+=e.offsetHeight;if(c>=l)break;f++}while(f<k);f=0<f?f-1:f;do if(e=g(h[f]),a=d.getRowIndx({$tr:e}).rowIndxPage,
null!=a)break;else f--;while(0<=f)}return a};f.pageDown=function(a){var b=this.that,d=b.options,l=b.$vscroll.pqScrollBar("option"),e=l.cur_pos,c=l.num_eles,l=l.ratio;if(d.virtualY){if(e<c-1){a=this.incrPageSize().rowIndxPage;var f=b._calcCurPosFromRowIndxPage(a);if(null==f)return;b.$vscroll.pqScrollBar("option","cur_pos",f).pqScrollBar("scroll")}}else null!=a?a=this.pageNonVirtual(a,"nextAll"):1>l&&(d=b.$cont.data("offsetHeight")-b._getScollBarHorizontalHeight(),b.iMouseSelection.updateTableY(-1*
d),b._syncScrollBarVert());return{rowIndxPage:a,curPos:f}};f.pageUp=function(a){var b=this.that,d=b.options,l=b.$vscroll.pqScrollBar("option"),e=l.cur_pos,l=l.ratio;if(d.virtualY){if(0<e){a=this.decrPageSize().rowIndxPage;var c=b._calcCurPosFromRowIndxPage(a);if(null==c)return;b.$vscroll.pqScrollBar("option","cur_pos",c).pqScrollBar("scroll")}}else null!=a?a=this.pageNonVirtual(a,"prevAll"):0<l&&(d=b.$cont[0].offsetHeight-b._getScollBarHorizontalHeight(),b.iMouseSelection.updateTableY(d),b._syncScrollBarVert());
return{rowIndxPage:a,curPos:c}};f.decrPageSize=function(){var a=this.that,b=a.$tbl.children("tbody").children("tr.pq-grid-row").not(".pq-group-row,.pq-summary-row"),d=a.options.freezeRows,l=0;if(b.length){var e;d?(e=b.filter("tr.pq-last-freeze-row"),e.length&&(e=e.next())):2<=b.length&&(e=g(b[1]));e&&e.length&&(l=a.getRowIndx({$tr:e}).rowIndxPage,l=l-a.pageSize+4,0>l&&(l=0))}return{rowIndxPage:l}};c._calcNumHiddenFrozens=function(){for(var a=0,b=this.options.freezeCols,d=0;d<b;d++)this.colModel[d].hidden&&
a++;return a};c._calcNumHiddenUnFrozens=function(a){var b=0;a=null!=a?a:this.colModel.length;for(var d=this.options.freezeCols;d<a;d++)this.colModel[d].hidden&&b++;return b};c._setScrollHLength=function(){if(this.options.scrollModel.horizontal){this.$hscroll.css("visibility","");this.$hvscroll.css("visibility","");var a=this.$cont[0].offsetWidth,b=this._getSBWidth();0==b?this.$hscroll.css("right",0):this.$hscroll.css("right","");this.$hscroll.pqScrollBar("option","length",a-b)}else this.$hscroll.css("visibility",
"hidden"),this.$hvscroll.css("visibility","hidden")};c._setScrollHNumEles=function(){var a=this.options,b=a.scrollModel,d=0;"flex"!=a.width&&(d="fullScroll"==b.lastColumn?this.colModel.length-a.freezeCols-this._calcNumHiddenUnFrozens():this.calcColsOutsideCont(this.colModel)+1);this.$hscroll.pqScrollBar("option","num_eles",d)};c.calcColsOutsideCont=function(a){var b=this.options.numberCell,d=this.$tbl?this.$tbl[this.$tbl.length-1]:null,d=d?d.scrollWidth:0,l=this.options.freezeCols,e=this.$cont[0].offsetWidth-
this._getSBWidth(),d=0;b.show&&(d+=b.outerWidth);for(b=0;b<a.length;b++){var c=a[b];c.hidden||(d+=c.outerWidth)}var f=0,h=0;d>e&&h++;for(b=l;b<a.length;b++)if(c=a[b],!c.hidden)if(f+=c.outerWidth,l=d-f,l>e)h++;else break;return h};c._getScollBarHorizontalHeight=function(){var a=17,b=this.$hscroll;if("hidden"==b.css("visibility")||!1==this.options.scrollModel.horizontal||"none"==b.css("display"))a=0;return a};c._getSBWidth=function(){var a=17,b=this.$vscroll;if(null==this.initV||"hidden"==b.css("visibility")||
"flex"==this.options.height||"none"==b.css("display"))a=0;return a};c._setScrollVNumEles=function(a){var b=this.iHierarchy?!0:!1,d=this.$vscroll.pqScrollBar("option"),l=parseInt(d.num_eles),e=parseInt(d.cur_pos),d=this.options,l=this._getScollBarHorizontalHeight(),l=this.$cont[0].offsetHeight-l+1,d=(d.groupModel?this.dataGM:this.pdata)?this.totalVisibleRows:0,c,f=0;this.$tbl&&0<this.$tbl.length&&(c=this.$tbl[this.$tbl.length-1],f=c.offsetHeight,c=g(c));if(0<f&&f>l){c=c.children().children("tr");for(var h=
f=e=0;h<c.length;h++){var k=c[h],e=e+k.offsetHeight;if(e>=l){b&&g(k).hasClass("pq-detail-child")?(f--,f=1<f?f-1:1):f=1<f?f-1:0;break}else b?!1==g(k).hasClass("pq-detail-child")&&f++:f++}0==f&&(f=c.length-1);l=d-f+1}else l=e+1;l>d&&(l=d);a?this.$vscroll.pqScrollBar("option","num_eles",l):this.$vscroll.pqScrollBar("setNumEles",l);return l};c._getFirstVisibleRowIndxPage=function(a){for(var b=0,d=a.length;b<d;b++)if(!a[b].pq_hidden)return b};c._getLastVisibleRowIndxPage=function(a){for(var b=a.length-
1;0<=b;b--)if(!a[b].pq_hidden)return b;return null};c._getFirstVisibleColIndx=function(){for(var a=this.colModel,b=a.length,d=0;d<b;d++)if(!a[d].hidden)return d;return null};c._getLastVisibleColIndx=function(){for(var a=this.colModel,b=a.length-1;0<=b;b--)if(!a[b].hidden)return b;return null};c.getTotalVisibleColumns=function(){for(var a=this.colModel,b=a.length,d=0,l=0;l<b;l++)a[l].hidden||d++;return d};c._getTotalVisibleRows=function(a,b,d,l){var e=0,c=l?l.length:0,f=b,h=0,g=0,k=null,m=!1,p=!1,
q=this.iHierarchy?!0:!1,n=this.options.detailModel.offset,w=0,y=q?this.$cont[0].offsetHeight:void 0;if(null==l||0==c)return{initV:k,finalV:k,tvRows:e,lastFrozenRow:k};for(var z=0,x=c>b?b:c;z<x;z++){var A=l[z],B=A.pq_hidden;B||(k=z,e++,q&&((A=A.pq_detail)&&A.show?(A=A.height||0,A>n&&(A=n),w+=A+22):w+=22))}if(c<b)return{initV:k,finalV:k,tvRows:e,lastFrozenRow:k};d-=e;z=b;for(x=c;z<x;z++)A=l[z],B=A.pq_hidden,m?p||(B?h++:g==d?p=!0:(h++,g++)):B?f++:g==a?(m=!0,h=f,g=0):(f++,g++),B||(e++,q&&m&&((A=A.pq_detail)&&
A.show?(A=A.height||0,A>n&&(A=n),w+=A+22):w+=22,w>y&&(p=!0)));f>=c&&(f=c-1);h<f&&(h=f);return{initV:f,finalV:h,tvRows:e,lastFrozenRow:k}};c._setScrollVLength=function(){var a=this.$cont.height(),b=this._getScollBarHorizontalHeight();this.$vscroll.css("bottom",b);this.$vscroll.pqScrollBar("option","length",a-b)};c._setInnerGridHeight=function(){var a=this.options;"flex"!=a.height&&(a=this.element.height()-(a.showTop?this.$top[0].offsetHeight:0)-this.$bottom[0].offsetHeight,this.$grid_inner.height(a+
"px"))};c._setRightGridHeight=function(){var a=this.options,b=this.$header,d=0;b?(d=b[0].offsetHeight,this.$header_o.height(d-2)):this.$header_o.height(0);"flex"!=a.height&&(this.$vscroll.css("visibility",""),this.$tbl&&this.$tbl.css("marginBottom",0),a=this.element.height()-this.$header_o[0].offsetHeight-(a.showTop?this.$top[0].offsetHeight:0)-this.$bottom[0].offsetHeight,this.$cont.height(a-0+"px"))};c._setGridHeightFromTable=function(){var a=this._getScollBarHorizontalHeight(),b=this.$tbl;b&&b.length&&
b.css("marginBottom",a);this.$cont.height("");this.element.height("");this.$grid_inner.height("");this.$vscroll.css("visibility","hidden")};c._setGridWidthFromTable=function(){var a,b=this._getSBWidth();this.$tbl&&this.$tbl[0]&&0<this.$tbl[0].scrollWidth?(a=this.$tbl[0].scrollWidth,this.element.width(a+b+"px")):(a=m.call(this,-1,this.colModel.length),this.element.width(a+"px"))};c._bufferObj_minRowsPerGrid=function(){return Math.ceil(this.$cont[0].offsetHeight/this.rowHeight)};c._calcCurPosFromRowIndxPage=
function(a){var b=this.options,d=b.groupModel,l=d?this.dataGM:this.pdata,e=b.freezeRows;if(a<e)return 0;for(var b=0,c=e,f=l.length;e<f;e++){var h=l[e];if(!d||!h.groupSummary&&!h.groupTitle){if(c==a)break;c++}h.pq_hidden||b++}return b>=f?null:b};c._calcCurPosFromColIndx=function(a){var b=this.colModel,d=this.options.freezeCols;if(a<d)return 0;for(var l=0,e=d,c=b.length;d<c;d++){var f=b[d];if(e==a)break;e++;f.hidden||l++}return l>=c?null:l};c._bufferObj_calcInitFinal=function(){var a=this.options,b=
a.virtualY,d=a.freezeRows,l="flex"==a.height,a=a.groupModel?this.dataGM:this.pdata;if(null==a||0==a.length)d=this._getTotalVisibleRows(e,d,c,a),this.totalVisibleRows=d.tvRows,this.initV=d.initV,this.finalV=d.finalV,this.lastFrozenRow=d.lastFrozenRow;else if(b){var b=this.$vscroll.pqScrollBar("option"),e=parseInt(b.cur_pos);if(isNaN(e)||0>e)throw"cur_pos NA";this.scrollCurPos=e;var c=this._bufferObj_minRowsPerGrid();this.pageSize=c;d=this._getTotalVisibleRows(e,d,c,a);this.totalVisibleRows=d.tvRows;
this.initV=d.initV;this.lastFrozenRow=d.lastFrozenRow;this.finalV=l?a.length-1:d.finalV}else d=this._getTotalVisibleRows(0,d,c,a),this.lastFrozenRow=d.lastFrozenRow,this.totalVisibleRows=d.tvRows,this.initV=0,this.finalV=a.length-1};c._bufferObj_calcInitFinalH=function(){var a=this.options,b=a.virtualX,d=this.colModel,l=d.length;if(b){!1===a.virtualXHeader&&(this.initHH=0,this.finalHH=l-1);for(var e=parseInt(this.$hscroll.pqScrollBar("option","cur_pos")),c=parseInt(a.freezeCols),f="flex"==a.width,
h=c,g=0,k=c;k<l;k++)if(d[k].hidden)h++;else if(g==e)break;else h++,g++;h>l-1&&(h=l-1);this.initH=h;if(f||!b)this.finalH=l-1;else{b=m.call(this,-1,c);e=this.$cont[0].offsetWidth-this._getSBWidth();for(k=h;k<l;k++)if(h=d[k],!h.hidden){h=h.outerWidth;if(!h&&a.debug)throw"outerwidth N/A";b+=h;if(b>e)break}a=k;a>l-1&&(a=l-1);this.finalH=a}}else this.initH=0,this.finalH=l-1};var m=function(a,b,d){var l=0,e=this.options,c=e.columnBorders?1:0,f=e.numberCell,e=this.colModel;-1==a&&(f.show&&(l=d?l+(parseInt(f.width)+
1):l+f.outerWidth),a=0);if(d)for(;a<b;a++){if(d=e[a],!d.hidden){if(!d._width)throw"assert failed";l+=d._width+c}}else for(;a<b;a++)d=e[a],d.hidden||(l+=d.outerWidth);return l};g.paramquery.pqgrid.calcWidthCols=m;c.calcHeightFrozenRows=function(){var a=this.$tbl,b=0;a&&a.length&&((a=g(a[0]).find("tr.pq-last-freeze-row"))&&a.length?(a=a[0],b=a.offsetTop+a.offsetHeight):b=0);return b};c._calcRightEdgeCol=function(a){var b=0,d=0,e=this.colModel,c=this.hidearrHS,f=this.options.numberCell;f.show&&(b+=f.outerWidth,
d++);for(f=0;f<=a;f++){var h=e[f];h.hidden||!1!=c[f]||(b+=h.outerWidth,d++)}return{width:b,cols:d}};c._refreshFreezeLine=function(){var a=this.options,b=a.numberCell,d=this.$cont_o,a=a.freezeCols;this.$freezeLine&&this.$freezeLine.remove();a&&(a=m.call(this,-1,a)-1,isNaN(a)||0==a||0<a&&b.show&&a==b.width||(this.$freezeLine=g("<div class='pq-grid-vert-freezeline' ></div>").appendTo(d),this.$freezeLine.css({height:d[0].offsetHeight,left:a})))};c._getDragHelper=function(a){var b=parseInt(this.options.freezeCols);
a=g(a.currentTarget);this.$cl=g("<div class='pq-grid-drag-bar'></div>").appendTo(this.$grid_inner);this.$clleft=g("<div class='pq-grid-drag-bar'></div>").appendTo(this.$grid_inner);a=parseInt(a.attr("pq-grid-col-indx"));var d=this.$grid_inner.outerHeight();this.$cl.height(d);this.$clleft.height(d);var d=g("td[pq-grid-col-indx="+a+"]",this.$header)[0],e=d.offsetLeft;this.pqpanes.vH?a>=b&&(e+=this.$header[1].offsetLeft):e+=this.$header[0].offsetLeft;this.$clleft.css({left:e});e+=d.offsetWidth;this.$cl.css({left:e})};
c._setDragLimits=function(a){if(!(0>a)){var b=this.colModel[a],d=this.$header_left;a>=this.options.freezeCols&&this.pqpanes.vH&&(d=this.$header_right);var e=d.find("td[pq-grid-col-indx='"+a+"']").offset().left+b._minWidth,b=e+b._maxWidth-b._minWidth;d.find("div.pq-grid-col-resize-handle[pq-grid-col-indx="+a+"]").draggable("option","containment",[e,0,b,0])}};c.nestedCols=function(a,b,d){var e=a.length,c=[];null==b&&(b=1);for(var f=b,h=0,g=0,k=0;k<e;k++){var m=a[k];if(!0===d||!1===d)m.hidden=d;if(null!=
m.colModel&&0<m.colModel.length){var p=this.nestedCols(m.colModel,b+1,m.hidden),c=c.concat(p.colModel);0<p.colSpan?(p.depth>f&&(f=p.depth),m.colSpan=p.colSpan,h+=p.colSpan):(m.colSpan=0,m.hidden=!0);m.childCount=p.childCount;g+=p.childCount}else m.hidden?m.colSpan=0:(m.colSpan=1,h++),m.childCount=0,g++,c.push(m)}return{depth:f,colModel:c,colSpan:h,width:0,childCount:g}};c.getHeadersCells=function(){for(var a=this.options.colModel,b=this.colModel.length,d=this.depth,e=[],c=0;c<d;c++){e[c]=[];for(var f=
0,h=0,g=0;g<b;g++){var k;if(0==c)k=a[f];else{var m=e[c-1][g];k=m.colModel;if(null==k||0==k.length)k=m;else{for(var m=g-m.leftPos,p=0,q=0,n=0;n<k.length;n++)if(p+=0<k[n].childCount?k[n].childCount:1,m<p){q=n;break}k=k[q]}}m=k.childCount?k.childCount:1;g==h?(k.leftPos=g,e[c][g]=k,h+=m,a[f+1]&&f++):e[c][g]=e[c][g-1]}}return this.headerCells=e};c.getDataType=function(){var a=this.colModel;if(a&&a[0])return"string"==typeof a[0].dataIndx?"JSON":"ARRAY";throw"dataType unknown";};c.assignRowSpan=function(){for(var a=
this.colModel.length,b=this.headerCells,d=this.depth,e=0;e<a;e++)for(var c=0;c<d;c++){var f=b[c][e];if(!(0<e&&f==b[c][e-1]||0<c&&f==b[c-1][e])){for(var h=1,g=c+1;g<d;g++)f==b[g][e]&&h++;f.rowSpan=h}}return b};c._calcThisColModel=function(){var a=this.options,b=a.columnTemplate,a=this.nestedCols(a.colModel);this.colModel=a.colModel;this.depth=a.depth;var a=this.colModel,d=a.length;if(b)for(var e=0;e<d;e++){var c=a[e],f=g.extend({},b,c,!0);g.extend(c,f,!0)}this.getHeadersCells();this.assignRowSpan();
this._refreshDataIndices()};var q=function(a){this.that=a},f=q.prototype;f._computeOuterWidths=function(){for(var a=this.that,b=a.options,d=b.columnBorders?1:0,b=b.numberCell,a=a.colModel,e=a.length,c=0;c<e;c++){var f=a[c];f.outerWidth=f._width+d}b.show&&(b.outerWidth=b.width+1)};f.autoFit=function(){var a=this.that,b=a.colModel,d=a.$cont,e=b.length,c=m.call(a,-1,e,!0),a=d[0].offsetWidth-a._getSBWidth();if(c!=a){for(var c=c-a,f,a=[],d=0;d<e;d++){var h=b[d],g=h._percent,k=h._resized;h.hidden||g||k||
(0>c?(g=h._maxWidth-h._width)&&a.push({availWd:-1*g,colIndx:d}):(g=h._width-h._minWidth)&&a.push({availWd:g,colIndx:d}));k&&(f=h,delete h._resized)}a.sort(function(a,b){return a.availWd>b.availWd?1:a.availWd<b.availWd?-1:0});d=0;for(e=a.length;d<e;d++){var h=a[d],g=h.availWd,h=h.colIndx,k=Math.round(c/(e-d)),h=b[h],p;p=h._width;Math.abs(g)>Math.abs(k)?(p-=k,c-=k):(p-=g,c-=g);h.width=h._width=p}0!=c&&f&&(p=f._width-c,p>f._maxWidth?p=f._maxWidth:p<f._minWidth&&(p=f._minWidth),f.width=f._width=p)}};
f.autoLastColumn=function(){var a=this.that,b=a.options,d=b.columnBorders?1:0,e=a.colModel,c=e.length,b=b.freezeCols,f=a.$cont[0].offsetWidth-a._getSBWidth(),h=m.call(a,-1,b,!0),f=f-h,h=!1,a=a._getLastVisibleColIndx();if(null!=a&&(a=e[a],!a._percent)){for(var g=a._width,k,p=a._minWidth,q=a._maxWidth,c=c-1;c>=b;c--){var n=e[c];if(!n.hidden&&(n=n._width+d,f-=n,0>f)){h=!0;k=g+f>=p?g+f:g+n+f;break}}h||(k=g+f);k>q?k=q:k<p&&(k=p);a.width=a._width=k}};f.numericVal=function(a,b){return-1<(a+"").indexOf("%")?
parseInt(a)*b/100:parseInt(a)};f.refreshColumnWidths=function(){var a=this.that,b=a.options,d=b.numberCell,e="flex"==b.width,c=b.columnBorders?1:0,f=a.colModel,h=b.scrollModel,g=h.lastColumn,h=h.autoFit,k=a.$cont,p=f.length,m=a._getSBWidth(),q=b._minColWidth,n=b._maxColWidth;if(k&&k[0].offsetWidth){var t=k[0].offsetWidth,w=0;d.show&&(d.width<d.minWidth&&(d.width=d.minWidth),d.outerWidth=d.width+1,w=d.outerWidth);d=t-m-w;q=Math.floor(this.numericVal(q,d));n=Math.ceil(this.numericVal(n,d));m=0;if(5>
d||isNaN(d)){if(b.debug)throw"availWidth N/A";}else{delete a.percentColumn;for(b=0;b<p;b++)if(t=f[b],!t.hidden){var y=t.width,w=-1<(y+"").indexOf("%")?!0:null,z=t.minWidth,x=t.maxWidth,z=z?this.numericVal(z,d):q,x=x?this.numericVal(x,d):n;x<z&&(x=z);if(void 0!=y){var A=0;!e&&w?(a.percentColumn=!0,t.resizable=!1,t._percent=!0,y=this.numericVal(y,d)-c,A=Math.floor(y),m+=y-A,1<=m&&(A+=1,m-=1)):y&&(A=parseInt(y));A<z?A=z:A>x&&(A=x);t._width=A}else t._width=z;w||(t.width=t._width);t._minWidth=z;t._maxWidth=
x}k&&!1==e&&(h&&this.autoFit(),"auto"==g&&this.autoLastColumn());this._computeOuterWidths()}}};c._createHeader=function(){var a=this,b=this.options,d=b.hwrap,e=parseInt(b.freezeCols),c=b.numberCell,f=this.colModel,h=this.depth,k=b.virtualX,p=b.virtualXHeader,q=!1===p?a.initHH:a.initH,p=!1===p?a.finalHH:a.finalH,n=this.headerCells,H=this.$header,u=this.$header_o;if(null==p)throw"finalH required for _createHeader";if(!1===b.showHeader)H&&H.empty(),u.css("display","none");else{u.css("display","");H=
"pq-grid-header-table ";H=["<table class='"+(d?H+"pq-wrap ":H+"pq-no-wrap ")+"' cellpadding=0 cellspacing=0 >"];if(1<=h){H.push("<tr>");c.show&&H.push("<td style='width:"+(c.width+1)+"px;' ></td>");for(b=0;b<=p;b++){if(b<q&&b>=e&&k&&(b=q,b>p))throw"initH>finalH";d=f[b];d.hidden||(d=d.outerWidth,H.push("<td style='width:"+d+"px;' pq-col-indx="+b+"></td>"))}H.push("</tr>")}for(d=0;d<h;d++){H.push("<tr class='pq-grid-title-row'>");0==d&&c.show&&H.push(["<td pq-grid-col-indx='-1' class='pq-grid-number-col' rowspan='",
h,"'><div class='pq-td-div'>",c.title?c.title:"&nbsp;","</div></td>"].join(""));for(b=0;b<=p;b++){if(b<q&&b>=e&&k&&(b=q,b>p))throw"initH>finalH";this._createHeaderCell(d,b,n,H,"pq-grid-col ",e,q,h)}H.push("</tr>")}this.ovCreateHeader(H,"pq-grid-col ");H.push("</table>");c=H.join("");u.empty();this.pqpanes.vH?u.append(["<span class='pq-grid-header pq-grid-header-left ui-state-default'>",c,"</span><span class='pq-grid-header ui-state-default'>",c,"</span>"].join("")):u.append(["<span class='pq-grid-header ui-state-default'>",
c,"</span>"].join(""));H=this.$header=g(".pq-grid-header",u);this.$tbl_header=H.children("table");d=m.call(this,-1,e);h=this.$header_left=g(H[0]);this.pqpanes.vH&&(h=this.$header_left=g(H[0]),c=this.$header_right=g(H[1]),h.css({width:d,zIndex:10}),e=m.call(this,e,q),c.css({left:-1*e+"px"}));H.click(function(b){return a._onHeaderClick(b)});this._refreshResizeColumn(q,p,f);this._trigger("refreshHeader",null,null)}};c._onHeaderClick=function(a){if(!this.iDragColumns||"stop"==this.iDragColumns.status){var b=
g(a.target),d=b.closest(".pq-g-ficon");if(d.length)return b=d.attr("pq-col-indx"),a.stopImmediatePropagation(),this.iHeaderIconSearch.createDOM(b,d,a);d=b.closest("td.pq-grid-col");if(d.length&&(a.stopImmediatePropagation(),b=d.attr("pq-grid-col-indx"),null!=b))return this._onHeaderCellClick(b,a)}};c._createHeaderCell=function(a,b,d,e,c,f,h,g){var k=d[a][b],p=k.colSpan,m=k.halign,q=k.align,n=k.title;if(!(0<a&&k==d[a-1][b]||0<b&&k==d[a][b-1]||k.hidden)){d=c;null!=m?d+=" pq-align-"+m:null!=q&&(d+=" pq-align-"+
q);b==f-1&&1==g&&(d+=" pq-last-freeze-col");b<=f-1?d+=" pq-left-col":b>=h&&(d+=" pq-right-col");(f=k.cls)&&(d=d+" "+f);f="";if(null==k.colModel||0==k.colModel.length)f="pq-grid-col-indx='"+b+"'";e.push(["<td ",f," ","pq-col-indx="+b," ","pq-row-indx="+a,"  class='",d,"' rowspan=",k.rowSpan," colspan=",p,"><div class='pq-td-div'>",n?n:"","<span class='pq-col-sort-icon'>&nbsp;</span></div></td>"].join(""))}};c._refreshHeader=function(){for(var a=this.colModel,b=this.initH,d=this.finalH,e=g("table.pq-grid-header-table tr:first");b<=
d;b++)e.find("td[pq-col-indx="+b+"]").width(a[b].outerWidth)};c.ovCreateHeader=function(){};c._refreshResizeColumn=function(a,b,d){var e=this,c=this.options,f=c.filterModel.ficon?!0:!1,h=c.numberCell,k=e.$header.height(),c=parseInt(c.freezeCols),p=[],m=[];if(h.show&&h.resizable){var q=e.$header_left.find("td.pq-grid-number-col")[0],q=parseInt(q.offsetLeft)+(q.offsetWidth-10);p.push("<div pq-grid-col-indx='-1' style='left:",q,"px;height:",k,"px;' class='pq-grid-col-resize-handle'>&nbsp;</div>")}for(h=
0;h<=b;h++){if(h<a&&h>=c&&(h=a,h>b))throw"initH>finalH";var n=d[h];if(!n.hidden){var u=n.ficon,t=u||null==u&&f,u=p;if(!1!==n.resizable||t)q=e.$header_left,this.pqpanes.vH&&h>=c&&(q=e.$header_right,u=m),q=q.find("td[pq-grid-col-indx="+h+"]")[0],t=parseInt(q.offsetLeft),q=t+(q.offsetWidth-5);!1!==n.resizable&&u.push("<div pq-grid-col-indx='",h,"' style='left:",q,"px;height:",k,"px;' class='pq-grid-col-resize-handle'>&nbsp;</div>")}}e.$header_left.append(p.join(""));m.length&&e.$header_right.append(m.join(""));
var w,y,z;e.$header.find(".pq-grid-col-resize-handle").draggable({axis:"x",helper:function(a,b){var d=g(a.target),c=parseInt(d.attr("pq-grid-col-indx"));e._setDragLimits(c);e._getDragHelper(a,b);return d},start:function(a,b){w=b.position.left;z=parseInt(e.$cl[0].style.left)},drag:function(a,b){y=b.position.left;e.$cl[0].style.left=z+(y-w)+"px"},stop:function(a,b){return e._refreshResizeColumnStop(a,b,d,w)}})};c._refreshResizeColumnStop=function(a,b,d,e){var c=this.options.numberCell;this.$clleft.remove();
this.$cl.remove();e=b.position.left-e;b=g(b.helper);b=parseInt(b.attr("pq-grid-col-indx"));if(-1==b){d=null;var f=parseInt(c.width);c.width=f+e}else d=d[b],f=parseInt(d.width),d.width=f+e,d._resized=!0;this.refresh();this._trigger("columnResize",a,{colIndx:b,column:d,dataIndx:d?d.dataIndx:null,oldWidth:f,newWidth:d?d.width:c.width})};c._refreshHeaderSortIcons=function(){var a=this.options.dataModel;if(void 0!=a.sortIndx){var b=this.$header;b.find(".pq-grid-col").removeClass("pq-col-sort-asc pq-col-sort-desc ui-state-active");
b.find(".pq-col-sort-icon").removeClass("ui-icon ui-icon-triangle-1-n ui-icon-triangle-1-s");var d=this.getColIndx({dataIndx:a.sortIndx}),e="ui-state-active pq-col-sort-"+("up"==a.sortDir?"asc":"desc"),a="ui-icon ui-icon-triangle-1-"+("up"==a.sortDir?"n":"s");b.find(".pq-grid-col[pq-grid-col-indx="+d+"]").addClass(e);b.find(".pq-grid-col[pq-grid-col-indx="+d+"] .pq-col-sort-icon").addClass(a)}};c.createTable=function(a){this.iGenerateView.generateView(a)};g.widget("paramquery._pqGrid",g.ui.mouse,
c)})(jQuery);
(function(g){function c(a){var b=this;this.that=a;this.type="detail";this.refreshComplete=!0;this.detachView=!1;var d=a.widgetEventPrefix.toLowerCase(),e=a.eventNamespace;a.element.on(d+"cellclick"+e,function(a,d){if(b.belongs(a))return b.cellClick(a,d)});a.element.on(d+"cellkeydown"+e,function(a,d){if(b.belongs(a)&&a.keyCode==g.ui.keyCode.ENTER)return b.cellClick(a,d)});a.element.on(d+"aftertable"+e,function(a,d){if(b.belongs(a))return b.aftertable(a,d)});a.element.on(d+"beforetableview"+e,function(a,
d){if(b.belongs(a))return b.beforeTableView(a,d)});a.element.on(d+"beforerefreshdata"+e,function(a,d){if(b.belongs(a))return b.beforeRefreshData(a,d)})}var n=g.paramquery.cClass,h={getFocusElement:function(){var a=document.activeElement;if(a){var a=g(a),b=a.closest(".pq-grid");if(b.length)return b[0]==this.element[0]?{$ae:a,$grid:b}:{$ae:a,$childGrid:b}}},inViewPort:function(a){var b=this.$cont[0],d=b.offsetHeight-this._getScollBarHorizontalHeight(),b=b.offsetWidth-this._getSBWidth()+1;a=a[0];var e=
g(a.offsetParent),c=parseInt(e.css("marginTop")),e=parseInt(e.css("marginLeft"));if(d>=a.offsetTop+a.offsetHeight+c)if("TD"==a.nodeName.toUpperCase()){if(b>=a.offsetLeft+a.offsetWidth+e)return!0}else return!0}},k=c.prototype=new n;k.aftertable=function(a,b){var d=this.that,e=d.options.detailModel.init,c=d.pdata;if(this.refreshComplete){this.refreshComplete=!1;for(var f=d.$tbl.children("tbody").children("tr.pq-detail-child"),h=0;h<f.length;h++){var k=g(f[h]),p=k.attr("pq-row-indx"),m=c[p],p=m.pq_detail.child;
p||"function"!=typeof e||(p=e.call(d.element[0],{rowData:m}),m.pq_detail.child=p);m=p.find(".pq-header-outer");k.children("td.pq-detail-child").append(p);if(0==m.height())try{p.pqGrid("refresh")}catch(q){}}this.refreshComplete=!0;this.detachView=!1}};k.beforeTableView=function(a,b){this.detachView||this.detachInitView(a,b)};k.beforeRefreshData=function(a,b){this.detachView||this.detachInitView(a,b)};k.detachInitView=function(a,b){var d=this.that,e=d.pdata;if(e&&e.length){for(var d=d.$tbl.children("tbody").children("tr.pq-grid-row"),
c,f,h,k=0;k<d.length;k++){var p=g(d[k]);f=p.attr("pq-row-indx");var m=e[f];null!=f&&f!=c&&(c=f,m.pq_detail&&(f=null,h=0,m.pq_detail.child&&(p=p.next(),p.hasClass("pq-detail-child")&&(p=p.children("td.pq-detail-child").children(),p.length&&(h=p[0].offsetHeight,f=p.detach()))),f&&f.length&&(m.pq_detail.child=f,m.pq_detail.height=h)))}this.detachView=!0}};k.cellClick=function(a,b){var d=this.that,e=b.column,c=b.rowData,f=b.rowIndx,h=this.type;e&&e.type===h&&(null==c.pq_detail?d.rowExpand({rowIndx:f,
scrollRow:!0}):!1===c.pq_detail.show?d.rowExpand({rowIndx:f,scrollRow:!0}):d.rowCollapse({rowIndx:f,scrollRow:!0}))};h.rowExpand=function(a){var b=this.getRowData(a),d=this.options.detailModel;null!=b&&(null==b.pq_detail?b.pq_detail={show:!0}:!1===b.pq_detail.show&&(b.pq_detail.show=!0),!d.cache&&(d=b.pq_detail.child)&&(d.remove(),b.pq_detail.child=null,b.pq_detail.height=0),this.refresh(),a.scrollRow&&this.scrollRow({rowIndx:a.rowIndx}))};h.rowInvalidate=function(a){a=this.getRowData(a);a.pq_detail.child.remove();
a.pq_detail.child=null};h.rowCollapse=function(a){var b=this.getRowData(a),d=this.options.detailModel;null!=b&&null!=b.pq_detail&&!0===b.pq_detail.show&&(!d.cache&&(d=b.pq_detail.child)&&(d.remove(),b.pq_detail.child=null,b.pq_detail.height=0),b.pq_detail.show=!1,this.refresh(),a.scrollRow&&this.scrollRow({rowIndx:a.rowIndx}))};var e=function(a){function b(b,d,e){a.filter({data:[{dataIndx:b,value:d,value2:e}]})}this.that=a;var d=this;this.dataHS={};var e=a.widgetEventPrefix.toLowerCase(),c=a.eventNamespace;
a.element.on(e+"headerkeydown"+c,function(a,b){if(d.belongs(a)){var e=g(a.originalEvent.target);return e.hasClass("pq-search-hd-field")?d.onKeyDown(a,b,e):!0}});a.element.on(e+"createheader"+c,function(a,b){if(d.belongs(a))return d._onCreateHeader()});this.changeListener={change:function(a,d){b(d.dataIndx,d.value,d.value2)}};this.keyupListener={keyup:function(a,d){b(d.dataIndx,d.value,d.value2)}};this.clickListener={click:function(a,d){b(d.dataIndx,d.value)}}},n=e.prototype=new n;n.get$Ele=function(a,
b){var d=this.that,e=d.options.freezeCols,c=g(d.$tbl_header[0]),f=".pq-search-hd-field[name='"+b+"']",d=g(d.$tbl_header[2==d.$tbl_header.length?1:0]);return a>=e?d.find(f):c.find(f)};n.onKeyDown=function(a,b,d){b=this.that;if(a.keyCode===g.ui.keyCode.TAB){var e=d.attr("name"),c=b.getColIndx({dataIndx:e}),f=b.colModel,h,k=a.shiftKey,p=f[c];if("between"==p.filter.condition&&(b.scrollColumn({colIndx:c}),e=this.get$Ele(c,e),e[0]==d[0]?k||(h=e[1]):k&&(h=e[0]),h))return h.focus(),a.preventDefault(),!1;
do{k?c--:c++;if(0>c||c>=f.length)break;p=f[c];d=p.filter;if(!p.hidden&&d){b.scrollColumn({colIndx:c});e=p.dataIndx;h=this.get$Ele(c,e);"between"==d.condition&&(h=k?g(h[1]):g(h[0]));if(h)return h.focus(),a.preventDefault(),!1;break}}while(1)}else return!0};n._bindFocus=function(){function a(a){b._fixTableViewPort();a=g(a.target).attr("name");if(b.scrollColumn({dataIndx:a})){var e=b.getColIndx({dataIndx:a});d.get$Ele(e,a).focus()}}for(var b=this.that,d=this,e=b.$header.find(".pq-grid-header-search"),
c=0;c<e.length;c++)g(e[c]).on("focusin",a)};n._onCreateHeader=function(){var a=this.that,b=a.options,d=b.columnBorders;if(b.filterModel.header){this._bindFocus();var e=a.colModel,c=a.initH,f=a.finalH,h=b.freezeCols,b=b.virtualX,k=a.$tbl_header,p=g(k[0]),m=g(k[1]),q="input,select";if(1<k.length){p.find(q).css("visibility","hidden");for(var n=0;n<h;n++){var u=e[n],q="*[name='"+u.dataIndx+"']";p.find(q).css("visibility","visible");m.find(q).css("visibility","hidden")}}for(n=0;n<=f;n++){if(n<c&&n>=h&&
b&&(n=c,n>f))throw"initH>finalH";u=e[n];if(!u.hidden){var t=u.filter;if(t){var q=u.dataIndx,w=p;n>=h&&1<k.length&&(w=m);w=w.find("*[name='"+q+"']");if(0!=w.length){var y=t.type,z=t.value,x=t.value2;"checkbox"==y&&"triple"==t.subtype?w.pqval({val:z}):"select"==y&&(w.val(z),y=this.getWidth(u,d),w.css({width:y}));(y=t.init)&&y.call(w,{dataIndx:q,column:u});if(u=t.listeners)for(t=0;t<u.length;t++){y=u[t];"string"==typeof y&&(y=this[y+"Listener"]);for(var A in y)(function(b,d,e){b.bind(A,function(c){var l=
a.getColumn({dataIndx:e}),f=l.filter;"checkbox"==f.type?z="triple"==f.subtype?b.pqval({incr:!0}):b.is(":checked")?!0:!1:"between"==f.condition?(z=g(b[0]).val(),x=g(b[1]).val()):z=b.val();return d.call(this,c,{column:l,dataIndx:e,value:z,value2:x})})})(w,y[A],q)}}}}}}};n.getWidth=function(a,b){var d=parseInt(a.width)+(b?1:0);return d-15};n.createDOM=function(a,b){var d=this.that,e=d.initH,c=d.finalH,f=d.options,h=f.freezeCols,k=f.virtualX,p=d.colModel,m=d.element.zIndex()+5,q=f.columnBorders,f=f.numberCell;
a.push("<tr class='pq-grid-header-search'>");f.show&&a.push("<td pq-grid-col-indx='-1' class='pq-grid-number-col' rowspan='1'><div class='pq-grid-header-table-div'>&nbsp;</div></td>");for(f=0;f<=c;f++){if(f<e&&f>=h&&k&&(f=e,f>c))throw"initH>finalH";var n=p[f];if(!n.hidden){var u=b,t=n.halign;t||(t=n.align);"right"==t?u+=" pq-align-right":"center"==t&&(u+=" pq-align-center");(t=n.cls)&&(u=u+" "+t);if(t=n.filter){var w=n.dataIndx,y=t.type,z=t.value,x=t.condition,A=this.getWidth(n,q),B=t.cls,B="pq-search-hd-field "+
(B?B:""),C=t.style,C=C?C:"",C=C+"z-index:"+m+";",F=t.attr,F=F?F:"",E="",G;if("between"==x){var I=t.value2,I=null!=I?I:"";G=A/2-9}"textbox"===y?(z=z?z:"",B+=" ui-corner-all pq-search-txt","between"==x?(E=this._input(w,z,G,B+" pq-from",C,F),E+="-"+this._input(w,I,G,B+" pq-to",C,F)):E=this._input(w,z,A,B,C,F)):"textarea"===y?(z=z?z:"",B+=" ui-corner-all pq-search-txt","between"==x?(E=this._textarea(w,z,G,B,C,F),E+="-"+this._textarea(w,I,G,B,C,F)):E=this._textarea(w,z,A,B,C,F)):"select"===y?t.cache?(E=
t.cache,E=E.replace(/z-index:\d;/,"z-index:"+m+";")):(y=t.options,"function"===typeof y&&(y=y.call(d.element[0],{column:n,value:z,dataIndx:w,cls:B,style:C,attr:F})),B+=" ui-corner-all",n=["name='",w,"' class='",B,"' style='width:",A,"px;",C,"' ",F].join(""),E=g.paramquery.select({options:y,attr:n,prepend:t.prepend,valueIndx:t.valueIndx,labelIndx:t.labelIndx,groupIndx:t.groupIndx}),t.cache=E):"checkbox"==y?E=["<input ",null==z||!1==z?"":"checked=checked"," name='",w,"' type=checkbox class='"+B+"' style='"+
C+"' "+F+"/>"].join(""):"string"==typeof y?E=y:"function"==typeof y&&(E=y.call(d.element[0],{width:A,value:z,value2:I,column:n,dataIndx:w,cls:B,attr:F,style:C}));a.push(["<td class='",u,"'><div class='pq-grid-header-table-div' style='padding:0px 2px;' >",E,"</div></td>"].join(""))}else a.push(["<td class='",u,"'><div class='pq-grid-header-table-div' >&nbsp;</div></td>"].join(""))}}a.push("</tr>")};n._input=function(a,b,d,e,c,f){return['<input value="',b,"\" name='",a,"' type=text style='width:",d,
"px;"+c+"' class='"+e+"' "+f+" />"].join("")};n._textarea=function(a,b,d,e,c,f){return["<textarea name='",a,"' style='width:",d,"px;"+c+"' class='"+e+"' "+f+" >",b,"</textarea>"].join("")};g.paramquery.select=function(a){var b=a.options,d=a.groupIndx,e=a.labelIndx,c=a.valueIndx,f=a.prepend,h,k;a=["<select ",a.attr," >"];if(f)for(h in f)a.push('<option value="',h,'">',f[h],"</option>");if(d){if(b&&b.length){for(var f=0,g=b.length;f<g;f++){var p=b[f],m=p[c];null!=m&&(h=p[d],k!=h&&(null!=k&&a.push("</optgroup>"),
a.push('<optgroup label="',h,'">'),k=h),c!=e?(p=p[e],a.push('<option value="',m,'">',p,"</option>")):a.push("<option>",m,"</option>"))}a.push("</optgroup>")}}else if(b&&b.length)for(f=0,g=b.length;f<g;f++)if(p=b[f],null!=e&&null!=c)m=p[c],null!=m&&(e==c?a.push("<option>",m,"</option>"):(p=p[e],a.push('<option value="',m,'">',p,"</option>")));else if("object"==typeof p)for(h in p)a.push('<option value="',h,'">',p[h],"</option>");else a.push("<option>",p,"</option>");a.push("</select>");return a.join("")};
g.fn.pqval=function(a){if(a){if(a.incr)return a=this.data("pq_value"),this.prop("indeterminate",!1),a?(a=!1,this.removeAttr("checked")):!1===a?(a=null,this.prop("indeterminate",!0),this.removeAttr("checked")):(a=!0,this.attr("checked","checked")),this.data("pq_value",a),a;a=a.val;this.data("pq_value",a);this.prop("indeterminate",!1);null==a?(this.prop("indeterminate",!0),this.removeAttr("checked")):a?this.attr("checked","checked"):this.removeAttr("checked");return this}return this.data("pq_value")};
var f={_generateTitleRow:function(a,b,d,e){var c=this.that.options.numberCell,f=b.groupTitle,h=a.title,k=b.level,g=b.GMRowIndx;a=(a=(a=a.icon)?a[k]:null)&&a.length&&2==a.length&&"function"===typeof a.push?a:["ui-icon-minus","ui-icon-plus"];if(h&&null!=h[k]){if(!1===h[k])return;f=h[k].replace("{0}",f);f=f.replace("{1}",b.items)}else f=f+" - "+b.items+" item(s)";d.push(["<tr class='pq-group-row pq-grid-row",e?" pq-last-freeze-row":"","' title=\"",b.groupTitle,"\" level='",k,"' GMRowIndx='",g,"'>"].join(""));
c.show&&d.push("<td class='pq-grid-number-cell ui-state-default'>&nbsp;</td>");e=a[0];b.collapsed&&(e=a[1]);d.push("<td class='pq-grid-cell' colSpan='100' >","<div class='pq-td-div' style='margin-left:",16*k,"px;'>","<span class='ui-icon ",e,"'></span>",f,"</div></td>");d.push("</tr>")},_generateSummaryRow:function(a,b,d,e){var c=this.that,f=c.options,h=f.virtualX,k=c.initH,c=c.finalH,g=f.freezeCols,p=f.numberCell,f=f.columnBorders;d.push("<tr class='pq-summary-row pq-grid-row"+(e?" pq-last-freeze-row":
"")+"'>");p.show&&d.push("<td class='pq-grid-number-cell ui-state-default'>&nbsp;</td>");for(e=0;e<=c;e++){if(e<k&&e>=g&&h&&(e=k,e>c))throw"initH>finalH";var p=b[e],m=p.dataIndx;if(!p.hidden){var q="pq-grid-cell ";"right"==p.align?q+=" pq-align-right":"center"==p.align&&(q+=" pq-align-center");e==g-1&&f&&(q+=" pq-last-freeze-col");p.cls&&(q=q+" "+p.cls);p=["<td class='",q,"' style='' >",null==a[m]?"&nbsp;":a[m],"</td>"].join("");d.push(p)}}d.push("</tr>");return d},_generateDetailRow:function(a,b,
d,e,c,f){d="pq-grid-row pq-detail-child";f&&(d+=" pq-last-freeze-row");var h=this.that.options;f=h.numberCell;var k="pq-grid-cell ";if(!h.wrap||c)k+="pq-wrap-text ";h.stripeRows&&b/2==parseInt(b/2)&&(d+=" pq-grid-oddRow");a.pq_rowselect&&(d+=" pq-row-select ui-state-highlight");a=a.pq_rowcls;null!=a&&(d+=" "+a);e.push("<tr pq-row-indx='"+b+"' class='"+d+"' >");f.show&&e.push("<td class='pq-grid-number-cell ui-state-default'>&nbsp;</td>");e.push("<td class='"+k+" pq-detail-child' colSpan='20'></td>");
e.push("</tr>");return e}},p=function(a){this.that=a},n=p.prototype;n._refreshDataFromDataModel=function(){this._groupData();this.initcollapsed()};n.bindEvents=function(){var a=this;this.that.$cont.on("click","tr.pq-group-row",function(b){return a.onClickGroupRow(b)})};n.showHideRows=function(a,b,d){for(var e=[],c=this.that.dataGM,f=c.length;a<f;a++){var h=c[a],k=h;if(k.groupSummary)if(h.level<b)break;else h.pq_hidden=d;else if(k.groupTitle)if(h.collapsed&&e.push({indx:a,level:h.level}),h.level<=
b)break;else h.pq_hidden=d;else h.pq_hidden=d}return e};n.onClickGroupRow=function(a){var b=g(a.currentTarget);a=this.that;var d=parseInt(b.attr("level")),b=parseInt(b.attr("GMRowIndx")),e=!0,e=a.dataGM[b];e=e.collapsed?e.collapsed=!1:e.collapsed=!0;if(e)this.showHideRows(b+1,d,!0);else for(b=this.showHideRows(b+1,d,!1),e=0;e<b.length;e++){var c=b[e].indx,d=b[e].level;this.showHideRows(c+1,d,!0)}a.refresh()};n.initcollapsed=function(){var a=this.that.dataGM;if(a)for(var b=0,d=a.length;b<d;b++){var e=
a[b];if(void 0!==e.groupTitle){var c=e.level;e.collapsed&&this.showHideRows(b+1,c,!0)}}};n.max=function(a,b){var d;"integer"==b||"float"==b?(d=Math.max.apply(Math,a),"float"===b&&(d=d.toFixed(2))):(a="date"==b?a.sort(function(a,b){a=Date.parse(a);b=Date.parse(b);return a-b}):a.sort(),d=a[a.length-1]);return d};n.min=function(a,b){var d;"integer"==b||"float"==b?(d=Math.min.apply(Math,a),"float"===b&&(d=d.toFixed(2))):(a="date"==b?a.sort(function(a,b){a=Date.parse(a);b=Date.parse(b);return a-b}):a.sort(),
d=a[0]);return d};n.count=function(a){return a.length};n.sum=function(a,b){var d=0,e;e="float"===b?parseFloat:"integer"===b?parseInt:function(a){return a};for(var c=0,f=a.length;c<f;c++)d+=e(a[c]);"float"===b&&(d=d.toFixed(2));return d};n._groupData=function(){for(var a=this.that,b=a.pdata,d=a.options,e=d.groupModel,c=d.pageModel,d=a.colModel,c=c.type?(c.curPage-1)*c.rPP:0,f=d.length,h=e.dataIndx,k=h.length,p=e.collapsed,m=[],q=0;q<k;q++){m[q]=!1;for(var n=0;n<f;n++){var u=d[n],t=u.summary;if(t){var w=
t.type;if(w&&"function"==typeof w.push&&w[q]){m[q]=!0;break}}}}if(e&&b&&0<b.length){for(var e=[],n=[],y=[],z=[],x=[],q=0;q<k;q++)z[q]="",y[q]="",x[q]={};for(var A=0,B=b.length;A<=B;A++){for(var C=b[A],u=!1,F=null,q=0;q<k;q++)y[q]=A<B?g.trim(C[h[q]]):"",z[q]!=y[q]&&(u=!0),u&&null==F&&(F=q);if(u){for(u=0;u<k;u++)z[u]=y[u];if(0<A){for(q=k-1;q>=F;q--)if(m[q]){for(var E=[],G=0;G<f;G++)if(u=d[G],w=(t=u.summary)?t.type?t.type[q]:null:null){var I=u.dataIndx,K="",t=t.title?t.title[q]:null,O="{0}";"function"==
typeof w?K=w(x[q][I],u.dataType):(O=w+": {0}",K=this[w](x[q][I],u.dataType));t&&(O=t);E[I]=O.replace("{0}",K)}e.push({groupSummary:!0,level:q,data:E})}for(u=F;u<k;u++)e[n[u]].items=x[u][d[0].dataIndx].length}if(A==B)break;for(q=k-1;q>=F;q--)for(w=0;w<f;w++)u=d[w],x[q][u.dataIndx]=[];for(u=F;u<k;u++)e.push({groupTitle:y[u],level:u,GMRowIndx:e.length,collapsed:p&&null!=p[u]?p[u]:!1}),n[u]=e.length-1}if(A==B)break;C.rowIndx=A+c;C.pq_hidden=!1;e.push(C);for(F=0;F<f;F++)for(u=d[F],I=u.dataIndx,q=0;q<k;q++)x[q][I].push(C[I])}a.dataGM=
e}else a.dataGM=null};var m=function(a){this.that=a;this.$drag_helper=null;var b=a.options.dragColumns,d=b.topIcon,e=b.bottomIcon,c=this;this.status="stop";this.$arrowTop=g("<div class='pq-arrow-down ui-icon "+d+"'></div>").appendTo(a.element);this.$arrowBottom=g("<div class='pq-arrow-up ui-icon "+e+"' ></div>").appendTo(a.element);this.hideArrows();if(b&&b.enabled)a.$header_o.on("mousedown","td.pq-grid-col",function(a,b){if(!g(a.target).is("input,select,textarea")&&!a.pq_composed){c.setDraggables(a,
b);a.pq_composed=!0;var d=g.Event("mousedown",a);g(a.target).trigger(d)}})},n=m.prototype;n.showFeedback=function(a,b){var d=this.that,e=a[0],c=e.offsetLeft+e.offsetParent.offsetParent.offsetLeft+(b?0:e.offsetWidth)-8,f=d.$grid_inner[0].offsetTop+d.$header[0].offsetHeight;this.$arrowTop.css({left:c,top:d.$grid_inner[0].offsetTop+e.offsetTop-16,display:""});this.$arrowBottom.css({left:c,top:f,display:""})};n.showArrows=function(){this.$arrowTop.show();this.$arrowBottom.show()};n.hideArrows=function(){this.$arrowTop.hide();
this.$arrowBottom.hide()};n.updateDragHelper=function(a){var b=this.that.options.dragColumns,d=b.acceptIcon,b=b.rejectIcon,e=this.$drag_helper;e&&(a?(e.children("span.pq-drag-icon").addClass(d).removeClass(b),e.removeClass("ui-state-error")):(e.children("span.pq-drag-icon").removeClass(d).addClass(b),e.addClass("ui-state-error")))};n.setDraggables=function(a,b){var d=g(a.currentTarget),e=this.that,c=e.options.dragColumns.rejectIcon,f=this;d.hasClass("ui-draggable")||e.getHeaderColumnFromTD(d)&&d.draggable({distance:10,
cursorAt:{top:-18,left:-10},helper:function(){var a=g(this);f.status="helper";f._setupDroppables(a);e.$header.find(".pq-grid-col-resize-handle").hide();var b=a.attr("pq-col-indx"),d=a.attr("pq-row-indx");a.droppable("destroy");a=g("<div class='pq-col-drag-helper ui-widget-content ui-corner-all' ><span class='pq-drag-icon ui-icon "+c+"'></span>"+e.headerCells[d][b].title+"</div>");f.$drag_helper=a;return a[0]},zIndex:"1000",appendTo:e.element,revert:"invalid",drag:function(a,b){f.status="drag";var d=
g("td.pq-drop-hover",e.$header);if(0<d.length){f.showArrows();f.updateDragHelper(!0);var c=d.width();a.clientX-d.offset().left+g(document).scrollLeft()<c/2?(f.leftDrop=!0,f.showFeedback(d,!0)):(f.leftDrop=!1,f.showFeedback(d,!1))}else f.hideArrows(),e.$toolbar.hasClass("pq-drop-hover")?f.updateDragHelper(!0):f.updateDragHelper()},stop:function(a,b){f.status="stop";e.$header.find(".pq-grid-col-resize-handle").show();f.hideArrows()}})};n._columnIndexOf=function(a,b){for(var d=0,e=a.length;d<e;d++)if(a[d]==
b)return d;return-1};n._setupDroppables=function(a){var b=this.that,d=this,e={hoverClass:"pq-drop-hover ui-state-highlight",tolerance:"pointer",drop:function(a,e){if(!b.dropPending){var c=parseInt(e.draggable.attr("pq-col-indx")),f=parseInt(e.draggable.attr("pq-row-indx")),l=parseInt(g(this).attr("pq-col-indx")),h=g(this).attr("pq-row-indx"),k=b.options.colModel,p=b.headerCells,m=p[f][c],c=0==f?k:p[f-1][c].colModel,k=0==h?k:p[h-1][l].colModel,l=p[h][l],m=d._columnIndexOf(c,m),m=c.splice(m,1)[0],l=
d._columnIndexOf(k,l);k.splice(l+1-(d.leftDrop?1:0),0,m);b.dropPending=!0;window.setTimeout(function(){b._calcThisColModel();b.refresh();b.dropPending=!1},0)}}};a=b.$header_left.find("td.pq-left-col");var c=b.pqpanes.v?b.$header_right.find("td.pq-right-col"):b.$header_left.find("td.pq-right-col");a=a.add(c);a.each(function(a,b){var d=g(b);d.hasClass("ui-droppable")||d.droppable(e)})};h.options={detailModel:{cache:!0,offset:100,expandIcon:"ui-icon-triangle-1-se",collapseIcon:"ui-icon-triangle-1-e"},
dragColumns:{enabled:!0,acceptIcon:"ui-icon-check",rejectIcon:"ui-icon-closethick",topIcon:"ui-icon-circle-arrow-s",bottomIcon:"ui-icon-circle-arrow-n"},track:null,treeModel:{collapsed:!0,indent:15,leafIcon:"ui-icon-radio-off",expandIcon:"ui-icon-triangle-1-se",collapseIcon:"ui-icon-triangle-1-e"},filterModel:{on:!0,mode:"AND",header:!1}};h._create=function(){g.extend(g.paramquery.cGenerateView.prototype,f);var a=this;this.iHistory=new g.paramquery.cHistory(this);this.iGroupView=new p(this);this.iHeaderSearch=
new e(this);this.iUCData=new g.paramquery.cUCData(this);this.iMouseSelection=new g.paramquery.cMouseSelection(this);this._super.apply(this);this.iGroupView.bindEvents();this.iDragColumns=new m(this);this._createToolbar();this.refreshDataAndView({header:!0});this.refresh({table:!0});var b=a.widgetEventPrefix.toLowerCase();a.element.one(b+"load."+a.widgetName,function(b,e){a.refresh()})};h._createToolbar=function(){var a=this.options,b=a.toolbar;if(b){var d=b.cls,e=b.style,c=b.attr,b=b.items,d=g("<div class='"+
(d?d:"")+"' style='"+(e?e:"")+"' "+(c?c:"")+" ></div>").appendTo(g(".pq-grid-top",this.element));d.pqToolbar({items:b,gridInstance:this});a.showToolbar||d.css("display","none");this.$toolbar=d}};h.isLeftOrRight=function(a){return a>this.freezeCols?"right":"left"};h.ovCreateHeader=function(a,b){this.options.filterModel.header&&this.iHeaderSearch.createDOM(a,b)};h._createHeader=function(){this._super.apply(this);this.options.showHeader&&this._trigger("createHeader")};h.exportExcel=function(a){a.format=
"xml";return g.paramquery.pqgrid.exportToExcel.call(this,a)};h.exportCsv=function(a){a.format="csv";return g.paramquery.pqgrid.exportToExcel.call(this,a)};h.filter=function(a){var b=this,d=this.options,e=void 0===a.apply?!0:a.apply,c=void 0===a.sort?!0:a.sort,f=d.dataModel,d=d.filterModel;if(void 0!=a){var h="replace"==a.oper?!0:!1;a=a.data;for(var k=this.colModel,k=e?k:g.extend(!0,[],k),p=0,m=k.length,q=a.length,n=0;n<m;n++){for(var u=k[n],t=!1,w=0;w<q&&p!=q;w++){var y=a[w];if(y.dataIndx==u.dataIndx){t=
!0;p++;var w=u.filter,z=y.condition,x=y.value;w?w.on=!0:w=u.filter={on:!0};z&&(w.condition=z);z=w.condition;w.value=x;if("between"==z)w.value2=y.value2;else if("range"==z){y=[];if(x)if("string"==typeof x){var z=w.options,A=x.indexOf('"'),B=x.lastIndexOf('"'),x=x.substr(A,B+1),x=JSON.parse("["+x+"]");if(z)for(A=0,B=z.length;A<B;A++){var C=z[A];-1!=g.inArray(C,x)&&y.push(C)}else y=x.split(",s*")}else"function"==typeof x.push&&(y=x);w.value=y}break}}h&&!t&&u.filter&&(u.filter.on=!1)}}var F={header:!1,
apply:e,sort:c,CM:k};if("remote"==f.location&&"local"!=d.type)this.remoteRequest({apply:e,CM:k,callback:function(){return b._onDataAvailable(F)}});else return F.source="filter",b._onDataAvailable(F)};h._initTypeColumns=function(){for(var a=this.colModel,b=0,d=a.length;b<d;b++){var e=a[b],f=e.type;"checkBoxSelection"===f?new g.paramquery.cCheckBoxColumn(this,e):"detail"===f&&(e.dataIndx="pq_detail",this.iHierarchy=new c(this))}};h.refreshDataFromDataModel=function(){this._super.apply(this);this.options.groupModel&&
this.iGroupView._refreshDataFromDataModel()};n=(g.paramquery.cSort=function(a){this.that=a}).prototype;n._refreshSorters=function(a){var b=this.that.options,d=b.dataModel,e=d.sortIndx,c=g.isArray(e),f=b.groupModel,h=f?f.dataIndx:null,k=f?f.dir:null,p=-1,b=[];if(f)for(f=0;f<h.length;f++){var m=h[f];m==a&&(p=f);b.push({dataIndx:m,dir:k&&k[f]?k[f]:"up"})}-1!==p?(a="up"===b[p].dir?"down":"up",b[p].dir=a,k[p]=a):null!=a&&(c?(k=g.inArray(a,d.sortIndx),-1!=k?"up"==d.sortDir[k]?d.sortDir[k]="down":1==e.length?
d.sortDir[k]="up":(d.sortIndx.splice(k,1),d.sortDir.splice(k,1)):(k=d.sortIndx.length,d.sortIndx[k]=a,d.sortDir[k]="up")):d.sortIndx==a?d.sortDir="up"==d.sortDir?"down":"up":(d.sortIndx=a,d.sortDir="up"));if(null!=d.sortIndx)if(c)for(f=0;f<e.length;f++)c=e[f],-1==this.inSorters(b,c)&&b.push({dataIndx:c,dir:d.sortDir[f]});else-1==this.inSorters(b,d.sortIndx)&&b.push({dataIndx:d.sortIndx,dir:d.sortDir});this.sorters=b};n.inSorters=function(a,b){for(var d=-1,e=0;e<a.length;e++)if(a[e].dataIndx==b){d=
e;break}return d};n._sortLocalData=function(a){for(var b=this.that,d=b.colModel,e=this.sorters,c=0;c<e.length;c++){var f=e[c],h=b.getColIndx({dataIndx:f.dataIndx});f.dataType=d[h].dataType}return this.__sortLocalData(e,a)};n.__sortLocalData=function(a,b){function d(a,b,d,e){a=a[d];b=b[d];a=a?parseInt(a,10):0;b=b?parseInt(b,10):0;return(a-b)*e}function e(a,b,d,c){a=a[d];b=b[d];a=a?Date.parse(a):0;b=b?Date.parse(b):0;return(a-b)*c}function c(a,b,d,e){a=(a[d]+"").replace(/,/g,"");b=(b[d]+"").replace(/,/g,
"");a=a?parseFloat(a):0;b=b?parseFloat(b):0;return(a-b)*e}function f(a,b,d,e){a=a[d];b=b[d];a=a?a:"";b=b?b:"";d=0;a>b?d=1:a<b&&(d=-1);return d*e}function h(a,b,d,e){a=a[d];b=b[d];a=a?a.toUpperCase():"";b=b?b.toUpperCase():"";d=0;a>b?d=1:a<b&&(d=-1);return d*e}function k(a,b,d,e){a=a[d];b=b[d];d=0;if(a&&!b||!1===a&&null===b)d=1;else if(b&&!a||!1===b&&null===a)d=-1;return d*e}function p(){for(var g=[],m=[],q=[],n=a.length,t=0;t<n;t++){var w=a[t],y="up"==w.dir?1:-1,z=w.dataType;m[t]=w.dataIndx;q[t]=
y;g[t]="integer"==z?d:"float"==z?c:"function"==typeof z?function(a){return function(b,d,e,c){return a(b[e],d[e])*c}}(z):"date"==z?e:"stringi"==z?h:"bool"==z?k:f}b=b.sort(function(a,b){for(var d=0,e=0;e<n&&(d=g[e](a,b,m[e],q[e]),0==d);e++);return d})}if(null!=b&&0!=b.length){if(!a||!a.length)return b;p();return b}};h._refreshHeaderSortIcons=function(){var a=this.iSort.sorters,b=this.$header;if(b){b.find(".pq-grid-col").removeClass("pq-col-sort-asc pq-col-sort-desc ui-state-active");b.find(".pq-col-sort-icon").removeClass("ui-icon ui-icon-triangle-1-n ui-icon-triangle-1-s");
for(var d=0;d<a.length;d++){var e=a[d],c=this.getColIndx({dataIndx:e.dataIndx}),f=e.dir,e="ui-state-active pq-col-sort-"+("up"==f?"asc":"desc"),f="ui-icon ui-icon-triangle-1-"+("up"==f?"n":"s");b.find(".pq-grid-col[pq-grid-col-indx="+c+"]").addClass(e);b.find(".pq-grid-col[pq-grid-col-indx="+c+"] .pq-col-sort-icon").addClass(f)}}};h.getHeaderColumnFromTD=function(a){a=a.attr("pq-grid-col-indx");if(null!=a)return this.colModel[a]};h.getIndxInSorters=function(a){for(var b=this.sorters,d=0,e=b.length;d<
e;d++)if(b[d].dataIndx==a)return d;return-1};h.getLargestRowCol=function(a){for(var b=0;b<a.length;b++);};h.bringCellToView=function(a){this._bringCellToView(a)};h._setUrl=function(a){this.options.dataModel.getUrl=function(){return{url:this.url+(null!=a?a:"")}}};h.getDataPage=function(){return this.pdata};h.getData=function(a){var b=a.dataIndx,d=b.length;a=a.data;var e=this.options.dataModel,c=e.data,e=e.dataUF,f=[],h=function(a){for(var e=0,c=a.length;e<c;e++){for(var h=a[e],l={},k=0;k<d;k++){var p=
b[k];l[p]=h[p]}f.push(l)}};a?h(a):(c&&h(c),e&&h(e));a=[];for(c=0;c<d;c++)e=b[c],h=this.getColumn({dataIndx:e}),a.push({dataIndx:e,dir:"up",dataType:h.dataType});f=this.iSort.__sortLocalData(a,f);a=[];c=void 0;for(e=0;e<f.length;e++){var h=f[e],k=JSON.stringify(h);k!==c&&(a.push(h),c=k)}return a};h.getFilterData=function(a){var b=a.CM;if(!b)throw"CM N/A";var d=b.length,e=a.location;a=this.options.filterModel.multiple;for(var c=g.paramquery.filter.getAllConditions,f=g.paramquery.filter.getTRConditions,
h=[],k=function(a,b,d){return"between"==a?null!=b&&""!==b||null!=d&&""!==d?!0:!1:-1!=g.inArray(a,c)?null!=b&&""!==b||-1==g.inArray(a,f)?!0:!1:!0},p=function(a,b){return"remote"==e?(null==a?"":a).toString():q.convert(a,b)},m=0;m<d;m++){var n=b[m],H=n.dataIndx,u=n.dataType,u=u&&"function"!=typeof u?u:"string",t=n.filter;if(a){if((t=n.filterModel)&&t.on){for(var w=[],y=t.mode,z=t.filters,n=0;n<z.length;n++){var t=z[n],x=t.value,A=t.condition;k(A,x)&&(x=p(x,u),w.push({value:x,condition:A}))}h.push({dataIndx:H,
mode:y,dataType:u,filters:w})}}else if(t&&t.on&&(x=t.value,w=t.value2,A=t.condition,k(A,x,w))){if("between"==A)""===x||null==x?(A="lte",x=p(w,u)):""===w||null==w?(A="gte",x=p(x,u)):(x=p(x,u),w=p(w,u));else if("regexp"==A)if("remote"==e)x=x.toString();else{if("string"==typeof x)try{var B=t.modifiers,B=B?B:"gi",x=new RegExp(x,B)}catch(C){x=/.*/}}else if("range"==A)if(null==x)continue;else if("string"==typeof x)x=p(x,u),x=x.split(/\s*,\s*/);else{if(x&&"function"==typeof x.push){if(0==x.length)continue;
x=x.slice();n=0;for(t=x.length;n<t;n++)x[n]=p(x[n],u)}}else x=p(x,u);h.push({dataIndx:H,value:x,value2:w,condition:A,dataType:u,cbFn:"remote"==e?"":q.conditions[A]})}}return h};var q=function(a){this.that=a},n=q.prototype;q.conditions={equal:function(a,b){if(a==b)return!0},contain:function(a,b){if(-1!=a.indexOf(b))return!0},notcontain:function(a,b){if(-1==a.indexOf(b))return!0},empty:function(a){if(0==a.length)return!0},notempty:function(a){if(0<a.length)return!0},begin:function(a,b){if(0==a.indexOf(b))return!0},
notbegin:function(a,b){if(0!=a.indexOf(b))return!0},end:function(a,b){var d=a.lastIndexOf(b);if(-1!=d&&d+b.length==a.length)return!0},notend:function(a,b){var d=a.lastIndexOf(b);if(-1==d||d+b.length!=a.length)return!0},regexp:function(a,b){if(b.test(a))return b.lastIndex=0,!0},notequal:function(a,b){if(a!=b)return!0},great:function(a,b){if(a>b)return!0},gte:function(a,b){if(a>=b)return!0},between:function(a,b,d){if(a>=b&&a<=d)return!0},range:function(a,b){if(-1!=g.inArray(a,b))return!0},less:function(a,
b){if(a<b)return!0},lte:function(a,b){if(a<=b)return!0}};q.convert=function(a,b){a=null==a?"":a;"string"==b?a=g.trim(a).toUpperCase():"date"==b?a=Date.parse(a):"integer"==b?a=parseInt(a):"float"==b?a=parseFloat(a):"bool"==b&&(a=String(a).toLowerCase());return a};n.isMatchCellSingle=function(a,b){var d=a.dataType,e=a.value,c=a.value2,f=a.cbFn,h=b[a.dataIndx],h="regexp"==a.condition?null==h?"":h:q.convert(h,d);return f(h,e,c)?!0:!1};n.isMatchCellMultiple=function(a,b){var d=a.dataIndx,e=a.dataType,
c=a.mode,f=a.filters,h=f.length;if(0==h)return!0;for(var k=0;k<h;k++){var p=f[k],p=this.isMatchRule(b[d],p.condition,p.value,e);if("OR"==c&&p)return!0;if("AND"==c&&!p)return!1}if(1===h)return p;if("AND"==c)return!0;if("OR"==c)return!1};n.isMatchRow=function(a,b,d){if(0==b.length)return!0;for(var e=0;e<b.length;e++){var c=this.isMatchCell(b[e],a);if("OR"==d&&c)return!0;if("AND"==d&&!c)return!1}if("AND"==d)return!0;if("OR"==d)return!1};h.filterLocalData=function(a){a=a?a:{};var b=a.apply;a=!1===b?a.CM:
this.colModel;var d=this.getFilterData({CM:a}),e=this.options,c=e.dataModel,f=c.data,h=c.dataUF,k=[],p=[],e=e.filterModel,g=e.multiple,m=e?e.mode:null,n=new q;n.isMatchCell=g?n.isMatchCellMultiple:n.isMatchCellSingle;if(e.on&&m){if(f)for(var g=0,u=f.length;g<u;g++){var t=f[g];n.isMatchRow(t,d,m)?k.push(t):p.push(t)}if(h)for(g=0,u=h.length;g<u;g++)t=h[g],n.isMatchRow(t,d,m)?k.push(t):p.push(t)}else{if(f)for(g=0,u=f.length;g<u;g++)t=f[g],k.push(t);if(h)for(g=0,u=h.length;g<u;g++)t=h[g],k.push(t)}b&&
(c.data=k,c.dataUF=p,this._trigger("filter",null,{type:"local",dataModel:c,colModel:a,filterModel:e}));return{data:k,dataUF:p}};h._onDataAvailable=function(a){a=a?a:{};var b=this.options,d=a.apply,e=a.source,c=a.sort,f=[],f=b.filterModel,b=b.dataModel,h=b.location;!1!==d&&this._trigger("dataAvailable",a.evt,{dataModel:b,source:e});f=f&&f.on&&("local"==h&&"remote"!=f.type||"remote"==h&&"local"==f.type)?this.filterLocalData(a).data:b.data;b.sorting&&"local"==b.sorting&&!1!==c&&(f=this.iSort._sortLocalData(f));
if(!1===d)return f;b.data=f;this.refreshView(a)};h.sort=function(a){var b=this,d=this.options,e=a.colIndx,c=d.editModel,f=a.dataIndx,h=a.evt,k=d.dataModel;if(null==e&&null==f&&(f=k.sortIndx,null==f))return;var e=null==e?this.getColIndx({dataIndx:f}):e,p=this.colModel[e],f=null==f?p.dataIndx:f;!1!=b._trigger("beforeSort",h,{dataModel:k,column:p,dataIndx:f})&&(c.indices&&b.blurEditor({force:!0}),this.iSort._refreshSorters(f),"local"==k.sorting?(this.iSort._sortLocalData(k.data),this.refreshView()):
"remote"==k.sorting&&this.remoteRequest({callback:function(){b._trigger("sort",h,{dataModel:k,column:p,dataIndx:f});b._onDataAvailable()}}))};h._setScrollVLength=function(a){a=this.options.groupModel?this.dataGM:a;this._super.call(this,a)};g.widget("paramquery.pqGrid",g.paramquery._pqGrid,h);g.paramquery.pqGrid.regional={};g.paramquery.pqGrid.regional.en=h._regional})(jQuery);
(function(g){g.paramquery=null==g.paramquery?{}:g.paramquery;g.paramquery.pqgrid=null==g.paramquery.pqgrid?{}:g.paramquery.pqgrid;g.paramquery.pqgrid.exportToExcel=function(c){var n=this,h=void 0===c.urlPost?c.url:c.urlPost,k=c.url,e=null==c.sheetName?"pqGrid":c.sheetName;c=c.format;var f=function(){for(var e=n.colModel,c=e.length,f=n.options.dataModel.data,a=f.length,b=[],d=[],h=[],k=0;k<c;k++){var g=e[k];!1!==g.copy&&(g=g.title.replace(/\"/g,'""'),d.push('"'+g+'"'))}b.push(d.join(","));for(k=0;k<
a;k++){for(var d=f[k],v=0;v<c;v++)g=e[v],!1!==g.copy&&(g=d[g.dataIndx]+"",g=g.replace(/\"/g,'""'),h.push('"'+g+'"'));b.push(h.join(","));h=[]}return b.join("\n")},f="xml"==c?function(){for(var c=n.colModel,f=c.length,h=n.options.dataModel.data,a=h.length,b=[],d=[],l=0;l<f;l++){var k=c[l];!1!==k.copy&&d.push('<Column ss:AutoFitWidth="1"  ss:Width="'+k._width+'" />')}d.push("<Row>");for(l=0;l<f;l++)k=c[l],!1!==k.copy&&d.push('<Cell><Data ss:Type="String">'+k.title+"</Data></Cell>");d.push("</Row>");
d=d.join("\n");for(l=0;l<a;l++){var g=h[l];b.push("<Row>");for(var v=0;v<f;v++)k=c[v],!1!==k.copy&&b.push('<Cell><Data ss:Type="String"><![CDATA['+g[k.dataIndx]+"]]\x3e</Data></Cell>");b.push("</Row>")}b=b.join("\n");return['<?xml version="1.0"?>\n<?mso-application progid="Excel.Sheet"?>\n<Workbook xmlns="urn:schemas-microsoft-com:office:spreadsheet"\n xmlns:o="urn:schemas-microsoft-com:office:office"\n xmlns:x="urn:schemas-microsoft-com:office:excel"\n xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet"\n xmlns:html="http://www.w3.org/TR/REC-html40">\n<Worksheet ss:Name="',
e,'">\n<Table>',d,b,"</Table>\n</Worksheet>\n</Workbook>"].join("\n")}():f();g.ajax({url:h,type:"POST",cache:!1,data:{extension:c,excel:f},success:function(e){e=k+((0<k.indexOf("?")?"&":"?")+"filename="+e);g(document.body).append("<iframe height='0' width='0' frameborder='0'  src="+e+"></iframe>")}})}})(jQuery);
(function(g){var c=g.paramquery.pqGrid.prototype.options,n={on:!1,dirtyClass:"pq-cell-dirty"};c.trackModel=c.trackModel||n;c=(g.paramquery.cUCData=function(c){this.that=c;this.udata=[];this.ddata=[];this.adata=[];this.options=c.options;var k=this,e=c.eventNamespace,f=c.widgetEventPrefix.toLowerCase();c.element.on(f+"dataavailable"+e,function(e,c){k.belongs(e)&&"filter"!=c.source&&(k.udata=[],k.ddata=[],k.adata=[])})}).prototype=new g.paramquery.cClass;c.add=function(c){var k=this.that,e=this.adata;
c=c.rowData;for(var f=this.options.trackModel.dirtyClass,g=k.getRecId({rowData:c}),m=0,q=e.length;m<q;m++){var a=e[m];if(null!=g&&a.recId==g)throw"primary key violation";if(a.rowData==c)throw"same data can't be added twice.";}var m=[],b;for(b in c)m.push(b);k.removeClass({rowData:c,dataIndx:m,cls:f});c={recId:g,rowData:c};e.push(c)};c.update=function(c){var k=this.that,e=this.options.trackModel.dirtyClass,f=c.rowData||k.getRowData(c),p=k.getRecId({rowData:f}),m=c.dataIndx,q=c.refresh,a=k.columns,
b=g.paramquery.getValueFromDataType;c=c.row;var d=this.udata,l=d.slice(0),n=!1;if(null!=p){for(var r=0,v=d.length;r<v;r++){var D=d[r],L=D.oldRow;if(D.rowData==f){n=!0;for(m in c)d=a[m].dataType,v=c[m],v=b(v,d),D=L[m],D=b(D,d),L.hasOwnProperty(m)&&D===v?(d={rowData:f,dataIndx:m,refresh:q,cls:e},k.removeClass(d),delete L[m]):(d={rowData:f,dataIndx:m,refresh:q,cls:e},k.addClass(d),L.hasOwnProperty(m)||(L[m]=f[m]));g.isEmptyObject(L)&&l.splice(r,1);break}}if(!n){L={};for(m in c)L[m]=f[m],d={rowData:f,
dataIndx:m,refresh:q,cls:e},k.addClass(d);d={rowData:f,recId:p,oldRow:L};l.push(d)}this.udata=l}};c["delete"]=function(c){var k=this.that,e=c.rowIndx,f=c.rowIndxPage,g=k.rowIndxOffset,e=null==e?f+g:e,f="remote"==k.options.pageModel.type?null==f?e-g:f:e,g=this.adata,m=this.ddata;c=k.getRowData(c);for(var k=0,q=g.length;k<q;k++)if(g[k].rowData==c){g.splice(k,1);return}m.push({indx:f,rowData:c,rowIndx:e})};c.isDirty=function(c){var k=this.udata,e=this.adata,f=this.ddata,g=!1;if(c=this.that.getRowData(c))for(e=
0;e<k.length;e++){if(c==k[e].rowData){g=!0;break}}else if(k.length||e.length||f.length)g=!0;return g};c.getChangesValue=function(){for(var c=this.udata,k=this.adata,e=this.ddata,f={updateList:[],addList:[],deleteList:[]},p=[],m=[],q=[],a=[],b=[],d=0,l=e.length;d<l;d++){var n=e[d],n=n.rowData,r={};a.push(n);for(var v in n)0!=v.indexOf("pq_")&&(r[v]=n[v]);b.push(r)}for(d=0;d<c.length;d++)if(n=c[d],n=n.rowData,-1==g.inArray(n,a)&&-1==g.inArray(n,p)){r={};for(v in n)0!=v.indexOf("pq_")&&(r[v]=n[v]);p.push(n);
m.push(r)}for(d=0;d<k.length;d++){n=k[d];n=n.rowData;r={};for(v in n)0!=v.indexOf("pq_")&&(r[v]=n[v]);q.push(r)}f.updateList=m;f.addList=q;f.deleteList=b;return f};c.getChanges=function(){for(var c=this.udata,k=this.adata,e=this.ddata,f={updateList:[],addList:[],deleteList:[]},p=[],m=[],q=[],a=0,b=e.length;a<b;a++){var d=e[a],d=d.rowData;q.push(d)}a=0;for(b=c.length;a<b;a++)d=c[a],d=d.rowData,-1==g.inArray(d,q)&&-1==g.inArray(d,p)&&p.push(d);a=0;for(b=k.length;a<b;a++)d=k[a],d=d.rowData,m.push(d);
f.updateList=p;f.addList=m;f.deleteList=q;return f};c.getChangesRaw=function(){var c=this.adata,k=this.ddata,e={updateList:[],addList:[],deleteList:[]};e.updateList=this.udata;e.addList=c;e.deleteList=k;return e};c.commitAdd=function(c,k){for(var e=this.that.colModel,f=e.length,p=this.adata,m=g.inArray,q=p.length,a=g.paramquery.getValueFromDataType,b=[],d=c.length,l=[],n=0;n<d;n++)for(var r=c[n],v=0;v<q;v++){var D=p[v].rowData,L=!0;if(-1==m(D,l)){for(var M=0;M<f;M++){var J=e[M],H=J.dataType,u=J.dataIndx;
if(!J.hidden&&u!=k&&(J=D[u],J=a(J,H),u=r[u],u=a(u,H),J!==u)){L=!1;break}}if(L){v={};L={};v[k]=r[k];L[k]=D[k];b.push({type:"update",rowData:D,oldRow:L,newRow:v});l.push(D);break}}}e=[];for(v=0;v<q;v++)D=p[v].rowData,-1==m(D,l)&&e.push(p[v]);this.adata=e;return b};c.commitUpdate=function(c,k){for(var e=this.that,f=this.options.trackModel.dirtyClass,p=e.colModel,m=p.length,q=this.udata,a=q.length,b=c.length,d=[],l=0;l<a;l++){var n=q[l],r=n.rowData,n=n.oldRow;if(-1==g.inArray(r,d))for(var v=0;v<b;v++)if(r[k]==
c[v][k]){d.push(r);for(var D=0;D<m;D++)var L=p[D].dataIndx;for(L in n)e.removeClass({rowData:r,dataIndx:L,cls:f})}}e=[];for(l=0;l<a;l++)r=q[l].rowData,-1==g.inArray(r,d)&&e.push(q[l]);this.udata=e;return[]};c.commitDelete=function(c,k){for(var e=this.ddata,f=e.length,p=c.length,m=[],q=0;q<f;q++)for(var a=e[q].rowData,b=0;b<p;b++)a[k]==c[b][k]&&m.push(a);p=[];for(q=0;q<f;q++)a=e[q].rowData,-1==g.inArray(a,m)&&p.push(e[q]);this.ddata=p};c.commitUpdateAll=function(){for(var c=this.that,k=this.options.trackModel.dirtyClass,
e=this.udata,f=0,g=e.length;f<g;f++){var m=e[f],q=m.oldRow,m=m.rowData,a;for(a in q)c.removeClass({rowData:m,dataIndx:a,cls:k})}this.udata=[]};c.commitAddAll=function(){this.adata=[]};c.commitDeleteAll=function(){this.ddata=[]};c.commit=function(c){var k=this.that,e=c?c.history:null,e=null==e?!1:e,f=[],f=[],g=[],m=k.options.dataModel.recIndx;if(null==c)this.commitAddAll(),this.commitUpdateAll(),this.commitDeleteAll();else{var q=c.type;c=c.rows;"add"==q?c?f=this.commitAdd(c,m):this.commitAddAll():
"update"==q?c?g=this.commitUpdate(c,m):this.commitUpdateAll():"delete"==q&&(c?this.commitDelete(c,m):this.commitDeleteAll())}f=f.concat(g);f.length&&(k._digestData({source:"commit",checkEditable:!1,track:!1,history:e,rowList:f}),k.refreshView())};c.rollbackAdd=function(c,k){for(var e=this.adata,f=[],g=0,m=e.length;g<m;g++)f.push({type:"delete",rowData:e[g].rowData});this.adata=[];return f};c.rollbackDelete=function(c,k){for(var e=this.ddata,f=[],g=e.length-1;0<=g;g--){var m=e[g];f.push({type:"add",
rowIndx:m.rowIndx,newRow:m.rowData})}this.ddata=[];return f};c.rollbackUpdate=function(c,k){for(var e=this.that,f=this.options.trackModel.dirtyClass,g=this.udata,m=[],q=0,a=g.length;q<a;q++){var b=g[q],d=b.rowData,l={},n=b.oldRow;if(null!=b.recId){var b=[],r;for(r in n)l[r]=d[r],b.push(r);e.removeClass({rowData:d,dataIndx:b,cls:f,refresh:!1});m.push({type:"update",rowData:d,newRow:n,oldRow:l})}}this.udata=[];return m};c.rollback=function(c){var k=this.that,e=k.options.pageModel,f=c&&null!=c.refresh?
c.refresh:!0;c=c&&null!=c.type?c.type:null;var g=[],g=[],m=[],q=[],a=k.options.dataModel.data;if(null==c||"update"==c)m=this.rollbackUpdate(e,a);if(null==c||"delete"==c)g=this.rollbackDelete(e,a);if(null==c||"add"==c)q=this.rollbackAdd(e,a);g=g.concat(q,m);k._digestData({history:!1,allowInvalid:!0,checkEditable:!1,source:"rollback",track:!1,rowList:g});f&&k.refreshView()};c=g.paramquery.pqGrid.prototype;c.getChanges=function(c){this.blurEditor({force:!0});if(c&&(c=c.format)){if("byVal"==c)return this.iUCData.getChangesValue();
if("raw"==c)return this.iUCData.getChangesRaw()}return this.iUCData.getChanges()};c.rollback=function(c){this.blurEditor({force:!0});this.iUCData.rollback(c)};c.isDirty=function(c){return this.iUCData.isDirty(c)};c.commit=function(c){this.iUCData.commit(c)};c._getRowIndx=function(){var c=this.selection({type:"row",method:"getSelection"});if(c&&0<c.length){var c=c[0].rowIndx,k=this.options.pageModel,e=c-this.rowIndxOffset,f=k.rPP;if(k.type){if(0<=e&&e<f)return c}else return c}else return null};c.updateRow=
function(c){var k=c.rowIndx,e=c.row,f=c.rowData||this.getRowData({rowIndx:k});if(!f)return!1;var g={},m;for(m in e)g[m]=f[m];if(!1===this._digestData({source:c.source||"update",history:c.history,checkEditable:c.checkEditable,track:c.track,allowInvalid:c.allowInvalid,rowList:[{newRow:e,oldRow:g,rowData:f,rowIndx:k,type:"update"}]}))return!1;!1!==c.refresh&&this.refreshRow({rowIndx:k})};c.updateElseAdd=function(c){var k=c.row;null==this.getRowData({rowIndx:c.rowIndx})?(c.rowData=k,this.addRow(c)):this.updateRow(c)};
c._fillForm=function(c){var k=this.colModel,e=this.rowIndxOffset,f=null==c.rowIndxPage?c.rowIndx-e:c.rowIndxPage;c=null==c.rowIndx?f+e:c.rowIndx;this.rowData=f=this.options.dataModel.data["remote"==this.options.pageModel.type?f:c];this.$crudDialog.dialog("option","title","Edit Record ("+(c+1)+")");c=this.$crudForm;for(e=0;e<k.length;e++){var g=k[e].dataIndx,m=f[g];c.find("*[name='"+g+"']").val(m)}};c.getRecId=function(c){c.dataIndx=this.options.dataModel.recIndx;c=this.getCellData(c);return null==
c?null:c};c.getCellData=function(c){var k=c.rowData||this.getRowData(c);c=c.dataIndx;return k?k[c]:null};c.getRowData=function(c){if(!c)return null;var k=c.rowData;if(null!=k)return k;var e=this.options,k=e.dataModel,e=e.pageModel.type,f=k.recIndx,g=c.recId,k=k.data;if(null!=g)for(c=0,e=k.length;c<e;c++){var m=k[c];if(m[f]==g)return m}else return f=c.rowIndx,c=c.rowIndxPage,g=this.rowIndxOffset,f=null!=f?f:c+g,c="remote"==e?null!=c?c:f-g:f,m=k?k[c]:null;return null};c.deleteRow=function(c){var k=
c.rowIndx,e=c.rowIndxPage,f=this.rowIndxOffset,k=null!=e?e+f:k;null!=k&&(e=c.rowData||this.getRowData({rowIndx:k}),this._digestData({source:c.source||"delete",history:c.history,track:c.track,rowList:[{rowIndx:k,rowData:e,oldRow:e,type:"delete"}]}),!1!==c.refresh&&this.refreshView())};c.addRow=function(c){var k=c.rowData||c.row,e=c.rowIndx,f=c.rowIndxPage,g=this.rowIndxOffset,e=null!=f?f+g:e,f=this.options.dataModel,g=f.data;if(null==k)return null;null==g&&(f.data=[],g=f.data);if(!1===this._digestData({source:c.source||
"add",history:c.history,track:c.track,checkEditable:c.checkEditable,rowList:[{newRow:k,rowIndx:e,type:"add"}]}))return!1;!1!==c.refresh&&this.refreshView();return null==e?g.length-1:e}})(jQuery);
(function(g){g.widget("paramquery.pqToolbar",{options:{items:[],gridInstance:null},_create:function(){var c=this.options,n=c.gridInstance,h=n.colModel,k=c.items,e=this.element;e.closest(".pq-grid");e.addClass("pq-toolbar");for(var f=0,p=k.length;f<p;f++){var m=k[f],c=m.type,q=m.icon,a=m.label,b=m.listener,d=b?[b]:m.listeners,b=m.cls,b="ui-corner-all "+(b?b:""),l=m.style,l=l?'style="'+l+'"':"",s=m.attr,s=s?s:"",r;"textbox"==c?r=g("<input type='text' class='"+b+"' "+s+" "+l+">").appendTo(e):"checkbox"==
c?r=g("<input type='checkbox' class='"+b+"' "+s+" "+l+">").appendTo(e):"separator"==c?g("<span class='pq-separator '"+b+"' "+s+" "+l+"></span>").appendTo(e):"button"==c?(c=m.options?m.options:{},g.extend(c,{text:a?!0:!1,icons:{primary:q}}),r=g("<button type='button' class='"+b+"' "+s+" "+l+">"+a+"</button>").button(c).appendTo(e)):"select"==c?(c=m.options?m.options:[],"function"===typeof c&&(c=c.call(n.element[0],{colModel:h})),r=g.paramquery.select({options:c,attr:" class='"+b+"' "+s+" "+l,prepend:m.prepend,
groupIndx:m.groupIndx,valueIndx:m.valueIndx,labelIndx:m.labelIndx}),r=g(r).appendTo(e)):"string"==typeof c?r=g(c).appendTo(e):"function"==typeof c&&(r=c.call(n.element[0],{colModel:h,cls:b}),r=g(r).appendTo(e));if(d)for(m=0;m<d.length;m++){var b=d[m],v;for(v in b)r.bind(v,b[v])}}},_destroy:function(){this.element.empty().removeClass("pq-toolbar").enableSelection()},_disable:function(){null==this.$disable&&(this.$disable=g("<div class='pq-grid-disable'></div>").css("opacity",.2).appendTo(this.element))},
_enable:function(){this.$disable&&(this.element[0].removeChild(this.$disable[0]),this.$disable=null)},_setOption:function(c,g){"disabled"==c&&(!0==g?this._disable():this._enable())}})})(jQuery);
(function(g){var c=function(){this.focusSelection=null},n=c.prototype;n.triggerSelectChange=function(e){var c=this.that;if(c.options.selectionModel.fireSelectChange){var h=c.iRows.getSelection(),k=c.iCells.getSelection(),q=e.evt;e=e.ui;h={rows:h,cells:k};e=null==e?h:g.extend(h,e);c._trigger("selectChange",q,e)}};n.getOldRowSel=function(){var e=this.that,c;if((c=this.focusSelection)&&this.isSelected(c))return e=e.getRowIndx(c),e.rowData=c.rowData,e};n.getOldCellSel=function(){var e=this.that,c;if((c=
this.focusSelection)&&this.isSelected(c)){var h=c.rowData,e=e.getRowIndx({rowData:h});e.rowData=h;e.dataIndx=c.dataIndx;return e}};n.getNewRowSel=function(){var e=this.that,c=document.activeElement?g(document.activeElement):null;if(c&&c.hasClass("pq-grid-row")&&c.closest(".pq-grid")[0]==e.element[0])return e=e.getRowIndx({$tr:c}),e.$tr=c,e};n.getNewCellSel=function(){var e=this.that,c=document.activeElement?g(document.activeElement):null;if(c&&c.hasClass("pq-grid-cell")&&c.closest(".pq-grid")[0]==
e.element[0])return e=e.getCellIndices({$td:c}),e.$td=c,e};n.getFocusSelection=function(e){if(this instanceof h)return e&&!0===e.old?this.getOldRowSel():this.getNewRowSel();if(this instanceof k)return e&&!0===e.old?this.getOldCellSel():this.getNewCellSel()};n.getFirstSelection=function(){var e=this.firstSelection;if(e&&this.isSelected(e))return e;this.refresh();e=this.selection;if(e.length)return this.firstSelection=e[0],e[0]};n.getLastSelection=function(){var e=this.lastSelection;if(e){var c=e.rowData,
h=this.that.getRowData({rowIndx:rowIndx});return c==h&&this.isSelected(e)?e:!1}return null};n.getLastSelectionCurPage=function(){var e=this.lastSelection;if(e&&this.isSelected(e)){var c=e.rowIndx,h=this.that.options.pageModel;if(h.type){var k=h.curPage;return Math.ceil((c+1)/h.rPP)==k?e:null}return e}return null};n.getSelection=function(){this.refresh();return this.selection};n.getSelectionCurPage=function(){var e=this.that,c=this.getSelection(),h=[],k=e.options.pageModel;if(k.type){for(var e=k.curPage,
k=k.rPP,g=0;g<c.length;g++){var a=c[g];Math.ceil((a.rowIndx+1)/k)==e&&h.push(a)}return h}return c};n.inViewRow=function(e){var c=this.that,h=this.options,k=c.rowIndxOffset,g=c.initV,a=c.finalV;if(e<h.freezeRows)return!0;if(h.groupModel){if((c=c.dataGM)&&c.length)for(;g<=a;g++)if(h=c[g].rowIndx-k,null!=h&&h==e)return!0;return!1}return e>=g&&e<=a};n.setDirty=function(){};var h=function(e){this.that=e;this.options=e.options;this.selection=[]};g.paramquery.cRows=h;var k=function(e){this.options=e.options;
this.that=e;this.selection=[]};g.paramquery.cCells=k;n=k.prototype=new c;c=h.prototype=new c;c.extendSelection=function(e){var c=this.that,h=e.rowIndx,k=c.options.selectionModel.mode;e=e.evt;var g=this.getFirstSelection();null==g?c.setSelection({rowIndx:h}):"single"!=k&&(k=c=g.rowIndx,g=h,c>h&&(k=h,g=c),this.selectRange({initRowIndx:k,finalRowIndx:g,evt:e}),this.add({rowIndx:h}))};c.refresh=function(){this.selection=[];var c=this.that,f=c.options,h="remote"==f.pageModel.type?!0:!1,c=c.rowIndxOffset,
k=[];if(f=f.dataModel.data){for(var g=0,a=f.length;g<a;g++){var b=f[g];b.pq_rowselect&&k.push({rowIndx:h?g+c:g,rowData:b})}this.selection=k}};c.replace=function(c){var f=c.rowIndx,h=null==c.offset?this.that.getRowIndxOffset():c.offset;c.offset=h;c.rowIndxPage=f-h;this.removeAll({raiseEvent:!0});this.add(c)};c.indexOf=function(c){this.refresh();c=c.rowIndx;for(var f=this.selection,h=0;h<f.length;h++)if(f[h].rowIndx==c)return h;return-1};c.isSelected=function(c){var f=this.that;return(c=c.rowData||
f.getRowData(c))?null==c.pq_rowselect?!1:c.pq_rowselect:null};c._boundRow=function(c){var f=c.rowIndxPage,h=this.that;c=null==c.$tr?h.getRow({rowIndxPage:f}):c.$tr;if(null==c||0==c.length)return!1;c.addClass("pq-row-select ui-state-highlight");return c};c.selectRange=function(c){var f=c.initRowIndx,h=c.finalRowIndx;c=c.evt;for(var k=this.getSelection().slice(0),g=[],a=0;a<k.length;a++){var b=k[a],d=b.rowIndx;(d<f||d>h)&&g.push({rowIndx:d,rowData:b.rowData})}this.remove({rows:g,evt:c});g=[];f>h&&(k=
f,f=h,h=k);for(d=f;d<=h;d++)g.push({rowIndx:d,evt:c});this.add({rows:g,evt:c})};n._addToData=function(c){var f=c.dataIndx;c=this.that.getRowData(c);c.pq_cellselect||(c.pq_cellselect={});c.pq_cellselect[f]=!0};n.extendSelection=function(c){var f=this.that,h=this.getFirstSelection(),k=c.rowIndx,g=c.colIndx,a=f.options.selectionModel.mode;c=c.evt;if(null==h)f.setSelection({rowIndx:k,colIndx:g});else{var b=h.rowIndx,f=f.getColIndx({dataIndx:h.dataIndx}),h=b,d=k,l=f,n=g;b>k&&(h=k,d=b);"range"==a?(b>k&&
(l=g,n=f),k==b&&g<f&&(l=g,n=f),this.selectRange({initRowIndx:h,initColIndx:l,finalRowIndx:d,finalColIndx:n,evt:c}),this.add({rowIndx:k,colIndx:g})):"block"==a&&(f>g&&(l=g,n=f),this.selectBlock({initRowIndx:h,initColIndx:l,finalRowIndx:d,finalColIndx:n,evt:c}),this.add({rowIndx:k,colIndx:g}))}};n._removeFromData=function(c){var f=c.rowData;f&&f.pq_cellselect&&delete f.pq_cellselect[c.dataIndx]};n.removeAll=function(){this.refresh();var c=this.selection.slice(0);this.remove({cells:c});this.lastSelection=
null};c.removeAll=function(c){if(c&&null!=c.page)throw"objP.page not supported in removeAll";var f=this.that,h=c&&null!=c.all?c.all:!0;this.refresh();c=this.selection.slice(0);if(h)this.remove({rows:c}),this.lastSelection=null;else{for(var h=[],k=f.rowIndxOffset,f=(f=f.pdata)?f.length:0,g=0,a=c.length;g<a;g++){var b=c[g],d=b.rowIndx-k;if(0<=d)if(d<f)h.push(b);else break}this.remove({rows:h})}};n.isSelected=function(c){var f=this.that,h=c.rowData||f.getRowData(c),k=c.dataIndx;c=c.colIndx;if(null==
c&&null==k||null==h)return null;k=null==k?f.colModel[c].dataIndx:k;return h.pq_cellselect&&h.pq_cellselect[k]?!0:!1};n.refresh=function(){this.selection=[];var c=this.that,f=c.options.dataModel.data,h=[],k="remote"==c.options.pageModel.type?!0:!1,c=c.rowIndxOffset,g=this.that.colModel,a=g.length;if(f){for(var b=[],d=0;d<a;d++){var l=g[d].dataIndx;b[d]=l}for(var d=0,n=f.length;d<n;d++){var r=f[d],v=r.pq_cellselect;if(v)for(var D=k?d+c:d,L=0;L<a;L++)l=b[L],v[l]&&h.push({rowIndx:D,rowData:r,dataIndx:l,
colIndx:L,column:g[L]})}this.selection=h}};n.replace=function(c){var f=c.rowIndx,h=null==c.offset?this.that.getRowIndxOffset():c.offset;c.rowIndxPage=f-h;c.offset=h;this.removeAll({raiseEvent:!0});this.add(c)};n.inViewCell=function(c,f){var h=this.that,k=this.options.freezeCols;return this.inViewRow(c)?f<k||f>=h.initH&&f<=h.finalH:!1};n._add=function(c){var f=this.that,h=c.rowIndx,k=c.rowIndxPage,g=c.rowData||f.getRowData(c),a=f.rowIndxOffset,b,h=null==h?k+a:h,k=null==k?h-a:k,a=c.colIndx,d=c.dataIndx,
a=null==a?f.getColIndx({dataIndx:d}):a,l=f.colModel[a],d=null==d?l.dataIndx:d,n=c.evt,r=this.isSelected({rowData:g,dataIndx:d});if(null==r)return!1;var v=this.inViewCell(k,a);if(!1===r){if(v){var D=f.getCell({rowIndxPage:k,colIndx:a});D&&D.addClass("pq-cell-select ui-state-highlight")}this._addToData({rowData:g,dataIndx:d});!1!==c.trigger&&f._trigger("cellSelect",n,{rowIndx:h,rowIndxPage:k,colIndx:a,dataIndx:d,column:l,rowData:g});b=!0}this.lastSelection={rowIndx:h,dataIndx:d,rowData:g};!1!==c.focus&&
v&&(D&&D.length||(D=f.getCell({rowIndxPage:k,dataIndx:d})),D&&D.length&&(D.attr("tabindex","0"),D.focus(),f._fixTableViewPort(),this.focusSelection={rowData:g,rowIndx:h,dataIndx:d}));c.setFirst&&(this.firstSelection={rowIndx:h,rowData:g,dataIndx:d});if(b)return{rowIndx:h,rowData:g,dataIndx:d,colIndx:a,column:l}};c._add=function(c){var f=this.that,h,k=c.rowIndx,q=c.rowIndxPage,a=f.rowIndxOffset,k=null==k?q+a:k,q=null==q?k-a:q,b=null==b?f.getRowData(c):b,a=c.$tr,d=c.evt,l=this.isSelected({rowData:b});
c.rowIndxPage=q;if(null==l)return!1;var n=this.inViewRow(q);!1===l&&(n&&(a=this._boundRow(c)),b.pq_rowselect=!0,!1!==c.trigger&&f._trigger("rowSelect",d,{rowIndx:k,rowIndxPage:q,rowData:b,$tr:a}),h=!0);this.lastSelection={rowIndx:k,rowData:b};!1!==c.focus&&n&&(a&&a.length||(a=f.getRow({rowIndxPage:q})),a&&(a=g(a[0]),a.attr("tabindex","0"),a.focus(),f._fixTableViewPort(),this.focusSelection={rowData:b,rowIndx:k}));c.setFirst&&(this.firstSelection={rowIndx:k,rowData:b});if(h)return{rowIndx:k,rowData:b}};
n.add=function(c){var f=this.that,h=c.evt,k=c.cells,g=!1,a=[];if(k&&"function"==typeof k.push){c=0;for(var b=k.length;c<b;c++)g=k[c],g.trigger=!1,(g=this._add(g))&&a.push(g);a.length&&(g=!0,f._trigger("cellSelect",h,{cells:a}))}else g=this._add(c);g&&(f._fixIE(),this.triggerSelectChange({evt:h}))};c.add=function(c){var f=this.that,h=c.evt,k=c.rows,g=!1,a=[];if(k&&"function"==typeof k.push){c=0;for(var b=k.length;c<b;c++)g=k[c],g.trigger=!1,(g=this._add(g))&&a.push(g);a.length&&(g=!0,f._trigger("rowSelect",
h,{rows:a}))}else g=this._add(c);g&&(f._fixIE(),this.triggerSelectChange({evt:h}))};n._remove=function(c){var f=this.that,h=c.rowIndx,k=c.rowIndxPage,g=f.rowIndxOffset,h=null==h?k+g:h,k=null==k?h-g:k,g=c.rowData||f.getRowData(c),a=c.colIndx,b=c.dataIndx,a=null==a?f.getColIndx({dataIndx:b}):a,d=c.column,d=null==d?f.colModel[a]:d,b=null==b?d.dataIndx:b,l=c.evt;if(this.isSelected({rowData:g,dataIndx:b}))return this.inViewCell(k,a)&&(k=f.getCell({rowIndxPage:k,colIndx:a,all:!0}))&&(k.removeClass("pq-cell-select ui-state-highlight"),
k.removeAttr("tabindex")),this._removeFromData({rowData:g,dataIndx:b}),!1!==c.trigger&&f._trigger("cellUnSelect",l,{rowIndx:h,colIndx:a,dataIndx:b,rowData:g}),{rowIndx:h,rowData:g,dataIndx:b,colIndx:a,column:d}};c._remove=function(c){var f=this.that,h=c.rowIndx,k=c.rowIndxPage,g=f.rowIndxOffset,h=null==h?k+g:h,k=null==k?h-g:k,g=c.rowData,g=null==g?f.getRowData(c):g,a=c.$tr,b=c.evt;if(this.isSelected({rowData:g}))return this.inViewRow(k)&&(a=f.getRow({rowIndxPage:k}))&&(a.removeClass("pq-row-select ui-state-highlight"),
a.removeAttr("tabindex")),g.pq_rowselect=!1,!1!==c.trigger&&f._trigger("rowUnSelect",b,{rowIndx:h,rowData:g,$tr:a}),{rowIndx:h,rowData:g}};n.remove=function(c){var f=c.cells,h=c.evt,k=!1;if(f&&"function"==typeof f.push){c=[];for(var g=0,a=f.length;g<a;g++)k=f[g],k.trigger=!1,(k=this._remove(k))&&c.push(k);c.length&&(k=!0,this.that._trigger("cellUnSelect",h,{cells:c}))}else k=this._remove(c);k&&this.triggerSelectChange({evt:h})};c.remove=function(c){var f=c.rows,h=c.evt,k=!1;if(f&&"function"==typeof f.push){c=
[];for(var g=0,a=f.length;g<a;g++)k=f[g],k.trigger=!1,(k=this._remove(k))&&c.push(k);c.length&&(k=!0,this.that._trigger("rowUnSelect",h,{rows:c}))}else k=this._remove(c);k&&this.triggerSelectChange({evt:h})};n.indexOf=function(c){this.refresh();var f=c.rowIndx,h=this.that,h=null==c.dataIndx?h.colModel[c.colIndx].dataIndx:c.dataIndx;c.dataIndx=h;c=this.selection;for(var k=0;k<c.length;k++){var g=c[k];if(g.rowIndx==f&&g.dataIndx==h)return k}return-1};n.selectAll=function(c){var f=this.that,h=c&&c.all?
!0:!1;c=h?this.options.dataModel.data:f.pdata;var k=f.rowIndxOffset,g=f.colModel,a=g.length,b=[],f=function(c,d){for(var e=0;e<a;e++){var f=g[e];f.hidden||b.push({rowIndx:d,rowData:c,colIndx:e,dataIndx:f.dataIndx,focus:!1})}};if(c){for(var d=0,l=c.length;d<l;d++)var n=c[d];if(h)for(h="remote"==this.options.pageModel.type?!0:!1,d=0,l=c.length;d<l;d++){var n=c[d],r=d;h&&(r=d+k);f(n,r)}else for(d=0,l=c.length;d<l;d++)n=c[d],r=d+k,f(n,r);this.add({cells:b})}};c.selectAll=function(c){var f=this.that,h=
c&&c.all?!0:!1,f=h?this.options.dataModel.data:f.pdata;c=[];if(f){if(h)for(var h="remote"==this.options.pageModel.type?!0:!1,k=0,g=f.length;k<g;k++){var a={rowData:f[k],focus:!1};h?a.rowIndxPage=k:a.rowIndx=k;c.push(a)}else for(k=0,g=f.length;k<g;k++)c.push({rowIndxPage:k,rowData:f[k],focus:!1});this.add({rows:c})}};n.selectRange=function(c){var f=this.that,h=c.initRowIndx,k=c.initColIndx,g=c.finalRowIndx;c=c.finalColIndx;for(var a=f.colModel,b=a.length,d=this.getSelection().slice(0),l=[],n=0;n<d.length;n++){var r=
d[n],v=r.rowIndx,D=r.dataIndx,r=f.getColIndx({dataIndx:D});v<h||v>g?l.push({rowIndx:v,colIndx:r,dataIndx:D}):v==h&&r<k?l.push({rowIndx:v,colIndx:r,dataIndx:D}):v==g&&r>c&&l.push({rowIndx:v,colIndx:r,dataIndx:D})}this.remove({cells:l});l=[];for(r=0;r<b;r++)if(f=a[r],!f.hidden){D=f.dataIndx;v=h;do{if(!(v==h&&r<k))if(v==g&&r>c)break;else l.push({rowIndx:v,colIndx:r,dataIndx:D,focus:!1});v++}while(v<=g)}this.add({cells:l})};n.selectBlock=function(c){var f=this.that,h=c.initRowIndx,k=c.initColIndx,g=c.finalRowIndx,
a=c.finalColIndx;c=c.evt;for(var b=this.getSelection().slice(0),d=f.colModel,l=[],n=0;n<b.length;n++){var r=b[n],v=r.rowIndx,r=r.dataIndx,D=f.getColIndx({dataIndx:r});D<k||D>a?l.push({rowIndx:v,colIndx:D,dataIndx:r}):(v<h||v>g)&&l.push({rowIndx:v,colIndx:D,dataIndx:r})}this.remove({cells:l});l=[];for(D=k;D<=a;D++)if(f=d[D],r=f.dataIndx,!f.hidden){v=h;do l.push({rowIndx:v,colIndx:D,dataIndx:r,focus:!1}),v++;while(v<=g)}this.add({cells:l,evt:c})}})(jQuery);
(function(g){var c=(g.paramquery.cCheckBoxColumn=function(c,h){var k=this;this.that=c;this.options=c.options;this.column=h;this.cb=h.cb=h.cb||{all:!1,header:!0};this.dataIndx=h.dataIndx;var e=c.widgetEventPrefix.toLowerCase(),f=c.element,g=c.eventNamespace;f.on(e+"dataavailable"+g,function(c,e){if(k.belongs(c))return k._onDataAvailable(c,e)});f.on(e+"cellclick"+g,function(c,e){if(k.belongs(c))return k.cellClick(c,e)});this.cb.reverse&&(f.on(e+"rowselect"+g,function(c,e){if(k.belongs(c))return k.rowSelect(c,
e)}),f.on(e+"rowunselect"+g,function(c,e){if(k.belongs(c))return k.rowUnSelect(c,e)}));f.on(e+"cellkeydown"+g,function(c,e){if(k.belongs(c))return k.cellKeyDown(c,e)});f.on(e+"refresh"+g+" "+e+"refreshrow"+g,function(c,e){if(k.belongs(c))return k.refreshHeader(c,e)})}).prototype=new g.paramquery.cClass;c.hasHeaderChkBox=function(){return this.cb.header};c.setValCBox=function(){if(this.hasHeaderChkBox()){for(var c=this.that,h=this.options,k=this.dataIndx,c=this.cb.all?h.dataModel.data:c.pdata,h=null,
e=0,f=0,g=0,m=c.length;g<m;g++)c[g][k]?e++:f++;e==m?h=!0:f==m&&(h=!1);this.$inp.pqval({val:h})}};c.onHeaderClick=function(c){var h=this.that,k=g(c.currentTarget).find("input"),e=this.column,f=e.dataIndx,p=h.getColIndx({dataIndx:f}),m=this.cb.all?h.options.dataModel.data:h.pdata,e={column:e,dataIndx:f,source:"header"},q=g(c.target).is("input")?!0:!1,a=k.is(":checked"),b=a;q||(b=!a);if(b){if(!1===h._trigger("beforeCheck",c,e))return!1;q||k.pqval({val:!0});k=0;for(q=m.length;k<q;k++)a=m[k],a[f]=!0;h.$cont.find("td[pq-col-indx="+
p+"] input").prop("checked",!0);!1!==h._trigger("check",c,e)&&this.selectAllRows()}else{if(!1===h._trigger("beforeunCheck",c,e))return!1;q||k.pqval({val:!1});k=0;for(q=m.length;k<q;k++)a=m[k],a[f]=!1;h.$cont.find("td[pq-col-indx="+p+"] input").prop("checked",!1);!1!==h._trigger("unCheck",c,e)&&this.unSelectAllRows()}};c.refreshHeader=function(c,h){if(this.hasHeaderChkBox()){var k=this.that;if(k.pdata){var e=this;if(k=k.getCellHeader({dataIndx:this.dataIndx}))k.html("<input type='checkbox'/>"),this.$inp=
k.find("input"),k.click(function(c){return e.onHeaderClick(c)}),this.setValCBox()}}};c.selectAllRows=function(){this.that.iRows.selectAll({all:this.cb.all})};c.unSelectAllRows=function(){this.that.iRows.removeAll({all:this.cb.all})};c._onDataAvailable=function(){var c=this.that,h=this.options,k=h.dataModel.data,h="remote"==h.pageModel.type?c.rowIndxOffset:0,e=this.column,f=e.dataIndx;if(null!=f&&k){for(var g=[],m=0,q=k.length;m<q;m++){var a=k[m];a[f]&&g.push({rowIndx:m+h,rowData:a})}if(!1!==c._trigger("check",
null,{rows:g,column:e,dataIndx:f,source:"dataAvailable"}))for(m=0;m<q;m++)a=k[m],a[f]&&(a.pq_rowselect=!0)}};c.cellClick=function(c,h){if(h.dataIndx===this.dataIndx)return this.raiseEvent(c,h)};c.rowSelect=function(c,h){var k=this.that,e=h.rows,f=h.rowData,g=this._findSelectionIndx();if(e)for(var m=0,q=e.length;m<q;m++){var f=e[m],a=f.rowIndx,f=f.rowData;f[g]=!0;k.refreshCell({rowIndx:a,dataIndx:g})}else f&&(f[g]=!0,a=h.rowIndx,k.refreshCell({rowIndx:a,dataIndx:g}));this.setValCBox()};c.rowUnSelect=
function(c,h){var k=this.that,e=h.rows,f=h.rowData,g=this._findSelectionIndx();if(e)for(var m=0,q=e.length;m<q;m++){var f=e[m],a=f.rowIndx,f=f.rowData;f[g]=!1;k.refreshCell({rowIndx:a,dataIndx:g})}else f&&(f[g]=!1,a=h.rowIndx,k.refreshCell({rowIndx:a,dataIndx:g}));this.setValCBox()};c.raiseEvent=function(c,h){var k=this.that,e=h.rowData,f=g(c.originalEvent.target).is("input")?!0:!1,p=h.rowIndx,m=h.dataIndx;if(e[m]){if(!1===k._trigger("beforeunCheck",c,h))return!1;e[m]=!1;f||(e=k.getCell(h).find("input"),
e.pqval({val:!1}));!1!==k._trigger("unCheck",c,h)&&k.iRows.remove({rowIndx:p})}else{if(!1===k._trigger("beforeCheck",c,h))return!1;e[m]=!0;f||(e=k.getCell(h).find("input"),e.pqval({val:!0}));!1!==k._trigger("check",c,h)&&k.iRows.add({rowIndx:p})}this.setValCBox();if(!f)return!1};c.cellKeyDown=function(c,h){if(h.dataIndx=this.dataIndx)if(13==c.keyCode||32==c.keyCode)return this.raiseEvent(c,h)}})(jQuery);
(function(g){function c(c){this.that=c;var h=this,k=c.element,e=c.widgetEventPrefix.toLowerCase();c=c.eventNamespace;k.on(e+"contmousedown"+c,function(c,e){if(h.belongs(c))return h._onContMouseDown(c,e)});k.on(e+"mousedrag"+c,function(c,e){if(h.belongs(c)&&h.swipedown)return h._onMouseDrag(c,e)});k.on(e+"mousestop"+c,function(c,e){return h._onMouseStop(c,e)});k.on(e+"mousepqup."+c,function(c,e){return h._onMousePQUp(c,e)});k.on(e+"rowmousedown"+c,function(c,e){if(h.belongs(c))return h._onRowMouseDown(c,
e)});k.on(e+"cellmousedown"+c,function(c,e){if(h.belongs(c))return h._onCellMouseDown(c,e)});k.on(e+"beforetableview"+c,function(c,e){if(h.belongs(c))return h._beforeTableView(c,e)});k.on(e+"refresh"+c,function(c,e){if(h.belongs(c))return h._onRefresh(c,e)});k.on(e+"cellmouseenter"+c,function(c,e){if(h.belongs(c))return h._onCellMouseEnter(c,e)});k.on(e+"rowmouseenter"+c,function(c,e){if(h.belongs(c))return h._onRowMouseEnter(c,e)})}g.paramquery.cMouseSelection=c;g=c.prototype=new g.paramquery.cClass;
g._beforeTableView=function(c,h){var k=this.that,e=k.getFocusElement();this.lastFocus=null;e&&e.$grid&&(e=e.$ae,e.hasClass("pq-grid-row")?this.lastFocus=k=k.getRowIndx({$tr:e}):e.hasClass("pq-grid-cell")&&(this.lastFocus=k=k.getCellIndices({$td:e})))};g._onRefresh=function(c,h){var k=this.that,e=this.lastFocus;e&&(e=null!=e.dataIndx?k.getCell(e):k.getRow(e))&&e.length&&k.inViewPort(e)&&e.attr("tabindex","0").focus()};g._onCellMouseDown=function(c,h){var k=this.that,e=h.rowIndx,f=h.colIndx,g=k.options.selectionModel,
m=g.mode;if("cell"==g.type&&null!=f)return c.shiftKey?(k.iCells.extendSelection({rowIndx:e,colIndx:f,mode:m,evt:c}),c.preventDefault()):(c.ctrlKey||c.metaKey)&&"single"!=m?k.iCells.isSelected({rowIndx:e,colIndx:f})?k.iCells.remove({rowIndx:e,colIndx:f}):k.setSelection({rowIndx:e,colIndx:f}):(this.mousedown={rowIndx:e,colIndx:f},k.setSelection(null),k.setSelection({rowIndx:e,colIndx:f,setFirst:!0})),!0};g._onCellMouseEnter=function(c,h){var k=this.that;if("cell"==k.options.selectionModel.type&&this.mousedown){var e=
this.mousedown,f=e.c1,g=h.rowIndx,m=h.colIndx;if(e.r1!=g||f!=m)if(e.r2!=g||e.c2!=m)this.mousedown.r2=g,this.mousedown.c2=m,k.scrollCell({rowIndx:g,colIndx:m}),k.iCells.extendSelection({rowIndx:g,colIndx:m,evt:c})}};g._onRowMouseEnter=function(c,h){var k=this.that;if("row"==k.options.selectionModel.type&&this.mousedown){var e=h.rowIndx;this.mousedown.r1!=e&&this.mousedown.r2!=e&&(this.mousedown.r2=e,k.scrollRow({rowIndx:e}),k.iRows.extendSelection({rowIndx:e,evt:c}))}};g._onRowMouseDown=function(c,
h){var k=this.that,e=h.rowIndx,f=k.options.selectionModel,g=f.mode;if("row"==f.type&&null!=e)return c.shiftKey?(k.iRows.extendSelection({rowIndx:e,evt:c}),c.preventDefault()):(c.ctrlKey||c.metaKey)&&"single"!=g?k.iRows.isSelected({rowIndx:e})?k.iRows.remove({rowIndx:e}):k.setSelection({rowIndx:e}):(this.mousedown={r1:e,y1:c.pageY,x1:c.pageX},k.setSelection(null),k.setSelection({rowIndx:e,setFirst:!0})),!0};g._onContMouseDown=function(c,h){this.that.options.swipeModel.on&&(this._stopSwipe(!0),this.swipedown=
{x:c.pageX,y:c.pageY});return!0};g._onMousePQUp=function(c,h){this.mousedown=null};g._stopSwipe=function(c){c&&(this.swipedownPrev=this.swipedown=null);window.clearInterval(this.intID);this.intID=null};g._onMouseStop=function(c,h){var k=this,e=this.that;if(this.swipedownPrev){var f=e.options.swipeModel,e=this.swipedownPrev,g=e.ts,m=(new Date).getTime()-g,q=c.pageX,a=c.pageY,b=q-e.x,d=a-e.y;if(Math.sqrt(b*b+d*d)/m>f.ratio){var l=0,s=f.repeat;k._stopSwipe();k.intID=window.setInterval(function(){l+=
f.speed;s--;0>=s&&k._stopSwipe(!0);k._onMouseDrag({pageX:q+l*b/m,pageY:a+l*d/m})},50)}else k.swipedown=null,k.swipedownPrev=null}};g._onMouseDrag=function(c,h){var k=this.that,e=k.options;if(this.swipedown){var f=this.swipedown,g=f.x,m=f.y,q=c.pageX,a=c.pageY;this.swipedownPrev={x:g,y:m,ts:(new Date).getTime()};k.$td_edit&&k.quitEditMode({silent:!0});e.virtualY||(this._scrollVertSmooth(m,a),k._syncScrollBarVert());e.virtualX||(this._scrollHorSmooth(g,q),k._syncScrollBarHor());f.x=q;f.y=a}return!0};
g.updateTableY=function(c){if(0==c)return!1;var h=this.that,g=h.getTableForVertScroll(),e=h.$cont,h=h._getScollBarHorizontalHeight(),e=e.data("offsetHeight")-h;if(!g||!g.length)return!1;var h=g.data("offsetHeight"),f=parseInt(g.css("marginTop"))+c;0<=f?g.css({marginTop:-1}):0>c&&0<e-h-f?0<e-g[0].offsetHeight-f?(c=e-g[0].offsetHeight,0>c&&g.css({marginTop:c})):g.css({marginTop:f}):g.css({marginTop:f});return!0};g._scrollVertSmooth=function(c,h){c!=h&&this.updateTableY(h-c)};g._scrollHorSmooth=function(c,
h){if(c!=h){var g=this.that,e=h-c,f=g.getTableForHorScroll(),p=g.getTableHeaderForHorScroll(),m=g.$cont,g=g._getSBWidth(),m=m.data("offsetWidth")-g;if(f||p){var q=f?f:p,g=q.data("scrollWidth"),e=parseInt(q.css("marginLeft"))+e;0<e?(f&&f.css({marginLeft:0}),p&&p.css({marginLeft:0})):0<m-g-e?0>=m-g&&(f&&f.css("marginLeft",m-g),p&&p.css("marginLeft",m-g)):(f&&f.css("marginLeft",e),p&&p.css("marginLeft",e))}}}})(jQuery);
(function(g){var c=null,n=!1,h="",k=g.paramquery.pqGrid.prototype,e=k.options,f={on:!0,header:!0,zIndex:1E4},p={on:!0,compare:"byVal",select:!0,validate:!0,allowInvalid:!0,type:"replace"};k.copy=function(){c=new m(this);c.copy();c=null};k.paste=function(){c=new m(this);c.paste();c=null};e.pasteModel=e.pasteModel||p;e.copyModel=e.copyModel||f;var m=function(c,a){var b;this.that=c;a&&a.hasClass("pq-grid-row")?(this.rowIndx=c.getRowIndx({$tr:a}).rowIndx,this.dataIndx=null):a&&a.hasClass("pq-grid-cell")?
(b=c.getCellIndices({$td:a}),this.rowIndx=b.rowIndx,this.dataIndx=b.dataIndx):this.dataIndx=this.rowIndx=null},k=m.prototype;k.createClipBoard=function(){var c=g("#pq-grid-excel-div"),c=this.that.options.copyModel,a=g("#pq-grid-excel");0==a.length&&(c=g("<div id='pq-grid-excel-div'  style='position:fixed;top:20px;left:20px;height:1px;width:1px;overflow:hidden;z-index:"+c.zIndex+";'/>").appendTo(document.body),a=g("<textarea id='pq-grid-excel' autocomplete='off'  style='overflow:hidden;height:10000px;width:10000px;opacity:0' />").appendTo(c),
a.css({opacity:0}));a.select()};k.destroyClipBoard=function(){var c=this.that,a,b=c.iCells.getFocusSelection({old:!0});b?a=c.getCell({rowIndx:b.rowIndx,dataIndx:b.dataIndx}):(b=c.iRows.getFocusSelection({old:!0}))&&(a=c.getRow({rowIndx:b.rowIndx}));var b=g(window).scrollTop(),d=g(window).scrollLeft();a?a.attr("tabindex",0).focus():c.$cont.focus();c=g(window).scrollTop();a=g(window).scrollLeft();b==c&&d==a||window.scrollTo(d,b)};k.clearClipBoard=function(){g("#pq-grid-excel").val("")};k.copy=function(){var c=
g("#pq-grid-excel"),a=this.that,b=a.colModel,d=b.length,e=[],f=[];if(a.options.copyModel.on){for(var e=a.iRows.getSelection(),k=0,m=e.length;k<m;k++){for(var p=e[k],n=p.rowData,M=[],p=0;p<d;p++){var J=b[p];!1!==J.copy&&M.push(n[J.dataIndx])}J=M.join("\t");f.push(J)}e=a.iCells.getSelection();b=a=null;M=[];k=0;for(m=e.length;k<m;k++)p=e[k],a=p.rowIndx,n=p.rowData,J=p.column,d=p.dataIndx,!1!==J.copy&&(null!=b&&a!=b?(J=M.join("\t"),M=[],f.push(J),b=a):null==b&&(b=a),M.push(n[d]));f.push(M.join("\t"));
J=f.join("\n");c.length&&(c.val(J),c.select());h=J}};k.paste=function(){var c=this.that,a=g("#pq-grid-excel"),b=a.length?a.val():h,b=b.replace(/\n$/,""),a=b.split("\n"),d=a.length,e,f=c.colModel,k=c.options.pasteModel,m="row",p=f.length;if(k.on&&0!=b.length&&0!=d){b={rows:a};if(!1===c._trigger("beforePaste",null,b))return!1;var b=k.type,n,M,J,H,u=c.iRows.getSelectionCurPage();u&&u.length||(m="cell",u=c.iCells.getSelectionCurPage());u&&u.length?(n=u[0].rowIndx,J=u[u.length-1].rowIndx,"cell"==m&&(M=
c.getColIndx({dataIndx:u[0].dataIndx}),H=c.getColIndx({dataIndx:u[u.length-1].dataIndx}))):H=M=J=n=0;var t,w;"replace"==b?(t=n,w=J-n+1<d?"extend":"repeat"):"append"==b?(t=J+1,w="extend"):"prepend"==b&&(t=n,w="extend");var y;n="extend"==w?d:J-n+1;var z;J=0;for(var u=[],x=d=0;x<n;x++){var A=a[J],B=x+t,C="replace"==b?c.getRowData({rowIndx:B}):null,F=C?{}:null,E={};void 0===A&&"repeat"===w&&(J=0,A=a[J]);J++;var G=A.split("\t");if(!e)if("cell"==m){e=G.length;y=H-M+1<G.length?"extend":"repeat";e="extend"==
y?e:H-M+1;if(isNaN(e))throw"lenH NaN. assert failed.";e+M>p&&(e=p-M)}else e=p,M=0;var I=0,K=0,A=0;z=e;for(K=0;K<z;K++){var O=f[K+M],P=G[I],S=O.dataIndx;O.hidden?"extend"==y&&z+M<p&&z++:(void 0===P&&"repeat"===y&&(I=0,P=G[I]),I++,E[S]=P,F&&(F[S]=C[S]))}!1==g.isEmptyObject(E)&&(G="update",null==C&&(G="add"),u.push({newRow:E,rowIndx:B,rowData:C,oldRow:F,type:G}),d++)}b={rowList:u,source:"paste",allowInvalid:k.allowInvalid,validate:k.validate};c._digestData(b);k.select&&("cell"==m?c.iCells.selectBlock({initRowIndx:t,
finalRowIndx:t+d-1,initColIndx:M,finalColIndx:"extend"==y?M+e-1+A:H}):c.iRows.selectRange({initRowIndx:t,finalRowIndx:t+d-1}));c.refreshView();b={rows:a};c._trigger("paste",null,b)}};g(document).unbind(".pqExcel").bind("keydown.pqExcel",function(e){if(e.ctrlKey||e.metaKey){var a=g(e.target);if(a.hasClass("pq-grid-row")||a.hasClass("pq-grid-cell")||a.is("#pq-grid-excel")||a.is("div.pq-cont")){var b=a.closest(".pq-grid");if(c||a.length&&b.length){if(!c){try{var d=b.pqGrid("getInstance").grid}catch(f){return!0}c=
new m(d,a);c.createClipBoard()}"67"==e.keyCode||"99"==e.keyCode?c.copy():"86"==e.keyCode||"118"==e.keyCode?(n=!0,c.clearClipBoard(),window.setTimeout(function(){c&&(c.paste(),c.destroyClipBoard(),c=null);n=!1},0)):(a=g("#pq-grid-excel"),a.length&&document.activeElement==a[0]&&c.that._onKeyPressDown(e))}}}}).bind("keyup.pqExcel",function(e){var a=e.keyCode;n||!c||e.ctrlKey||e.metaKey||-1==g.inArray(a,[17,91,93,224])||(c.destroyClipBoard(),c=null)})})(jQuery);
(function(g){var c=g.paramquery.pqGrid.prototype.options,n={on:!0,checkEditable:!0,checkEditableAdd:!1,allowInvalid:!0};c.historyModel=c.historyModel||n;c=(g.paramquery.cHistory=function(c){var g=this;this.that=c;this.options=c.options;this.records=[];this.id=this.counter=0;var e=c.eventNamespace,f=c.widgetEventPrefix.toLowerCase();c.element.on(f+"keydown"+e,function(c,e){if(g.belongs(c))return g._onKeyDown(c,e)});c.element.on(f+"dataavailable"+e,function(c,e){g.belongs(c)&&"filter"!=e.source&&g.reset()})}).prototype=
new g.paramquery.cClass;c._onKeyDown=function(c,g){var e=c.ctrlKey||c.metaKey;if(e&&"90"==c.keyCode)return this.undo(),!1;if(e&&"89"==c.keyCode)return this.redo(),!1};c.resetUndo=function(){if(0==this.counter)return!1;this.counter=0;this.that._trigger("history",null,{type:"resetUndo",num_undo:0,num_redo:this.records.length-this.counter,canUndo:!1,canRedo:!0})};c.reset=function(){if(0==this.counter&&0==this.records.length)return!1;this.records=[];this.id=this.counter=0;this.that._trigger("history",
null,{num_undo:0,num_redo:0,type:"reset",canUndo:!1,canRedo:!1})};c.increment=function(){var c=this.records,g=c.length;this.id=g?c[g-1].id+1:0};c.push=function(c){var k=this.canRedo(),e=this.records,f=this.counter;e.length>f&&e.splice(f,e.length-f);e[f]=g.extend({id:this.id},c);this.counter++;c=this.that;var p,m;1==this.counter&&(p=!0);k&&this.counter==e.length&&(m=!1);c._trigger("history",null,{type:"add",canUndo:p,canRedo:m,num_undo:this.counter,num_redo:0})};c.canUndo=function(){return 0<this.counter?
!0:!1};c.canRedo=function(){return this.counter<this.records.length?!0:!1};c.undo=function(){var c=this.canRedo(),g=this.that,e=this.options.historyModel,f=this.records;if(0<this.counter)this.counter--;else return!1;for(var f=f[this.counter].rowList,p=[],m=0,n=f.length;m<n;m++){var a=f[m],b=a.newRow,d=a.rowData,l=a.type,s=a.oldRow,a=a.rowIndx;"update"==l?(a=g.getRowIndx({rowData:d}).rowIndx,p.push({type:l,rowIndx:a,rowData:d,oldRow:b,newRow:s})):"add"==l?p.push({type:"delete",rowData:b}):"delete"==
l&&p.push({type:"add",rowIndx:a,newRow:d})}g._digestData({history:!1,source:"undo",checkEditable:e.checkEditable,checkEditableAdd:e.checkEditableAdd,allowInvalid:e.allowInvalid,rowList:p});g.refreshView();var r,v;!1===c&&(r=!0);0==this.counter&&(v=!1);g._trigger("history",null,{canUndo:v,canRedo:r,type:"undo",num_undo:this.counter,num_redo:this.records.length-this.counter});return!0};c.redo=function(){var c=this.canUndo(),g=this.that,e=this.options.historyModel,f=this.counter,p=this.records;if(f==
p.length)return!1;for(var f=p[f].rowList,m=[],n=0,a=f.length;n<a;n++){var b=f[n],d=b.newRow,l=b.rowData,s=b.type,r=b.oldRow,b=b.rowIndx;"update"==s?(b=g.getRowIndx({rowData:l}).rowIndx,m.push({type:s,rowIndx:b,rowData:l,oldRow:r,newRow:d})):"add"==s?m.push({type:"add",rowIndx:b,newRow:d}):"delete"==s&&m.push({type:"delete",rowData:l})}g._digestData({history:!1,source:"redo",checkEditable:e.checkEditable,checkEditableAdd:e.checkEditableAdd,allowInvalid:e.allowInvalid,rowList:m});g.refreshView();this.counter<
p.length&&this.counter++;var v,D;!1==c&&(v=!0);this.counter==this.records.length&&(D=!1);g._trigger("history",null,{canUndo:v,canRedo:D,type:"redo",num_undo:this.counter,num_redo:this.records.length-this.counter});return!0};g.paramquery.pqGrid.prototype.history=function(c){return this.iHistory[c.method](c)}})(jQuery);
(function(g){var c=g.ui.autocomplete.prototype,n=c._renderMenu,h=c._renderItem;c._renderMenu=function(c,e){n.call(this,c,e);var f=this.options.selectItem;if(f&&f.on){var f=f.cls,f=void 0===f?"ui-state-highlight":f,h=this.element.val();h&&f&&g("a",c).filter(function(){return g(this).text()===h}).addClass(f)}};c._renderItem=function(c,e){var f=h.call(this,c,e),g=this.options.highlightText;if(g&&g.on){var m=this.element.val();if(m){var m=new RegExp("("+m+")","i"),n=e.label;if(m.test(n)){var a=g.style,
g=g.cls,n=n.replace(m,"<span style='"+(void 0===a?"font-weight:bold;":a)+"' class='"+(void 0===g?"":g)+"'>$1</span>");f.find("a").html(n)}}}return f};g.widget("paramquery.pqTooltip",g.ui.tooltip,{options:{items:"td.pq-has-tooltip,td[title]",position:{my:"center top",at:"center bottom"},content:function(){var c=g(this),e=c.closest(".pq-grid").pqGrid("getInstance").grid,f=e.getCellIndices({$td:c});return(e=e.data({rowIndx:f.rowIndx,dataIndx:f.dataIndx,data:"pq_valid"}).data)?(c=e.icon,e=e.msg,(""==
c?"":"<span class='ui-icon "+c+" pq-tooltip-icon'></span>")+(null!=e?e:"")):c.attr("title")}},_create:function(){this._superApply();var c=this.element,e=this.eventNamespace;c.on("pqtooltipopen"+e,function(c,e){var h=g(c.target),k=g(c.originalEvent.target);k.on("remove",function(a){h.pqTooltip("close",a,!0)});e.tooltip.css("zIndex",k.zIndex()+5);if(h.is(".pq-grid")){var a=h.pqGrid("getCellIndices",{$td:k}),b=a.dataIndx,d;(d=h.pqGrid("getRowData",{rowIndx:a.rowIndx}))&&(d=d.pq_celldata)&&(d=d[b])&&
(d=d.pq_valid)&&(b=d,a=b.style,e.tooltip.addClass(b.cls),b=e.tooltip.attr("style"),e.tooltip.attr("style",b+";"+a));h.find("div.pq-sb-horiz,div.pq-sb-vert").on("pqscrollbardrag",function(a,b){a.currentTarget=k[0];h.pqTooltip("close",a,!0)})}});c.on("pqtooltipclose"+e,function(c,e){var h=g(c.target);g(c.originalEvent.target).off("remove");h.is(".pq-grid")&&h.find("div.pq-sb-horiz,div.pq-sb-vert").off("pqscrollbardrag")})}})})(jQuery);
